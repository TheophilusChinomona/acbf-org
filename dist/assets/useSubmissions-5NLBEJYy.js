import{a as t}from"./react-vendor-C9V0vZuX.js";import{aa as a,ab as e,ac as s,ad as i,ae as c,af as n,ag as o,ah as r}from"./index-CKJXBgC0.js";function d(){const[d,u]=t.useState([]),[p,h]=t.useState([]),[m,l]=t.useState(!0),[b,_]=t.useState(null),[f,v]=t.useState(!1),[w,y]=t.useState(!1);t.useEffect(()=>{f&&w&&l(!1)},[f,w]),t.useEffect(()=>{try{const t=a(e(s,"contact_submissions"),i("created_at","desc")),n=c(t,t=>{const a=t.docs.map(t=>({id:t.id,...t.data(),created_at:t.data().created_at?.toDate?t.data().created_at.toDate():t.data().created_at}));u(a),v(!0),_(null)},t=>{_(t.message||"Failed to fetch contact submissions"),v(!0)});return()=>n()}catch(t){_(t.message||"Failed to set up contact submissions listener"),v(!0)}},[]),t.useEffect(()=>{try{const t=a(e(s,"membership_applications"),i("created_at","desc")),n=c(t,t=>{const a=t.docs.map(t=>({id:t.id,...t.data(),created_at:t.data().created_at?.toDate?t.data().created_at.toDate():t.data().created_at}));h(a),y(!0),_(null)},t=>{_(t.message||"Failed to fetch membership applications"),y(!0)});return()=>n()}catch(t){_(t.message||"Failed to set up membership applications listener"),y(!0)}},[]);return{contactSubmissions:d,membershipApplications:p,loading:m,error:b,updateContactSubmissionStatus:async(t,a)=>{try{const e=["new","in-progress","resolved"];if(!e.includes(a))throw new Error(`Invalid status. Must be one of: ${e.join(", ")}`);const i=n(s,"contact_submissions",t);await o(i,{status:a})}catch(e){throw e}},updateMembershipApplicationStatus:async(t,a)=>{try{const e=["pending","approved","rejected"];if(!e.includes(a))throw new Error(`Invalid status. Must be one of: ${e.join(", ")}`);const i=n(s,"membership_applications",t);await o(i,{status:a})}catch(e){throw e}},getContactSubmission:t=>d.find(a=>a.id===t)||null,getMembershipApplication:t=>p.find(a=>a.id===t)||null,archiveContactSubmission:async t=>{try{const a=n(s,"contact_submissions",t);await o(a,{archived:!0,archived_at:r()})}catch(a){throw a}},unarchiveContactSubmission:async t=>{try{const a=n(s,"contact_submissions",t);await o(a,{archived:!1,archived_at:null})}catch(a){throw a}},archiveMembershipApplication:async t=>{try{const a=n(s,"membership_applications",t);await o(a,{archived:!0,archived_at:r()})}catch(a){throw a}},unarchiveMembershipApplication:async t=>{try{const a=n(s,"membership_applications",t);await o(a,{archived:!1,archived_at:null})}catch(a){throw a}}}}export{d as u};
