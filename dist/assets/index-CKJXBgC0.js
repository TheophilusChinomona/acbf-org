const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/Home-B_D0nv61.js","assets/ui-vendor-D2jIcmjW.js","assets/react-vendor-C9V0vZuX.js","assets/SEO-CngG18n1.js","assets/pagination-Bxp7MXxk.js","assets/pagination-BcCvKdhX.css","assets/Card-76tDQdr4.js","assets/useMembers-Cu3ivYTR.js","assets/usePosts-DZJ9m7p8.js","assets/posts-CXtdVVCU.js","assets/formatDate-DP8oCPNY.js","assets/format-4F2ZJGS8.js","assets/form-vendor-BOV3nkk-.js","assets/Home-DyjU0h27.css","assets/About-oQhkRcvr.js","assets/index-B1b2Zjr5.js","assets/ContactSection-fqvTw17j.js","assets/Blog-B_Xff6l8.js","assets/PostCard-TK8_9Ah5.js","assets/BlogPost-BN178uOb.js","assets/NotFound-Dp0oSAD1.js","assets/Portfolio-BxA2shgd.js","assets/PortfolioItem-BOshBq4A.js","assets/portfolio-DJCQ6KXv.js","assets/PortfolioItem-gjh0zVH0.css","assets/MemberItem-N-IQLamH.js","assets/Contact-BD7tGN1t.js","assets/Search-CTabhtRe.js","assets/PrivacyPolicy-BxVYG_43.js","assets/TermsOfService-CoTGSfAQ.js","assets/BecomingAMember-DdRIrj5J.js","assets/DynamicPage-BT65VKTf.js","assets/TestAuth-DyC7pvpV.js","assets/AdminLogin-CXANBv6A.js","assets/AdminDashboard-C8qGR-ou.js","assets/useSubmissions-5NLBEJYy.js","assets/StatusBadge-Bw4NcJ13.js","assets/AdminApply-cJ2YoiaP.js","assets/AdminManagement-BxaBrVRR.js","assets/SubmissionDetail-BmA-rcU6.js"])))=>i.map(i=>d[i]);
import{j as e,A as t,m as n}from"./ui-vendor-D2jIcmjW.js";import{b as r,g as s,a as i,R as o,L as a,u as c,c as l,N as u,B as h,d,e as f}from"./react-vendor-C9V0vZuX.js";import{u as p}from"./form-vendor-BOV3nkk-.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var m,g={};var y,v,w=function(){if(m)return g;m=1;var e=r();return g.createRoot=e.createRoot,g.hydrateRoot=e.hydrateRoot,g}();const b=s(function(){if(v)return y;v=1;var e="undefined"!=typeof Element,t="function"==typeof Map,n="function"==typeof Set,r="function"==typeof ArrayBuffer&&!!ArrayBuffer.isView;function s(i,o){if(i===o)return!0;if(i&&o&&"object"==typeof i&&"object"==typeof o){if(i.constructor!==o.constructor)return!1;var a,c,l,u;if(Array.isArray(i)){if((a=i.length)!=o.length)return!1;for(c=a;0!==c--;)if(!s(i[c],o[c]))return!1;return!0}if(t&&i instanceof Map&&o instanceof Map){if(i.size!==o.size)return!1;for(u=i.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;for(u=i.entries();!(c=u.next()).done;)if(!s(c.value[1],o.get(c.value[0])))return!1;return!0}if(n&&i instanceof Set&&o instanceof Set){if(i.size!==o.size)return!1;for(u=i.entries();!(c=u.next()).done;)if(!o.has(c.value[0]))return!1;return!0}if(r&&ArrayBuffer.isView(i)&&ArrayBuffer.isView(o)){if((a=i.length)!=o.length)return!1;for(c=a;0!==c--;)if(i[c]!==o[c])return!1;return!0}if(i.constructor===RegExp)return i.source===o.source&&i.flags===o.flags;if(i.valueOf!==Object.prototype.valueOf&&"function"==typeof i.valueOf&&"function"==typeof o.valueOf)return i.valueOf()===o.valueOf();if(i.toString!==Object.prototype.toString&&"function"==typeof i.toString&&"function"==typeof o.toString)return i.toString()===o.toString();if((a=(l=Object.keys(i)).length)!==Object.keys(o).length)return!1;for(c=a;0!==c--;)if(!Object.prototype.hasOwnProperty.call(o,l[c]))return!1;if(e&&i instanceof Element)return!1;for(c=a;0!==c--;)if(("_owner"!==l[c]&&"__v"!==l[c]&&"__o"!==l[c]||!i.$$typeof)&&!s(i[l[c]],o[l[c]]))return!1;return!0}return i!=i&&o!=o}return y=function(e,t){try{return s(e,t)}catch(n){if((n.message||"").match(/stack|recursion/i))return!1;throw n}}}());var _,E;var T=E?_:(E=1,_=function(e,t,n,r,s,i,o,a){if(!e){var c;if(void 0===t)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,s,i,o,a],u=0;(c=new Error(t.replace(/%s/g,function(){return l[u++]}))).name="Invariant Violation"}throw c.framesToPop=1,c}});const x=s(T);var I,S;const C=s(S?I:(S=1,I=function(e,t,n,r){var s=n?n.call(r,e,t):void 0;if(void 0!==s)return!!s;if(e===t)return!0;if("object"!=typeof e||!e||"object"!=typeof t||!t)return!1;var i=Object.keys(e),o=Object.keys(t);if(i.length!==o.length)return!1;for(var a=Object.prototype.hasOwnProperty.bind(t),c=0;c<i.length;c++){var l=i[c];if(!a(l))return!1;var u=e[l],h=t[l];if(!1===(s=n?n.call(r,u,h,l):void 0)||void 0===s&&u!==h)return!1}return!0}));var k=(e=>(e.BASE="base",e.BODY="body",e.HEAD="head",e.HTML="html",e.LINK="link",e.META="meta",e.NOSCRIPT="noscript",e.SCRIPT="script",e.STYLE="style",e.TITLE="title",e.FRAGMENT="Symbol(react.fragment)",e))(k||{}),A={rel:["amphtml","canonical","alternate"]},N={type:["application/ld+json"]},R={charset:"",name:["generator","robots","description"],property:["og:type","og:title","og:url","og:image","og:image:alt","og:description","twitter:url","twitter:title","twitter:description","twitter:image","twitter:image:alt","twitter:card","twitter:site"]},D=Object.values(k),O={accesskey:"accessKey",charset:"charSet",class:"className",contenteditable:"contentEditable",contextmenu:"contextMenu","http-equiv":"httpEquiv",itemprop:"itemProp",tabindex:"tabIndex"},L=Object.entries(O).reduce((e,[t,n])=>(e[n]=t,e),{}),P="data-rh",j="defaultTitle",M="defer",V="encodeSpecialCharacters",U="onChangeClientState",F="titleTemplate",B="prioritizeSeoTags",z=(e,t)=>{for(let n=e.length-1;n>=0;n-=1){const r=e[n];if(Object.prototype.hasOwnProperty.call(r,t))return r[t]}return null},$=e=>{let t=z(e,"title");const n=z(e,F);if(Array.isArray(t)&&(t=t.join("")),n&&t)return n.replace(/%s/g,()=>t);const r=z(e,j);return t||r||void 0},q=e=>z(e,U)||(()=>{}),H=(e,t)=>t.filter(t=>void 0!==t[e]).map(t=>t[e]).reduce((e,t)=>({...e,...t}),{}),W=(e,t)=>t.filter(e=>void 0!==e.base).map(e=>e.base).reverse().reduce((t,n)=>{if(!t.length){const r=Object.keys(n);for(let s=0;s<r.length;s+=1){const i=r[s].toLowerCase();if(-1!==e.indexOf(i)&&n[i])return t.concat(n)}}return t},[]),G=(e,t,n)=>{const r={};return n.filter(t=>!!Array.isArray(t[e])||(void 0!==t[e]&&(t[e],console&&console.warn),!1)).map(t=>t[e]).reverse().reduce((e,n)=>{const s={};n.filter(e=>{let n;const i=Object.keys(e);for(let r=0;r<i.length;r+=1){const s=i[r],o=s.toLowerCase();-1===t.indexOf(o)||"rel"===n&&"canonical"===e[n].toLowerCase()||"rel"===o&&"stylesheet"===e[o].toLowerCase()||(n=o),-1===t.indexOf(s)||"innerHTML"!==s&&"cssText"!==s&&"itemprop"!==s||(n=s)}if(!n||!e[n])return!1;const o=e[n].toLowerCase();return r[n]||(r[n]={}),s[n]||(s[n]={}),!r[n][o]&&(s[n][o]=!0,!0)}).reverse().forEach(t=>e.push(t));const i=Object.keys(s);for(let t=0;t<i.length;t+=1){const e=i[t],n={...r[e],...s[e]};r[e]=n}return e},[]).reverse()},K=(e,t)=>{if(Array.isArray(e)&&e.length)for(let n=0;n<e.length;n+=1){if(e[n][t])return!0}return!1},Q=e=>Array.isArray(e)?e.join(""):e,Y=(e,t)=>Array.isArray(e)?e.reduce((e,n)=>(((e,t)=>{const n=Object.keys(e);for(let r=0;r<n.length;r+=1)if(t[n[r]]&&t[n[r]].includes(e[n[r]]))return!0;return!1})(n,t)?e.priority.push(n):e.default.push(n),e),{priority:[],default:[]}):{default:e,priority:[]},X=(e,t)=>({...e,[t]:void 0}),J=["noscript","script","style"],Z=(e,t=!0)=>!1===t?String(e):String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;"),ee=e=>Object.keys(e).reduce((t,n)=>{const r=void 0!==e[n]?`${n}="${e[n]}"`:`${n}`;return t?`${t} ${r}`:r},""),te=(e,t={})=>Object.keys(e).reduce((t,n)=>(t[O[n]||n]=e[n],t),t),ne=(e,t)=>t.map((t,n)=>{const r={key:n,[P]:!0};return Object.keys(t).forEach(e=>{const n=O[e]||e;if("innerHTML"===n||"cssText"===n){const e=t.innerHTML||t.cssText;r.dangerouslySetInnerHTML={__html:e}}else r[n]=t[e]}),o.createElement(e,r)}),re=(e,t,n=!0)=>{switch(e){case"title":return{toComponent:()=>((e,t,n)=>{const r=te(n,{key:t,[P]:!0});return[o.createElement("title",r,t)]})(0,t.title,t.titleAttributes),toString:()=>((e,t,n,r)=>{const s=ee(n),i=Q(t);return s?`<${e} ${P}="true" ${s}>${Z(i,r)}</${e}>`:`<${e} ${P}="true">${Z(i,r)}</${e}>`})(e,t.title,t.titleAttributes,n)};case"bodyAttributes":case"htmlAttributes":return{toComponent:()=>te(t),toString:()=>ee(t)};default:return{toComponent:()=>ne(e,t),toString:()=>((e,t,n=!0)=>t.reduce((t,r)=>{const s=r,i=Object.keys(s).filter(e=>!("innerHTML"===e||"cssText"===e)).reduce((e,t)=>{const r=void 0===s[t]?t:`${t}="${Z(s[t],n)}"`;return e?`${e} ${r}`:r},""),o=s.innerHTML||s.cssText||"",a=-1===J.indexOf(e);return`${t}<${e} ${P}="true" ${i}${a?"/>":`>${o}</${e}>`}`},""))(e,t,n)}}},se=e=>{const{baseTag:t,bodyAttributes:n,encode:r=!0,htmlAttributes:s,noscriptTags:i,styleTags:o,title:a="",titleAttributes:c,prioritizeSeoTags:l}=e;let{linkTags:u,metaTags:h,scriptTags:d}=e,f={toComponent:()=>{},toString:()=>""};return l&&({priorityMethods:f,linkTags:u,metaTags:h,scriptTags:d}=(({metaTags:e,linkTags:t,scriptTags:n,encode:r})=>{const s=Y(e,R),i=Y(t,A),o=Y(n,N);return{priorityMethods:{toComponent:()=>[...ne("meta",s.priority),...ne("link",i.priority),...ne("script",o.priority)],toString:()=>`${re("meta",s.priority,r)} ${re("link",i.priority,r)} ${re("script",o.priority,r)}`},metaTags:s.default,linkTags:i.default,scriptTags:o.default}})(e)),{priority:f,base:re("base",t,r),bodyAttributes:re("bodyAttributes",n,r),htmlAttributes:re("htmlAttributes",s,r),link:re("link",u,r),meta:re("meta",h,r),noscript:re("noscript",i,r),script:re("script",d,r),style:re("style",o,r),title:re("title",{title:a,titleAttributes:c},r)}},ie=[],oe=!("undefined"==typeof window||!window.document||!window.document.createElement),ae=class{instances=[];canUseDOM=oe;context;value={setHelmet:e=>{this.context.helmet=e},helmetInstances:{get:()=>this.canUseDOM?ie:this.instances,add:e=>{(this.canUseDOM?ie:this.instances).push(e)},remove:e=>{const t=(this.canUseDOM?ie:this.instances).indexOf(e);(this.canUseDOM?ie:this.instances).splice(t,1)}}};constructor(e,t){this.context=e,this.canUseDOM=t||!1,t||(e.helmet=se({baseTag:[],bodyAttributes:{},htmlAttributes:{},linkTags:[],metaTags:[],noscriptTags:[],scriptTags:[],styleTags:[],title:"",titleAttributes:{}}))}},ce=o.createContext({}),le=class e extends i.Component{static canUseDOM=oe;helmetData;constructor(t){super(t),this.helmetData=new ae(this.props.context||{},e.canUseDOM)}render(){return o.createElement(ce.Provider,{value:this.helmetData.value},this.props.children)}},ue=(e,t)=>{const n=document.head||document.querySelector("head"),r=n.querySelectorAll(`${e}[${P}]`),s=[].slice.call(r),i=[];let o;return t&&t.length&&t.forEach(t=>{const n=document.createElement(e);for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))if("innerHTML"===e)n.innerHTML=t.innerHTML;else if("cssText"===e)n.styleSheet?n.styleSheet.cssText=t.cssText:n.appendChild(document.createTextNode(t.cssText));else{const r=e,s=void 0===t[r]?"":t[r];n.setAttribute(e,s)}n.setAttribute(P,"true"),s.some((e,t)=>(o=t,n.isEqualNode(e)))?s.splice(o,1):i.push(n)}),s.forEach(e=>e.parentNode?.removeChild(e)),i.forEach(e=>n.appendChild(e)),{oldTags:s,newTags:i}},he=(e,t)=>{const n=document.getElementsByTagName(e)[0];if(!n)return;const r=n.getAttribute(P),s=r?r.split(","):[],i=[...s],o=Object.keys(t);for(const a of o){const e=t[a]||"";n.getAttribute(a)!==e&&n.setAttribute(a,e),-1===s.indexOf(a)&&s.push(a);const r=i.indexOf(a);-1!==r&&i.splice(r,1)}for(let a=i.length-1;a>=0;a-=1)n.removeAttribute(i[a]);s.length===i.length?n.removeAttribute(P):n.getAttribute(P)!==o.join(",")&&n.setAttribute(P,o.join(","))},de=(e,t)=>{const{baseTag:n,bodyAttributes:r,htmlAttributes:s,linkTags:i,metaTags:o,noscriptTags:a,onChangeClientState:c,scriptTags:l,styleTags:u,title:h,titleAttributes:d}=e;he("body",r),he("html",s),((e,t)=>{void 0!==e&&document.title!==e&&(document.title=Q(e)),he("title",t)})(h,d);const f={baseTag:ue("base",n),linkTags:ue("link",i),metaTags:ue("meta",o),noscriptTags:ue("noscript",a),scriptTags:ue("script",l),styleTags:ue("style",u)},p={},m={};Object.keys(f).forEach(e=>{const{newTags:t,oldTags:n}=f[e];t.length&&(p[e]=t),n.length&&(m[e]=f[e].oldTags)}),t&&t(),c(e,p,m)},fe=null,pe=e=>{fe&&cancelAnimationFrame(fe),e.defer?fe=requestAnimationFrame(()=>{de(e,()=>{fe=null})}):(de(e),fe=null)},me=class extends i.Component{rendered=!1;shouldComponentUpdate(e){return!C(e,this.props)}componentDidUpdate(){this.emitChange()}componentWillUnmount(){const{helmetInstances:e}=this.props.context;e.remove(this),this.emitChange()}emitChange(){const{helmetInstances:e,setHelmet:t}=this.props.context;let n=null;const r=(s=e.get().map(e=>{const t={...e.props};return delete t.context,t}),{baseTag:W(["href"],s),bodyAttributes:H("bodyAttributes",s),defer:z(s,M),encode:z(s,V),htmlAttributes:H("htmlAttributes",s),linkTags:G("link",["rel","href"],s),metaTags:G("meta",["name","charset","http-equiv","property","itemprop"],s),noscriptTags:G("noscript",["innerHTML"],s),onChangeClientState:q(s),scriptTags:G("script",["src","innerHTML"],s),styleTags:G("style",["cssText"],s),title:$(s),titleAttributes:H("titleAttributes",s),prioritizeSeoTags:K(s,B)});var s;le.canUseDOM?pe(r):se&&(n=se(r)),t(n)}init(){if(this.rendered)return;this.rendered=!0;const{helmetInstances:e}=this.props.context;e.add(this),this.emitChange()}render(){return this.init(),null}},ge=class extends i.Component{static defaultProps={defer:!0,encodeSpecialCharacters:!0,prioritizeSeoTags:!1};shouldComponentUpdate(e){return!b(X(this.props,"helmetData"),X(e,"helmetData"))}mapNestedChildrenToProps(e,t){if(!t)return null;switch(e.type){case"script":case"noscript":return{innerHTML:t};case"style":return{cssText:t};default:throw new Error(`<${e.type} /> elements are self-closing and can not contain children. Refer to our API for more information.`)}}flattenArrayTypeChildren(e,t,n,r){return{...t,[e.type]:[...t[e.type]||[],{...n,...this.mapNestedChildrenToProps(e,r)}]}}mapObjectTypeChildren(e,t,n,r){switch(e.type){case"title":return{...t,[e.type]:r,titleAttributes:{...n}};case"body":return{...t,bodyAttributes:{...n}};case"html":return{...t,htmlAttributes:{...n}};default:return{...t,[e.type]:{...n}}}}mapArrayTypeChildrenToProps(e,t){let n={...t};return Object.keys(e).forEach(t=>{n={...n,[t]:e[t]}}),n}warnOnInvalidChildren(e,t){return x(D.some(t=>e.type===t),"function"==typeof e.type?"You may be attempting to nest <Helmet> components within each other, which is not allowed. Refer to our API for more information.":`Only elements types ${D.join(", ")} are allowed. Helmet does not support rendering <${e.type}> elements. Refer to our API for more information.`),x(!t||"string"==typeof t||Array.isArray(t)&&!t.some(e=>"string"!=typeof e),`Helmet expects a string as a child of <${e.type}>. Did you forget to wrap your children in braces? ( <${e.type}>{\`\`}</${e.type}> ) Refer to our API for more information.`),!0}mapChildrenToProps(e,t){let n={};return o.Children.forEach(e,e=>{if(!e||!e.props)return;const{children:r,...s}=e.props,i=Object.keys(s).reduce((e,t)=>(e[L[t]||t]=s[t],e),{});let{type:o}=e;switch("symbol"==typeof o?o=o.toString():this.warnOnInvalidChildren(e,r),o){case"Symbol(react.fragment)":t=this.mapChildrenToProps(r,t);break;case"link":case"meta":case"noscript":case"script":case"style":n=this.flattenArrayTypeChildren(e,n,i,r);break;default:t=this.mapObjectTypeChildren(e,t,i,r)}}),this.mapArrayTypeChildrenToProps(n,t)}render(){const{children:e,...t}=this.props;let n={...t},{helmetData:r}=t;if(e&&(n=this.mapChildrenToProps(e,n)),r&&!(r instanceof ae)){r=new ae(r.context,!0),delete n.helmetData}return r?o.createElement(me,{...n,context:r.value}):o.createElement(ce.Consumer,null,e=>o.createElement(me,{...n,context:e}))}};const ye={},ve=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){let e=function(e){return Promise.all(e.map(e=>Promise.resolve(e).then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e}))))};document.getElementsByTagName("link");const n=document.querySelector("meta[property=csp-nonce]"),s=n?.nonce||n?.getAttribute("nonce");r=e(t.map(e=>{if((e=function(e){return"/"+e}(e))in ye)return;ye[e]=!0;const t=e.endsWith(".css"),n=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${n}`))return;const r=document.createElement("link");return r.rel=t?"stylesheet":"modulepreload",t||(r.as="script"),r.crossOrigin="",r.href=e,s&&r.setAttribute("nonce",s),document.head.appendChild(r),t?new Promise((t,n)=>{r.addEventListener("load",t),r.addEventListener("error",()=>n(new Error(`Unable to preload CSS for ${e}`)))}):void 0}))}function s(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then(t=>{for(const e of t||[])"rejected"===e.status&&s(e.reason);return e().catch(s)})};let we,be,_e,Ee={data:""},Te=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,xe=/\/\*[^]*?\*\/|  +/g,Ie=/\n+/g,Se=(e,t)=>{let n="",r="",s="";for(let i in e){let o=e[i];"@"==i[0]?"i"==i[1]?n=i+" "+o+";":r+="f"==i[1]?Se(o,i):i+"{"+Se(o,"k"==i[1]?"":t)+"}":"object"==typeof o?r+=Se(o,t?t.replace(/([^,])+/g,e=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)):i):null!=o&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Se.p?Se.p(i,o):i+":"+o+";")}return n+(t&&s?t+"{"+s+"}":s)+r},Ce={},ke=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+ke(e[n]);return t}return e};function Ae(e){let t=this||{},n=e.call?e(t.p):e;return((e,t,n,r,s)=>{let i=ke(e),o=Ce[i]||(Ce[i]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(i));if(!Ce[o]){let t=i!==e?e:(e=>{let t,n,r=[{}];for(;t=Te.exec(e.replace(xe,""));)t[4]?r.shift():t[3]?(n=t[3].replace(Ie," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(Ie," ").trim();return r[0]})(e);Ce[o]=Se(s?{["@keyframes "+o]:t}:t,n?"":"."+o)}let a=n&&Ce.g?Ce.g:null;return n&&(Ce.g=Ce[o]),c=Ce[o],l=t,u=r,(h=a)?l.data=l.data.replace(h,c):-1===l.data.indexOf(c)&&(l.data=u?c+l.data:l.data+c),o;var c,l,u,h})(n.unshift?n.raw?((e,t,n)=>e.reduce((e,r,s)=>{let i=t[s];if(i&&i.call){let e=i(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;i=t?"."+t:e&&"object"==typeof e?e.props?"":Se(e,""):!1===e?"":e}return e+r+(null==i?"":i)},""))(n,[].slice.call(arguments,1),t.p):n.reduce((e,n)=>Object.assign(e,n&&n.call?n(t.p):n),{}):n,(e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||Ee})(t.target),t.g,t.o,t.k)}Ae.bind({g:1});let Ne=Ae.bind({k:1});function Re(e,t){let n=this||{};return function(){let t=arguments;return function r(s,i){let o=Object.assign({},s),a=o.className||r.className;n.p=Object.assign({theme:be&&be()},o),n.o=/ *go\d+/.test(a),o.className=Ae.apply(n,t)+(a?" "+a:"");let c=e;return e[0]&&(c=o.as||e,delete o.as),_e&&c[0]&&_e(o),we(c,o)}}}var De=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,Oe=(()=>{let e=0;return()=>(++e).toString()})(),Le=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Pe="default",je=(e,t)=>{let{toastLimit:n}=e.settings;switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,n)};case 1:return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case 2:let{toast:r}=t;return je(e,{type:e.toasts.find(e=>e.id===r.id)?1:0,toast:r});case 3:let{toastId:s}=t;return{...e,toasts:e.toasts.map(e=>e.id===s||void 0===s?{...e,dismissed:!0,visible:!1}:e)};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(e=>({...e,pauseDuration:e.pauseDuration+i}))}}},Me=[],Ve={toasts:[],pausedAt:void 0,settings:{toastLimit:20}},Ue={},Fe=(e,t=Pe)=>{Ue[t]=je(Ue[t]||Ve,e),Me.forEach(([e,n])=>{e===t&&n(Ue[t])})},Be=e=>Object.keys(Ue).forEach(t=>Fe(e,t)),ze=(e=Pe)=>t=>{Fe(t,e)},$e={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},qe=e=>(t,n)=>{let r=((e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||Oe()}))(t,e,n);return ze(r.toasterId||(e=>Object.keys(Ue).find(t=>Ue[t].toasts.some(t=>t.id===e)))(r.id))({type:2,toast:r}),r.id},He=(e,t)=>qe("blank")(e,t);He.error=qe("error"),He.success=qe("success"),He.loading=qe("loading"),He.custom=qe("custom"),He.dismiss=(e,t)=>{let n={type:3,toastId:e};t?ze(t)(n):Be(n)},He.dismissAll=e=>He.dismiss(void 0,e),He.remove=(e,t)=>{let n={type:4,toastId:e};t?ze(t)(n):Be(n)},He.removeAll=e=>He.remove(void 0,e),He.promise=(e,t,n)=>{let r=He.loading(t.loading,{...n,...null==n?void 0:n.loading});return"function"==typeof e&&(e=e()),e.then(e=>{let s=t.success?De(t.success,e):void 0;return s?He.success(s,{id:r,...n,...null==n?void 0:n.success}):He.dismiss(r),e}).catch(e=>{let s=t.error?De(t.error,e):void 0;s?He.error(s,{id:r,...n,...null==n?void 0:n.error}):He.dismiss(r)}),e};var We,Ge,Ke,Qe,Ye=(e,t="default")=>{let{toasts:n,pausedAt:r}=((e={},t=Pe)=>{let[n,r]=i.useState(Ue[t]||Ve),s=i.useRef(Ue[t]);i.useEffect(()=>(s.current!==Ue[t]&&r(Ue[t]),Me.push([t,r]),()=>{let e=Me.findIndex(([e])=>e===t);e>-1&&Me.splice(e,1)}),[t]);let o=n.toasts.map(t=>{var n,r,s;return{...e,...e[t.type],...t,removeDelay:t.removeDelay||(null==(n=e[t.type])?void 0:n.removeDelay)||(null==e?void 0:e.removeDelay),duration:t.duration||(null==(r=e[t.type])?void 0:r.duration)||(null==e?void 0:e.duration)||$e[t.type],style:{...e.style,...null==(s=e[t.type])?void 0:s.style,...t.style}}});return{...n,toasts:o}})(e,t),s=i.useRef(new Map).current,o=i.useCallback((e,t=1e3)=>{if(s.has(e))return;let n=setTimeout(()=>{s.delete(e),a({type:4,toastId:e})},t);s.set(e,n)},[]);i.useEffect(()=>{if(r)return;let e=Date.now(),s=n.map(n=>{if(n.duration===1/0)return;let r=(n.duration||0)+n.pauseDuration-(e-n.createdAt);if(!(r<0))return setTimeout(()=>He.dismiss(n.id,t),r);n.visible&&He.dismiss(n.id)});return()=>{s.forEach(e=>e&&clearTimeout(e))}},[n,r,t]);let a=i.useCallback(ze(t),[t]),c=i.useCallback(()=>{a({type:5,time:Date.now()})},[a]),l=i.useCallback((e,t)=>{a({type:1,toast:{id:e,height:t}})},[a]),u=i.useCallback(()=>{r&&a({type:6,time:Date.now()})},[r,a]),h=i.useCallback((e,t)=>{let{reverseOrder:r=!1,gutter:s=8,defaultPosition:i}=t||{},o=n.filter(t=>(t.position||i)===(e.position||i)&&t.height),a=o.findIndex(t=>t.id===e.id),c=o.filter((e,t)=>t<a&&e.visible).length;return o.filter(e=>e.visible).slice(...r?[c+1]:[0,c]).reduce((e,t)=>e+(t.height||0)+s,0)},[n]);return i.useEffect(()=>{n.forEach(e=>{if(e.dismissed)o(e.id,e.removeDelay);else{let t=s.get(e.id);t&&(clearTimeout(t),s.delete(e.id))}})},[n,o]),{toasts:n,handlers:{updateHeight:l,startPause:c,endPause:u,calculateOffset:h}}},Xe=Ne`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Je=Ne`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Ze=Ne`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,et=Re("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Xe} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Je} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Ze} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,tt=Ne`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,nt=Re("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${tt} 1s linear infinite;
`,rt=Ne`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,st=Ne`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,it=Re("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${rt} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${st} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,ot=Re("div")`
  position: absolute;
`,at=Re("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,ct=Ne`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,lt=Re("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${ct} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,ut=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return void 0!==t?"string"==typeof t?i.createElement(lt,null,t):t:"blank"===n?null:i.createElement(at,null,i.createElement(nt,{...r}),"loading"!==n&&i.createElement(ot,null,"error"===n?i.createElement(et,{...r}):i.createElement(it,{...r})))},ht=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,dt=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,ft=Re("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,pt=Re("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,mt=i.memo(({toast:e,position:t,style:n,children:r})=>{let s=e.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,s]=Le()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[ht(n),dt(n)];return{animation:t?`${Ne(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${Ne(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(e.position||t||"top-center",e.visible):{opacity:0},o=i.createElement(ut,{toast:e}),a=i.createElement(pt,{...e.ariaProps},De(e.message,e));return i.createElement(ft,{className:e.className,style:{...s,...n,...e.style}},"function"==typeof r?r({icon:o,message:a}):i.createElement(i.Fragment,null,o,a))});We=i.createElement,Se.p=Ge,we=We,be=Ke,_e=Qe;var gt=({id:e,className:t,style:n,onHeightUpdate:r,children:s})=>{let o=i.useCallback(t=>{if(t){let n=()=>{let n=t.getBoundingClientRect().height;r(e,n)};n(),new MutationObserver(n).observe(t,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return i.createElement("div",{ref:o,className:t,style:n},s)},yt=Ae`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,vt=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:s,toasterId:o,containerStyle:a,containerClassName:c})=>{let{toasts:l,handlers:u}=Ye(n,o);return i.createElement("div",{"data-rht-toaster":o||"",style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...a},className:c,onMouseEnter:u.startPause,onMouseLeave:u.endPause},l.map(n=>{let o=n.position||t,a=((e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:Le()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...s}})(o,u.calculateOffset(n,{reverseOrder:e,gutter:r,defaultPosition:t}));return i.createElement(gt,{id:n.id,key:n.id,onHeightUpdate:u.updateHeight,className:n.visible?yt:"",style:a},"custom"===n.type?De(n.message,n):s?s(n):i.createElement(mt,{toast:n,position:o}))}))},wt=He;const bt=i.createContext();function _t({children:t}){const[n,r]=i.useState(!1),[s,o]=i.useState(!1);return e.jsx(bt.Provider,{value:{mobileMenuOpen:n,setMobileMenuOpen:r,searchOpen:s,setSearchOpen:o},children:t})}var Et={};const Tt=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let s=e.charCodeAt(r);s<128?t[n++]=s:s<2048?(t[n++]=s>>6|192,t[n++]=63&s|128):55296==(64512&s)&&r+1<e.length&&56320==(64512&e.charCodeAt(r+1))?(s=65536+((1023&s)<<10)+(1023&e.charCodeAt(++r)),t[n++]=s>>18|240,t[n++]=s>>12&63|128,t[n++]=s>>6&63|128,t[n++]=63&s|128):(t[n++]=s>>12|224,t[n++]=s>>6&63|128,t[n++]=63&s|128)}return t},xt={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<e.length;s+=3){const t=e[s],i=s+1<e.length,o=i?e[s+1]:0,a=s+2<e.length,c=a?e[s+2]:0,l=t>>2,u=(3&t)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,i||(h=64)),r.push(n[l],n[u],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(Tt(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const s=e[n++];if(s<128)t[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=e[n++];t[r++]=String.fromCharCode((31&s)<<6|63&i)}else if(s>239&&s<365){const i=((7&s)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(i>>10)),t[r++]=String.fromCharCode(56320+(1023&i))}else{const i=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&s)<<12|(63&i)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<e.length;){const t=n[e.charAt(s++)],i=s<e.length?n[e.charAt(s)]:0;++s;const o=s<e.length?n[e.charAt(s)]:64;++s;const a=s<e.length?n[e.charAt(s)]:64;if(++s,null==t||null==i||null==o||null==a)throw new It;const c=t<<2|i>>4;if(r.push(c),64!==o){const e=i<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class It extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const St=function(e){return function(e){const t=Tt(e);return xt.encodeByteArray(t,!0)}(e).replace(/\./g,"")},Ct=function(e){try{return xt.decodeString(e,!0)}catch(We){}return null};const kt=()=>function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("Unable to locate global object.")}().__FIREBASE_DEFAULTS__,At=()=>{try{return kt()||(()=>{if("undefined"==typeof process)return;const e=Et.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"==typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(We){return}const t=e&&Ct(e[1]);return t&&JSON.parse(t)})()}catch(We){return}},Nt=e=>At()?.emulatorHosts?.[e],Rt=()=>At()?.config,Dt=e=>At()?.[`_${e}`];class Ot{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}function Lt(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function Pt(e){return(await fetch(e,{credentials:"include"})).ok}const jt={};let Mt=!1;function Vt(e,t){if("undefined"==typeof window||"undefined"==typeof document||!Lt(window.location.host)||jt[e]===t||jt[e]||Mt)return;function n(e){return`__firebase__banner__${e}`}jt[e]=t;const r="__firebase__banner",s=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(jt))jt[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function i(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{Mt=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),l=n("preprendIcon"),u=document.getElementById(l)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(c,a);const n=i();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(u,l),t.append(u,o,c,n),document.body.appendChild(t)}s?(o.innerText="Preview backend disconnected.",u.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(u.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function Ut(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function Ft(){return!function(){const e=At()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(global.process)}catch(We){return!1}}()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}class Bt extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,Bt.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,zt.prototype.create)}}class zt{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,s=this.errors[e],i=s?function(e,t){return e.replace($t,(e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`})}(s,n):"Error",o=`${this.serviceName}: ${i} (${r}).`;return new Bt(r,o,n)}}const $t=/\{\$([^}]+)}/g;function qt(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const s of n){if(!r.includes(s))return!1;const n=e[s],i=t[s];if(Ht(n)&&Ht(i)){if(!qt(n,i))return!1}else if(n!==i)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Ht(e){return null!==e&&"object"==typeof e}function Wt(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Gt(e){const t={};return e.replace(/^\?/,"").split("&").forEach(e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function Kt(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}class Qt{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!=typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=Yt),void 0===r.error&&(r.error=Yt),void 0===r.complete&&(r.complete=Yt);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(We){}}),this.observers.push(r),s}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(We){"undefined"!=typeof console&&console.error}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Yt(){}function Xt(e){return e&&e._delegate?e._delegate:e}class Jt{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Zt="[DEFAULT]";class en{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new Ot;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(We){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(We){if(n)return null;throw We}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Zt})}catch(We){}for(const[e,t]of this.instancesDeferred.entries()){const n=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(We){}}}}clearInstance(e=Zt){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=Zt){return this.instances.has(e)}getOptions(e=Zt){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,i]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(s)&&i.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const s=this.instances.get(n);return s&&e(s,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===Zt?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=Zt){return this.component?this.component.multipleInstances?e:Zt:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class tn{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new en(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}var nn,rn;(rn=nn||(nn={}))[rn.DEBUG=0]="DEBUG",rn[rn.VERBOSE=1]="VERBOSE",rn[rn.INFO=2]="INFO",rn[rn.WARN=3]="WARN",rn[rn.ERROR=4]="ERROR",rn[rn.SILENT=5]="SILENT";const sn={debug:nn.DEBUG,verbose:nn.VERBOSE,info:nn.INFO,warn:nn.WARN,error:nn.ERROR,silent:nn.SILENT},on=nn.INFO,an={[nn.DEBUG]:"log",[nn.VERBOSE]:"log",[nn.INFO]:"info",[nn.WARN]:"warn",[nn.ERROR]:"error"},cn=(e,t,...n)=>{if(t<e.logLevel)return;(new Date).toISOString();if(!an[t])throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class ln{constructor(e){this.name=e,this._logLevel=on,this._logHandler=cn,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in nn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?sn[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,nn.DEBUG,...e),this._logHandler(this,nn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,nn.VERBOSE,...e),this._logHandler(this,nn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,nn.INFO,...e),this._logHandler(this,nn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,nn.WARN,...e),this._logHandler(this,nn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,nn.ERROR,...e),this._logHandler(this,nn.ERROR,...e)}}let un,hn;const dn=new WeakMap,fn=new WeakMap,pn=new WeakMap,mn=new WeakMap,gn=new WeakMap;let yn={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return fn.get(e);if("objectStoreNames"===t)return e.objectStoreNames||pn.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bn(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function vn(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(hn||(hn=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(_n(this),t),bn(dn.get(this))}:function(...t){return bn(e.apply(_n(this),t))}:function(t,...n){const r=e.call(_n(this),t,...n);return pn.set(r,t.sort?t.sort():[t]),bn(r)}}function wn(e){return"function"==typeof e?vn(e):(e instanceof IDBTransaction&&function(e){if(fn.has(e))return;const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("complete",s),e.removeEventListener("error",i),e.removeEventListener("abort",i)},s=()=>{t(),r()},i=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",s),e.addEventListener("error",i),e.addEventListener("abort",i)});fn.set(e,t)}(e),t=e,(un||(un=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some(e=>t instanceof e)?new Proxy(e,yn):e);var t}function bn(e){if(e instanceof IDBRequest)return function(e){const t=new Promise((t,n)=>{const r=()=>{e.removeEventListener("success",s),e.removeEventListener("error",i)},s=()=>{t(bn(e.result)),r()},i=()=>{n(e.error),r()};e.addEventListener("success",s),e.addEventListener("error",i)});return t.then(t=>{t instanceof IDBCursor&&dn.set(t,e)}).catch(()=>{}),gn.set(t,e),t}(e);if(mn.has(e))return mn.get(e);const t=wn(e);return t!==e&&(mn.set(e,t),gn.set(t,e)),t}const _n=e=>gn.get(e);const En=["get","getKey","getAll","getAllKeys","count"],Tn=["put","add","delete","clear"],xn=new Map;function In(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!=typeof t)return;if(xn.get(t))return xn.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,s=Tn.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!s&&!En.includes(n))return;const i=async function(e,...t){const i=this.transaction(e,s?"readwrite":"readonly");let o=i.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),s&&i.done]))[0]};return xn.set(t,i),i}yn=(e=>({...e,get:(t,n,r)=>In(t,n)||e.get(t,n,r),has:(t,n)=>!!In(t,n)||e.has(t,n)}))(yn);class Sn{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null}).filter(e=>e).join(" ")}}const Cn="@firebase/app",kn="0.14.5",An=new ln("@firebase/app"),Nn="@firebase/app-compat",Rn="@firebase/analytics-compat",Dn="@firebase/analytics",On="@firebase/app-check-compat",Ln="@firebase/app-check",Pn="@firebase/auth",jn="@firebase/auth-compat",Mn="@firebase/database",Vn="@firebase/data-connect",Un="@firebase/database-compat",Fn="@firebase/functions",Bn="@firebase/functions-compat",zn="@firebase/installations",$n="@firebase/installations-compat",qn="@firebase/messaging",Hn="@firebase/messaging-compat",Wn="@firebase/performance",Gn="@firebase/performance-compat",Kn="@firebase/remote-config",Qn="@firebase/remote-config-compat",Yn="@firebase/storage",Xn="@firebase/storage-compat",Jn="@firebase/firestore",Zn="@firebase/ai",er="@firebase/firestore-compat",tr="firebase",nr="[DEFAULT]",rr={[Cn]:"fire-core",[Nn]:"fire-core-compat",[Dn]:"fire-analytics",[Rn]:"fire-analytics-compat",[Ln]:"fire-app-check",[On]:"fire-app-check-compat",[Pn]:"fire-auth",[jn]:"fire-auth-compat",[Mn]:"fire-rtdb",[Vn]:"fire-data-connect",[Un]:"fire-rtdb-compat",[Fn]:"fire-fn",[Bn]:"fire-fn-compat",[zn]:"fire-iid",[$n]:"fire-iid-compat",[qn]:"fire-fcm",[Hn]:"fire-fcm-compat",[Wn]:"fire-perf",[Gn]:"fire-perf-compat",[Kn]:"fire-rc",[Qn]:"fire-rc-compat",[Yn]:"fire-gcs",[Xn]:"fire-gcs-compat",[Jn]:"fire-fst",[er]:"fire-fst-compat",[Zn]:"fire-vertex","fire-js":"fire-js",[tr]:"fire-js-all"},sr=new Map,ir=new Map,or=new Map;function ar(e,t){try{e.container.addComponent(t)}catch(We){An.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,We)}}function cr(e){const t=e.name;if(or.has(t))return An.debug(`There were multiple attempts to register component ${t}.`),!1;or.set(t,e);for(const n of sr.values())ar(n,e);for(const n of ir.values())ar(n,e);return!0}function lr(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function ur(e){return null!=e&&void 0!==e.settings}const hr=new zt("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class dr{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jt("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw hr.create("app-deleted",{appName:this._name})}}const fr="12.5.0";function pr(e,t={}){let n=e;if("object"!=typeof t){t={name:t}}const r={name:nr,automaticDataCollectionEnabled:!0,...t},s=r.name;if("string"!=typeof s||!s)throw hr.create("bad-app-name",{appName:String(s)});if(n||(n=Rt()),!n)throw hr.create("no-options");const i=sr.get(s);if(i){if(qt(n,i.options)&&qt(r,i.config))return i;throw hr.create("duplicate-app",{appName:s})}const o=new tn(s);for(const c of or.values())o.addComponent(c);const a=new dr(n,r,o);return sr.set(s,a),a}function mr(e=nr){const t=sr.get(e);if(!t&&e===nr&&Rt())return pr();if(!t)throw hr.create("no-app",{appName:e});return t}function gr(e,t,n){let r=rr[e]??e;n&&(r+=`-${n}`);const s=r.match(/\s|\//),i=t.match(/\s|\//);if(s||i){const e=[`Unable to register library "${r}" with version "${t}":`];return s&&e.push(`library name "${r}" contains illegal characters (whitespace or "/")`),s&&i&&e.push("and"),i&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void An.warn(e.join(" "))}cr(new Jt(`${r}-version`,()=>({library:r,version:t}),"VERSION"))}const yr="firebase-heartbeat-store";let vr=null;function wr(){return vr||(vr=function(e,t,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(e,t),a=bn(o);return r&&o.addEventListener("upgradeneeded",e=>{r(bn(o.result),e.oldVersion,e.newVersion,bn(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{i&&e.addEventListener("close",()=>i()),s&&e.addEventListener("versionchange",e=>s(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(yr)}catch(We){}}}).catch(e=>{throw hr.create("idb-open",{originalErrorMessage:e.message})})),vr}async function br(e,t){try{const n=(await wr()).transaction(yr,"readwrite"),r=n.objectStore(yr);await r.put(t,_r(e)),await n.done}catch(We){if(We instanceof Bt)An.warn(We.message);else{const t=hr.create("idb-set",{originalErrorMessage:We?.message});An.warn(t.message)}}}function _r(e){return`${e.name}!${e.options.appId}`}class Er{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new xr(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=Tr();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(We){An.warn(We)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=Tr(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const s of e){const e=n.find(e=>e.agent===s.agent);if(e){if(e.dates.push(s.date),Ir(n)>t){e.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ir(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=St(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(We){return An.warn(We),""}}}function Tr(){return(new Date).toISOString().substring(0,10)}class xr{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!function(){try{return"object"==typeof indexedDB}catch(We){return!1}}()&&new Promise((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{t(s.error?.message||"")}}catch(n){t(n)}}).then(()=>!0).catch(()=>!1)}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await wr()).transaction(yr),n=await t.objectStore(yr).get(_r(e));return await t.done,n}catch(We){if(We instanceof Bt)An.warn(We.message);else{const t=hr.create("idb-get",{originalErrorMessage:We?.message});An.warn(t.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return br(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return br(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function Ir(e){return St(JSON.stringify({version:2,heartbeats:e})).length}var Sr;function Cr(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}Sr="",cr(new Jt("platform-logger",e=>new Sn(e),"PRIVATE")),cr(new Jt("heartbeat",e=>new Er(e),"PRIVATE")),gr(Cn,kn,Sr),gr(Cn,kn,"esm2020"),gr("fire-js","");const kr=Cr,Ar=new zt("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),Nr=new ln("@firebase/auth");function Rr(e,...t){Nr.logLevel<=nn.ERROR&&Nr.error(`Auth (${fr}): ${e}`,...t)}function Dr(e,...t){throw jr(e,...t)}function Or(e,...t){return jr(e,...t)}function Lr(e,t,n){const r={...kr(),[t]:n};return new zt("auth","Firebase",r).create(t,{appName:e.name})}function Pr(e){return Lr(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function jr(e,...t){if("string"!=typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return Ar.create(e,...t)}function Mr(e,t,...n){if(!e)throw jr(t,...n)}function Vr(e){const t="INTERNAL ASSERTION FAILED: "+e;throw Rr(t),new Error(t)}function Ur(e,t){e||Vr(t)}function Fr(){return"undefined"!=typeof self&&self.location?.href||""}function Br(){return"undefined"!=typeof self&&self.location?.protocol||null}function zr(){return"undefined"==typeof navigator||!navigator||!("onLine"in navigator)||"boolean"!=typeof navigator.onLine||"http:"!==Br()&&"https:"!==Br()&&!function(){const e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}()&&!("connection"in navigator)||navigator.onLine}class $r{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ur(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ut())||"object"==typeof navigator&&"ReactNative"===navigator.product}get(){return zr()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function qr(e,t){Ur(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Hr{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:"undefined"!=typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!=typeof fetch?fetch:void Vr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:"undefined"!=typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!=typeof Headers?Headers:void Vr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:"undefined"!=typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!=typeof Response?Response:void Vr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Wr={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Gr=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Kr=new $r(3e4,6e4);function Qr(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function Yr(e,t,n,r,s={}){return Xr(e,s,async()=>{let s={},i={};r&&("GET"===t?i=r:s={body:JSON.stringify(r)});const o=Wt({key:e.config.apiKey,...i}).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const c={method:t,headers:a,...s};return"undefined"!=typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(c.referrerPolicy="no-referrer"),e.emulatorConfig&&Lt(e.emulatorConfig.host)&&(c.credentials="include"),Hr.fetch()(await Zr(e,e.config.apiHost,n,o),c)})}async function Xr(e,t,n){e._canInitEmulator=!1;const r={...Wr,...t};try{const t=new ts(e),s=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const i=await s.json();if("needConfirmation"in i)throw ns(e,"account-exists-with-different-credential",i);if(s.ok&&!("errorMessage"in i))return i;{const t=s.ok?i.errorMessage:i.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw ns(e,"credential-already-in-use",i);if("EMAIL_EXISTS"===n)throw ns(e,"email-already-in-use",i);if("USER_DISABLED"===n)throw ns(e,"user-disabled",i);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw Lr(e,a,o);Dr(e,a)}}catch(We){if(We instanceof Bt)throw We;Dr(e,"network-request-failed",{message:String(We)})}}async function Jr(e,t,n,r,s={}){const i=await Yr(e,t,n,r,s);return"mfaPendingCredential"in i&&Dr(e,"multi-factor-auth-required",{_serverResponse:i}),i}async function Zr(e,t,n,r){const s=`${t}${n}?${r}`,i=e,o=i.config.emulator?qr(e.config,s):`${e.config.apiScheme}://${s}`;if(Gr.includes(n)&&(await i._persistenceManagerAvailable,"COOKIE"===i._getPersistenceType())){return i._getPersistence()._getFinalTarget(o).toString()}return o}function es(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class ts{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(Or(this.auth,"network-request-failed")),Kr.get())})}}function ns(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Or(e,t,r);return s.customData._tokenResponse=n,s}function rs(e){return void 0!==e&&void 0!==e.enterprise}class ss{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return es(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function is(e,t){return Yr(e,"POST","/v1/accounts:lookup",t)}function os(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(We){}}function as(e){return 1e3*Number(e)}function cs(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return Rr("JWT malformed, contained fewer than 3 sections"),null;try{const e=Ct(n);return e?JSON.parse(e):(Rr("Failed to decode base64 JWT payload"),null)}catch(We){return Rr("Caught error parsing JWT payload as JSON",We?.toString()),null}}function ls(e){const t=cs(e);return Mr(t,"internal-error"),Mr(void 0!==t.exp,"internal-error"),Mr(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function us(e,t,n=!1){if(n)return t;try{return await t}catch(We){throw We instanceof Bt&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(We)&&e.auth.currentUser===e&&await e.auth.signOut(),We}}class hs{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(We){return void("auth/network-request-failed"===We?.code&&this.schedule(!0))}this.schedule()}}class ds{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=os(this.lastLoginAt),this.creationTime=os(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function fs(e){const t=e.auth,n=await e.getIdToken(),r=await us(e,is(t,{idToken:n}));Mr(r?.users.length,t,"internal-error");const s=r.users[0];e._notifyReloadListener(s);const i=s.providerUserInfo?.length?ps(s.providerUserInfo):[],o=(a=e.providerData,c=i,[...a.filter(e=>!c.some(t=>t.providerId===e.providerId)),...c]);var a,c;const l=e.isAnonymous,u=!(e.email&&s.passwordHash||o?.length),h=!!l&&u,d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:o,metadata:new ds(s.createdAt,s.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function ps(e){return e.map(({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null}))}class ms{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Mr(e.idToken,"internal-error"),Mr(void 0!==e.idToken,"internal-error"),Mr(void 0!==e.refreshToken,"internal-error");const t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):ls(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Mr(0!==e.length,"internal-error");const t=ls(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(Mr(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await Xr(e,{},async()=>{const n=Wt({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,i=await Zr(e,r,"/v1/token",`key=${s}`),o=await e._getAdditionalHeaders();o["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:o,body:n};return e.emulatorConfig&&Lt(e.emulatorConfig.host)&&(a.credentials="include"),Hr.fetch()(i,a)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:s}=t,i=new ms;return n&&(Mr("string"==typeof n,"internal-error",{appName:e}),i.refreshToken=n),r&&(Mr("string"==typeof r,"internal-error",{appName:e}),i.accessToken=r),s&&(Mr("number"==typeof s,"internal-error",{appName:e}),i.expirationTime=s),i}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ms,this.toJSON())}_performRefresh(){return Vr("not implemented")}}function gs(e,t){Mr("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ys{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new hs(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new ds(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await us(this,this.stsTokenManager.getToken(this.auth,e));return Mr(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=Xt(e),r=await n.getIdToken(t),s=cs(r);Mr(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i="object"==typeof s.firebase?s.firebase:void 0,o=i?.sign_in_provider;return{claims:s,token:r,authTime:os(as(s.auth_time)),issuedAtTime:os(as(s.iat)),expirationTime:os(as(s.exp)),signInProvider:o||null,signInSecondFactor:i?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=Xt(e);await fs(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Mr(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>({...e})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ys({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){Mr(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await fs(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ur(this.auth.app))return Promise.reject(Pr(this.auth));const e=await this.getIdToken();return await us(this,async function(e,t){return Yr(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,s=t.phoneNumber??void 0,i=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,c=t.createdAt??void 0,l=t.lastLoginAt??void 0,{uid:u,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;Mr(u&&p,e,"internal-error");const m=ms.fromJSON(this.name,p);Mr("string"==typeof u,e,"internal-error"),gs(n,e.name),gs(r,e.name),Mr("boolean"==typeof h,e,"internal-error"),Mr("boolean"==typeof d,e,"internal-error"),gs(s,e.name),gs(i,e.name),gs(o,e.name),gs(a,e.name),gs(c,e.name),gs(l,e.name);const g=new ys({uid:u,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:i,phoneNumber:s,tenantId:o,stsTokenManager:m,createdAt:c,lastLoginAt:l});return f&&Array.isArray(f)&&(g.providerData=f.map(e=>({...e}))),a&&(g._redirectEventId=a),g}static async _fromIdTokenResponse(e,t,n=!1){const r=new ms;r.updateFromServerResponse(t);const s=new ys({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await fs(s),s}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Mr(void 0!==r.localId,"internal-error");const s=void 0!==r.providerUserInfo?ps(r.providerUserInfo):[],i=!(r.email&&r.passwordHash||s?.length),o=new ms;o.updateFromIdToken(n);const a=new ys({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:i}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:s,metadata:new ds(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash||s?.length)};return Object.assign(a,c),a}}const vs=new Map;function ws(e){Ur(e instanceof Function,"Expected a class definition");let t=vs.get(e);return t?(Ur(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,vs.set(e,t),t)}class bs{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}bs.type="NONE";const _s=bs;function Es(e,t,n){return`firebase:${e}:${t}:${n}`}class Ts{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:s}=this.auth;this.fullUserKey=Es(this.userKey,r.apiKey,s),this.fullPersistenceKey=Es("persistence",r.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"==typeof e){const t=await is(this.auth,{idToken:e}).catch(()=>{});return t?ys._fromGetAccountInfoResponse(this.auth,t,e):null}return ys._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Ts(ws(_s),e,n);const r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e);let s=r[0]||ws(_s);const i=Es(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(i);if(t){let n;if("string"==typeof t){const r=await is(e,{idToken:t}).catch(()=>{});if(!r)break;n=await ys._fromGetAccountInfoResponse(e,r,t)}else n=ys._fromJSON(e,t);c!==s&&(o=n),s=c;break}}catch{}const a=r.filter(e=>e._shouldAllowMigration);return s._shouldAllowMigration&&a.length?(s=a[0],o&&await s._set(i,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==s)try{await e._remove(i)}catch{}})),new Ts(s,e,n)):new Ts(s,e,n)}}function xs(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(ks(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(Is(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(Ns(t))return"Blackberry";if(Rs(t))return"Webos";if(Ss(t))return"Safari";if((t.includes("chrome/")||Cs(t))&&!t.includes("edge/"))return"Chrome";if(As(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function Is(e=Ut()){return/firefox\//i.test(e)}function Ss(e=Ut()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function Cs(e=Ut()){return/crios\//i.test(e)}function ks(e=Ut()){return/iemobile/i.test(e)}function As(e=Ut()){return/android/i.test(e)}function Ns(e=Ut()){return/blackberry/i.test(e)}function Rs(e=Ut()){return/webos/i.test(e)}function Ds(e=Ut()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function Os(){return function(){const e=Ut();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}()&&10===document.documentMode}function Ls(e=Ut()){return Ds(e)||As(e)||Rs(e)||Ns(e)||/windows phone/i.test(e)||ks(e)}function Ps(e,t=[]){let n;switch(e){case"Browser":n=xs(Ut());break;case"Worker":n=`${xs(Ut())}-${e}`;break;default:n=e}const r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${fr}/${r}`}class js{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise((n,r)=>{try{n(e(t))}catch(We){r(We)}});n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(We){t.reverse();for(const r of t)try{r()}catch(n){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:We?.message})}}}class Ms{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}class Vs{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Fs(this),this.idTokenSubscription=new Fs(this),this.beforeStateQueue=new js(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ar,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise(e=>this._resolvePersistenceManagerAvailable=e)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ws(t)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Ts.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(We){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await is(this,{idToken:e}),n=await ys._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(ur(this.app)){const e=this.app.settings.authIdToken;return e?new Promise(t=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(e).then(t,t))}):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,r=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,s=n?._redirectEventId,i=await this.tryRedirectSignIn(e);t&&t!==s||!i?.user||(n=i.user,r=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(r)try{await this.beforeStateQueue.runMiddleware(n)}catch(We){n=t,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(We))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return Mr(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(We){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await fs(e)}catch(We){if("auth/network-request-failed"!==We?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ur(this.app))return Promise.reject(Pr(this));const t=e?Xt(e):null;return t&&Mr(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&Mr(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ur(this.app)?Promise.reject(Pr(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ur(this.app)?Promise.reject(Pr(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ws(e))})}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return Yr(e,"GET","/v2/passwordPolicy",Qr(e,t))}(this),t=new Ms(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new zt("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Yr(e,"POST","/v2/accounts:revokeToken",Qr(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ws(e)||this._popupRedirectResolver;Mr(t,this,"argument-error"),this.redirectPersistenceManager=await Ts.create(this,[ws(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const s="function"==typeof t?t:t.next.bind(t);let i=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Mr(o,this,"internal-error"),o.then(()=>{i||s(this.currentUser)}),"function"==typeof t){const s=e.addObserver(t,n,r);return()=>{i=!0,s()}}{const n=e.addObserver(t);return()=>{i=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Mr(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ps(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if(ur(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e,...t){Nr.logLevel<=nn.WARN&&Nr.warn(`Auth (${fr}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function Us(e){return Xt(e)}class Fs{constructor(e){this.auth=e,this.observer=null,this.addObserver=function(e,t){const n=new Qt(e,t);return n.subscribe.bind(n)}(e=>this.observer=e)}get next(){return Mr(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Bs={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function zs(e){return Bs.loadJS(e)}class $s{constructor(){this.enterprise=new qs}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class qs{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Hs="NO_RECAPTCHA";class Ws{constructor(e){this.type="recaptcha-enterprise",this.auth=Us(e)}async verify(e="verify",t=!1){async function n(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{(async function(e,t){return Yr(e,"GET","/v2/recaptchaConfig",Qr(e,t))})(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0!==r.recaptchaKey){const n=new ss(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))}).catch(e=>{n(e)})})}function r(t,n,r){const s=window.grecaptcha;rs(s)?s.enterprise.ready(()=>{s.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n(Hs)})}):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new $s).execute("siteKey",{action:"verify"})}return new Promise((e,s)=>{n(this.auth).then(n=>{if(!t&&rs(window.grecaptcha))r(n,e,s);else{if("undefined"==typeof window)return void s(new Error("RecaptchaVerifier is only supported in browser"));let t=Bs.recaptchaEnterpriseScript;0!==t.length&&(t+=n),zs(t).then(()=>{r(n,e,s)}).catch(e=>{s(e)})}}).catch(e=>{s(e)})})}}async function Gs(e,t,n,r=!1,s=!1){const i=new Ws(e);let o;if(s)o=Hs;else try{o=await i.verify(n)}catch(c){o=await i.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Ks(e,t,n,r,s){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const s=await Gs(e,t,n,"getOobCode"===n);return r(e,s)}return r(e,t).catch(async s=>{if("auth/missing-recaptcha-token"===s.code){const s=await Gs(e,t,n,"getOobCode"===n);return r(e,s)}return Promise.reject(s)})}function Qs(e,t,n){const r=Us(e);Mr(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=Ys(t),{host:i,port:o}=function(e){const t=Ys(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const e=s[1];return{host:e,port:Xs(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Xs(t)}}}(t),a=null===o?"":`:${o}`,c={url:`${s}//${i}${a}/`},l=Object.freeze({host:i,port:o,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:!1})});if(!r._canInitEmulator)return Mr(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void Mr(qt(c,r.config.emulator)&&qt(l,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=c,r.emulatorConfig=l,r.settings.appVerificationDisabledForTesting=!0,Lt(i)?(Pt(`${s}//${i}${a}`),Vt("Auth",!0)):function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&console.info;"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Ys(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Xs(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Js{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Vr("not implemented")}_getIdTokenResponse(e){return Vr("not implemented")}_linkToIdToken(e,t){return Vr("not implemented")}_getReauthenticationResolver(e){return Vr("not implemented")}}async function Zs(e,t){return Yr(e,"POST","/v1/accounts:signUp",t)}async function ei(e,t){return Jr(e,"POST","/v1/accounts:signInWithPassword",Qr(e,t))}async function ti(e,t){return async function(e,t){return Yr(e,"POST","/v1/accounts:sendOobCode",Qr(e,t))}(e,t)}class ni extends Js{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new ni(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new ni(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Ks(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",ei);case"emailLink":return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithEmailLink",Qr(e,t))}(e,{email:this._email,oobCode:this._password});default:Dr(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Ks(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Zs);case"emailLink":return async function(e,t){return Jr(e,"POST","/v1/accounts:signInWithEmailLink",Qr(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:Dr(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function ri(e,t){return Jr(e,"POST","/v1/accounts:signInWithIdp",Qr(e,t))}class si extends Js{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Dr("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...s}=t;if(!n||!r)return null;const i=new si(n,r);return i.idToken=s.idToken||void 0,i.accessToken=s.accessToken||void 0,i.secret=s.secret,i.nonce=s.nonce,i.pendingToken=s.pendingToken||null,i}_getIdTokenResponse(e){return ri(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,ri(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ri(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Wt(t)}return e}}class ii{constructor(e){const t=Gt(Kt(e)),n=t.apiKey??null,r=t.oobCode??null,s=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);Mr(n&&r&&s,"argument-error"),this.apiKey=n,this.operation=s,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=Gt(Kt(e)).link,n=t?Gt(Kt(t)).deep_link_id:null,r=Gt(Kt(e)).deep_link_id;return(r?Gt(Kt(r)).link:null)||r||n||t||e}(e);try{return new ii(t)}catch{return null}}}class oi{constructor(){this.providerId=oi.PROVIDER_ID}static credential(e,t){return ni._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=ii.parseLink(t);return Mr(n,"argument-error"),ni._fromEmailAndCode(e,n.code,n.tenantId)}}oi.PROVIDER_ID="password",oi.EMAIL_PASSWORD_SIGN_IN_METHOD="password",oi.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class ai{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class ci extends ai{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class li extends ci{constructor(){super("facebook.com")}static credential(e){return si._fromParams({providerId:li.PROVIDER_ID,signInMethod:li.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return li.credentialFromTaggedObject(e)}static credentialFromError(e){return li.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return li.credential(e.oauthAccessToken)}catch{return null}}}li.FACEBOOK_SIGN_IN_METHOD="facebook.com",li.PROVIDER_ID="facebook.com";class ui extends ci{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return si._fromParams({providerId:ui.PROVIDER_ID,signInMethod:ui.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ui.credentialFromTaggedObject(e)}static credentialFromError(e){return ui.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ui.credential(t,n)}catch{return null}}}ui.GOOGLE_SIGN_IN_METHOD="google.com",ui.PROVIDER_ID="google.com";class hi extends ci{constructor(){super("github.com")}static credential(e){return si._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.GITHUB_SIGN_IN_METHOD="github.com",hi.PROVIDER_ID="github.com";class di extends ci{constructor(){super("twitter.com")}static credential(e,t){return si._fromParams({providerId:di.PROVIDER_ID,signInMethod:di.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return di.credentialFromTaggedObject(e)}static credentialFromError(e){return di.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return di.credential(t,n)}catch{return null}}}di.TWITTER_SIGN_IN_METHOD="twitter.com",di.PROVIDER_ID="twitter.com";class fi{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const s=await ys._fromIdTokenResponse(e,n,r),i=pi(n);return new fi({user:s,providerId:i,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=pi(n);return new fi({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function pi(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class mi extends Bt{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,mi.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new mi(e,t,n,r)}}function gi(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw mi._fromErrorAndOperation(e,n,t,r);throw n})}async function yi(e,t,n=!1){if(ur(e.app))return Promise.reject(Pr(e));const r="signIn",s=await gi(e,r,t),i=await fi._fromIdTokenResponse(e,r,s);return n||await e._updateCurrentUser(i.user),i}async function vi(e,t,n){const r=Us(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};await Ks(r,s,"getOobCode",ti)}function wi(e,t,n){return ur(e.app)?Promise.reject(Pr(e)):async function(e,t){return yi(Us(e),t)}(Xt(e),oi.credential(t,n)).catch(async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&async function(e){const t=Us(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}(e),t})}const bi="__sak";class _i{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(bi,"1"),this.storage.removeItem(bi),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Ei extends _i{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ls(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);Os()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Ei.type="LOCAL";const Ti=Ei;class xi extends _i{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}xi.type="SESSION";const Ii=xi;class Si{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;const n=new Si(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:s}=t.data,i=this.handlersMap[r];if(!i?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(i).map(async e=>e(t.origin,s)),a=await function(e){return Promise.all(e.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Ci(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Si.receivers=[];class ki{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let s,i;return new Promise((o,a)=>{const c=Ci("",20);r.port1.start();const l=setTimeout(()=>{a(new Error("unsupported_event"))},n);i={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(l),s=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),o(t.data.response);break;default:clearTimeout(l),clearTimeout(s),a(new Error("invalid_response"))}}},this.handlers.add(i),r.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}function Ai(){return window}function Ni(){return void 0!==Ai().WorkerGlobalScope&&"function"==typeof Ai().importScripts}const Ri="firebaseLocalStorageDb",Di="firebaseLocalStorage",Oi="fbase_key";class Li{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Pi(e,t){return e.transaction([Di],t?"readwrite":"readonly").objectStore(Di)}function ji(){const e=indexedDB.open(Ri,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{const t=e.result;try{t.createObjectStore(Di,{keyPath:Oi})}catch(We){n(We)}}),e.addEventListener("success",async()=>{const n=e.result;n.objectStoreNames.contains(Di)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(Ri);return new Li(e).toPromise()}(),t(await ji()))})})}async function Mi(e,t,n){const r=Pi(e,!0).put({[Oi]:t,value:n});return new Li(r).toPromise()}function Vi(e,t){const n=Pi(e,!0).delete(t);return new Li(n).toPromise()}class Ui{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await ji()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(We){if(t++>3)throw We;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Ni()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Si._getInstance(Ni()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new ki(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ji();return await Mi(e,bi,"1"),await Vi(e,bi),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>Mi(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(t=>async function(e,t){const n=Pi(e,!1).get(t),r=await new Li(n).toPromise();return void 0===r?null:r.value}(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>Vi(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(e=>{const t=Pi(e,!1).getAll();return new Li(t).toPromise()});if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:s}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(s)&&(this.notifyListeners(r,s),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Ui.type="LOCAL";const Fi=Ui;new $r(3e4,6e4);class Bi extends Js{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ri(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ri(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ri(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function zi(e){return yi(e.auth,new Bi(e),e.bypassAuthState)}function $i(e){const{auth:t,user:n}=e;return Mr(n,t,"internal-error"),async function(e,t,n=!1){const{auth:r}=e;if(ur(r.app))return Promise.reject(Pr(r));const s="reauthenticate";try{const i=await us(e,gi(r,s,t,e),n);Mr(i.idToken,r,"internal-error");const o=cs(i.idToken);Mr(o,r,"internal-error");const{sub:a}=o;return Mr(e.uid===a,r,"user-mismatch"),fi._forOperation(e,s,i)}catch(We){throw"auth/user-not-found"===We?.code&&Dr(r,"user-mismatch"),We}}(n,new Bi(e),e.bypassAuthState)}async function qi(e){const{auth:t,user:n}=e;return Mr(n,t,"internal-error"),async function(e,t,n=!1){const r=await us(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return fi._forOperation(e,"link",r)}(n,new Bi(e),e.bypassAuthState)}class Hi{constructor(e,t,n,r,s=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(We){this.reject(We)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:s,error:i,type:o}=e;if(i)return void this.reject(i);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(We){this.reject(We)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zi;case"linkViaPopup":case"linkViaRedirect":return qi;case"reauthViaPopup":case"reauthViaRedirect":return $i;default:Dr(this.auth,"internal-error")}}resolve(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Wi=new $r(2e3,1e4);class Gi extends Hi{constructor(e,t,n,r,s){super(e,t,r,s),this.provider=n,this.authWindow=null,this.pollId=null,Gi.currentPopupAction&&Gi.currentPopupAction.cancel(),Gi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Mr(e,this.auth,"internal-error"),e}async onExecution(){Ur(1===this.filter.length,"Popup operations only handle one event");const e=Ci();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(Or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Gi.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Or(this.auth,"popup-closed-by-user"))},8e3):this.pollId=window.setTimeout(e,Wi.get())};e()}}Gi.currentPopupAction=null;const Ki="pendingRedirect",Qi=new Map;class Yi extends Hi{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Qi.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=function(e){return Es(Ki,e.config.apiKey,e.name)}(t),r=function(e){return ws(e._redirectPersistence)}(e);if(!(await r._isAvailable()))return!1;const s="true"===await r._get(n);return await r._remove(n),s}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(We){e=()=>Promise.reject(We)}Qi.set(this.auth._key(),e)}return this.bypassAuthState||Qi.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function Xi(e,t){Qi.set(e._key(),t)}async function Ji(e,t,n=!1){if(ur(e.app))return Promise.reject(Pr(e));const r=Us(e),s=function(e,t){return t?ws(t):(Mr(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}(r,t),i=new Yi(r,s,n),o=await i.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}class Zi{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return to(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!to(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(Or(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(eo(e))}saveEventToCache(e){this.cachedEventUids.add(eo(e)),this.lastProcessedEventTime=Date.now()}}function eo(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function to({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}const no=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ro=/^https?/;async function so(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return Yr(e,"GET","/v1/projects",t)}(e);for(const n of t)try{if(io(n))return}catch{}Dr(e,"unauthorized-domain")}function io(e){const t=Fr(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const s=new URL(e);return""===s.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&s.hostname===r}if(!ro.test(n))return!1;if(no.test(e))return r===e;const s=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}const oo=new $r(3e4,6e4);function ao(){const e=Ai().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function co(e){return new Promise((t,n)=>{function r(){ao(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{ao(),n(Or(e,"network-request-failed"))},timeout:oo.get()})}if(Ai().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!Ai().gapi?.load){const t=`__${"iframefcb"}${Math.floor(1e6*Math.random())}`;return Ai()[t]=()=>{gapi.load?r():n(Or(e,"network-request-failed"))},zs(`${Bs.gapiScript}?onload=${t}`).catch(e=>n(e))}r()}}).catch(e=>{throw lo=null,e})}let lo=null;const uo=new $r(5e3,15e3),ho={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fo=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function po(e){const t=e.config;Mr(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?qr(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:fr},s=fo.get(e.config.apiHost);s&&(r.eid=s);const i=e._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Wt(r).slice(1)}`}async function mo(e){const t=await function(e){return lo=lo||co(e),lo}(e),n=Ai().gapi;return Mr(n,e,"internal-error"),t.open({where:document.body,url:po(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:ho,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});const s=Or(e,"network-request-failed"),i=Ai().setTimeout(()=>{r(s)},uo.get());function o(){Ai().clearTimeout(i),n(t)}t.ping(o).then(o,()=>{r(s)})}))}const go={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class yo{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(We){}}}function vo(e,t,n,r=500,s=600){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const c={...go,width:r.toString(),height:s.toString(),top:i,left:o},l=Ut().toLowerCase();n&&(a=Cs(l)?"_blank":n),Is(l)&&(t=t||"http://localhost",c.scrollbars="yes");const u=Object.entries(c).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=Ut()){return Ds(e)&&!!window.navigator?.standalone}(l)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new yo(null);const h=window.open(t||"",a,u);Mr(h,e,"popup-blocked");try{h.focus()}catch(We){}return new yo(h)}const wo="__/auth/handler",bo="emulator/auth/handler",_o=encodeURIComponent("fac");async function Eo(e,t,n,r,s,i){Mr(e.config.authDomain,e,"auth-domain-config-required"),Mr(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:fr,eventId:s};if(t instanceof ai){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries({}))o[e]=t}if(t instanceof ci){const e=t.getScopes().filter(e=>""!==e);e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const u of Object.keys(a))void 0===a[u]&&delete a[u];const c=await e._getAppCheckToken(),l=c?`#${_o}=${encodeURIComponent(c)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${wo}`;return qr(e,bo)}(e)}?${Wt(a).slice(1)}${l}`}const To="webStorageSupport";const xo=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ii,this._completeRedirectFn=Ji,this._overrideRedirectResult=Xi}async _openPopup(e,t,n,r){Ur(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");return vo(e,await Eo(e,t,n,Fr(),r),Ci())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Ai().location.href=e}(await Eo(e,t,n,Fr(),r)),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(Ur(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await mo(e),n=new Zi(e);return t.register("authEvent",t=>{Mr(t?.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(To,{type:To},n=>{const r=n?.[0]?.[To];void 0!==r&&t(!!r),Dr(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=so(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Ls()||Ss()||Ds()}};var Io="@firebase/auth",So="1.11.1";class Co{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(t=>{e(t?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Mr(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const ko=Dt("authIdTokenMaxAge")||300;let Ao=null;var No,Ro;No={loadJS:e=>new Promise((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=Or("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)}),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Bs=No,Ro="Browser",cr(new Jt("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:i,authDomain:o}=n.options;Mr(i&&!i.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:i,authDomain:o,clientPlatform:Ro,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ps(Ro)},c=new Vs(n,r,s,a);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(ws);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,t),c},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),cr(new Jt("auth-internal",e=>{const t=Us(e.getProvider("auth").getImmediate());return new Co(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),gr(Io,So,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Ro)),gr(Io,So,"esm2020");gr("firebase","12.5.0","app");var Do,Oo,Lo="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"==typeof t)for(var s=0;s<16;++s)r[s]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(s=0;s<16;++s)r[s]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],s=e.g[2];let i,o=e.g[3];i=t+(o^n&(s^o))+r[0]+3614090360&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[1]+3905402710&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[2]+606105819&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[3]+3250441966&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[4]+4118548399&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[5]+1200080426&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[6]+2821735955&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[7]+4249261313&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[8]+1770035416&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[9]+2336552879&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[10]+4294925233&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[11]+2304563134&4294967295,i=t+(o^(n=s+(i<<22&4294967295|i>>>10))&(s^o))+r[12]+1804603682&4294967295,i=o+(s^(t=n+(i<<7&4294967295|i>>>25))&(n^s))+r[13]+4254626195&4294967295,o=t+(i<<12&4294967295|i>>>20),i=s+(n^o&(t^n))+r[14]+2792965006&4294967295,i=n+(t^(s=o+(i<<17&4294967295|i>>>15))&(o^t))+r[15]+1236535329&4294967295,i=t+(s^o&((n=s+(i<<22&4294967295|i>>>10))^s))+r[1]+4129170786&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[6]+3225465664&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[11]+643717713&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[0]+3921069994&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[5]+3593408605&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[10]+38016083&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[15]+3634488961&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[4]+3889429448&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[9]+568446438&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[14]+3275163606&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[3]+4107603335&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[8]+1163531501&4294967295,i=t+(s^o&((n=s+(i<<20&4294967295|i>>>12))^s))+r[13]+2850285829&4294967295,i=o+(n^s&((t=n+(i<<5&4294967295|i>>>27))^n))+r[2]+4243563512&4294967295,o=t+(i<<9&4294967295|i>>>23),i=s+(t^n&(o^t))+r[7]+1735328473&4294967295,i=n+(o^t&((s=o+(i<<14&4294967295|i>>>18))^o))+r[12]+2368359562&4294967295,i=t+((n=s+(i<<20&4294967295|i>>>12))^s^o)+r[5]+4294588738&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[8]+2272392833&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[11]+1839030562&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[14]+4259657740&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[1]+2763975236&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[4]+1272893353&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[7]+4139469664&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[10]+3200236656&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[13]+681279174&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[0]+3936430074&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[3]+3572445317&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[6]+76029189&4294967295,i=t+((n=s+(i<<23&4294967295|i>>>9))^s^o)+r[9]+3654602809&4294967295,i=o+((t=n+(i<<4&4294967295|i>>>28))^n^s)+r[12]+3873151461&4294967295,o=t+(i<<11&4294967295|i>>>21),i=s+(o^t^n)+r[15]+530742520&4294967295,i=n+((s=o+(i<<16&4294967295|i>>>16))^o^t)+r[2]+3299628645&4294967295,i=t+(s^((n=s+(i<<23&4294967295|i>>>9))|~o))+r[0]+4096336452&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[7]+1126891415&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[14]+2878612391&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[5]+4237533241&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[12]+1700485571&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[3]+2399980690&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[10]+4293915773&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[1]+2240044497&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[8]+1873313359&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[15]+4264355552&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[6]+2734768916&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[13]+1309151649&4294967295,i=t+(s^((n=s+(i<<21&4294967295|i>>>11))|~o))+r[4]+4149444226&4294967295,i=o+(n^((t=n+(i<<6&4294967295|i>>>26))|~s))+r[11]+3174756917&4294967295,o=t+(i<<10&4294967295|i>>>22),i=s+(t^(o|~n))+r[2]+718787259&4294967295,i=n+(o^((s=o+(i<<15&4294967295|i>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(s+(i<<21&4294967295|i>>>11))&4294967295,e.g[2]=e.g[2]+s&4294967295,e.g[3]=e.g[3]+o&4294967295}function r(e,t){this.h=t;const n=[];let r=!0;for(let s=e.length-1;s>=0;s--){const i=0|e[s];r&&i==t||(n[s]=i,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}(t,function(){this.blockSize=-1}),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,s=this.C;let i=this.h,o=0;for(;o<t;){if(0==i)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"==typeof e){for(;o<t;)if(s[i++]=e.charCodeAt(o++),i==this.blockSize){n(this,s),i=0;break}}else for(;o<t;)if(s[i++]=e[o++],i==this.blockSize){n(this,s),i=0;break}}this.h=i,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var s={};function i(e){return-128<=e&&e<128?function(e,t){var n=s;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,function(e){return new r([0|e],e<0?-1:0)}):new r([0|e],e<0?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(e<0)return d(o(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new r(t,0)}var a=i(0),c=i(1),l=i(16777216);function u(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new r(n,~e.h).add(c)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(u(t))throw Error("division by zero");if(u(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(e.g.length>30){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=c,r=t;r.l(e)<=0;)n=y(n),r=y(r);var s=v(n,1),i=v(r,1);for(r=v(r,2),n=v(n,2);!u(r);){var l=i.add(r);l.l(e)<=0&&(s=s.add(n),i=l),r=v(r,1),n=v(n,1)}return t=f(e,s.j(t)),new m(s,t)}for(s=a;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),l=(i=o(n)).j(t);h(l)||l.l(e)>0;)l=(i=o(n-=r)).j(t);u(i)&&(i=c),s=s.add(i),e=f(e,l)}return new m(s,e)}function y(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new r(n,e.h)}function v(e,t){const n=t>>5;t%=32;const s=e.g.length-n,i=[];for(let r=0;r<s;r++)i[r]=t>0?e.i(r+n)>>>t|e.i(r+n+1)<<32-t:e.i(r+n);return new r(i,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(u(this))return"0";if(h(this))return"-"+d(this).toString(e);const t=o(Math.pow(e,6));var n=this;let r="";for(;;){const s=g(n,t).g;let i=(((n=f(n,s.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(u(n=s))return i+r;for(;i.length<6;)i="0"+i;r=i+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:u(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let s=0;for(let r=0;r<=t;r++){let t=s+(65535&this.i(r))+(65535&e.i(r)),i=(t>>>16)+(this.i(r)>>>16)+(e.i(r)>>>16);s=i>>>16,t&=65535,i&=65535,n[r]=i<<16|t}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(u(this)||u(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(this.l(l)<0&&e.l(l)<0)return o(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var s=0;s<2*t;s++)n[s]=0;for(s=0;s<this.g.length;s++)for(let t=0;t<e.g.length;t++){const r=this.i(s)>>>16,i=65535&this.i(s),o=e.i(t)>>>16,a=65535&e.i(t);n[2*s+2*t]+=i*a,p(n,2*s+2*t),n[2*s+2*t+1]+=r*a,p(n,2*s+2*t+1),n[2*s+2*t+1]+=i*o,p(n,2*s+2*t+1),n[2*s+2*t+2]+=r*o,p(n,2*s+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new r(n,0)},e.B=function(e){return g(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new r(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new r(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,Oo=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.B,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=o(Math.pow(n,8));let s=a;for(let a=0;a<t.length;a+=8){var i=Math.min(8,t.length-a);const e=parseInt(t.substring(a,a+i),n);i<8?(i=o(Math.pow(n,i)),s=s.j(i).add(o(e))):(s=s.j(r),s=s.add(o(e)))}return s},Do=r}).apply(void 0!==Lo?Lo:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});var Po,jo,Mo,Vo,Uo,Fo,Bo,zo,$o="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof $o&&$o];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var s=n;e=e.split(".");for(var i=0;i<e.length-1;i++){var o=e[i];if(!(o in s))break e;s=s[o]}(r=r(i=s[e=e[e.length-1]]))!=i&&null!=r&&t(s,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",function(e){return e||Symbol("Symbol.dispose")}),r("Array.prototype.values",function(e){return e||function(){return this[Symbol.iterator]()}}),r("Object.entries",function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}});var s=s||{},i=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){return(c=a).apply(null,arguments)}function l(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function u(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var s=Array(arguments.length-2),i=2;i<arguments.length;i++)s[i-2]=arguments[i];return t.prototype[n].apply(e,s)}}var h="undefined"!=typeof AsyncContext&&"function"==typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function d(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let s=0;s<r;s++)e[n+s]=t[s]}else e.push(t)}}function p(e){i.setTimeout(()=>{throw e},0)}function m(){var e=b;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var g=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new y,e=>e.reset());class y{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let v,w=!1,b=new class{constructor(){this.h=this.g=null}add(e,t){const n=g.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},_=()=>{const e=Promise.resolve(void 0);v=()=>{e.then(E)}};function E(){for(var e;e=m();){try{e.h.call(e.g)}catch(n){p(n)}var t=g;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}w=!1}function T(){this.u=this.u,this.C=this.C}function x(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}T.prototype.u=!1,T.prototype.dispose=function(){this.u||(this.u=!0,this.N())},T.prototype[Symbol.dispose]=function(){this.dispose()},T.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},x.prototype.h=function(){this.defaultPrevented=!0};var I=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function S(e){return/^[\s\xa0]*$/.test(e)}function C(e,t){x.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}u(C,x),C.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&C.Z.h.call(this)},C.prototype.h=function(){C.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var k="closure_listenable_"+(1e6*Math.random()|0),A=0;function N(e,t,n,r,s){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=s,this.key=++A,this.da=this.fa=!1}function R(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function D(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function O(e){const t={};for(const n in e)t[n]=e[n];return t}const L="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(e,t){let n,r;for(let s=1;s<arguments.length;s++){for(n in r=arguments[s],r)e[n]=r[n];for(let t=0;t<L.length;t++)n=L[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function j(e){this.src=e,this.g={},this.h=0}function M(e,t){const n=t.type;if(n in e.g){var r,s=e.g[n],i=Array.prototype.indexOf.call(s,t,void 0);(r=i>=0)&&Array.prototype.splice.call(s,i,1),r&&(R(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function V(e,t,n,r){for(let s=0;s<e.length;++s){const i=e[s];if(!i.da&&i.listener==t&&i.capture==!!n&&i.ha==r)return s}return-1}j.prototype.add=function(e,t,n,r,s){const i=e.toString();(e=this.g[i])||(e=this.g[i]=[],this.h++);const o=V(e,t,r,s);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new N(t,this.src,i,!!r,s)).fa=n,e.push(t)),t};var U="closure_lm_"+(1e6*Math.random()|0),F={};function B(e,t,n,r,s){if(Array.isArray(t)){for(let i=0;i<t.length;i++)B(e,t[i],n,r,s);return null}return n=K(n),e&&e[k]?e.J(t,n,!!o(r)&&!!r.capture,s):function(e,t,n,r,s,i){if(!t)throw Error("Invalid event type");const a=o(s)?!!s.capture:!!s;let c=W(e);if(c||(e[U]=c=new j(e)),n=c.add(t,n,r,a,i),n.proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=H;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)I||(s=a),void 0===s&&(s=!1),e.addEventListener(t.toString(),r,s);else if(e.attachEvent)e.attachEvent(q(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}(e,t,n,!1,r,s)}function z(e,t,n,r,s){if(Array.isArray(t))for(var i=0;i<t.length;i++)z(e,t[i],n,r,s);else r=o(r)?!!r.capture:!!r,n=K(n),e&&e[k]?(e=e.i,(i=String(t).toString())in e.g&&((n=V(t=e.g[i],n,r,s))>-1&&(R(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[i],e.h--)))):e&&(e=W(e))&&(t=e.g[t.toString()],e=-1,t&&(e=V(t,n,r,s)),(n=e>-1?t[e]:null)&&$(n))}function $(e){if("number"!=typeof e&&e&&!e.da){var t=e.src;if(t&&t[k])M(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(q(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=W(t))?(M(n,e),0==n.h&&(n.src=null,t[U]=null)):R(e)}}}function q(e){return e in F?F[e]:F[e]="on"+e}function H(e,t){if(e.da)e=!0;else{t=new C(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&$(e),e=n.call(r,t)}return e}function W(e){return(e=e[U])instanceof j?e:null}var G="__closure_events_fn_"+(1e9*Math.random()>>>0);function K(e){return"function"==typeof e?e:(e[G]||(e[G]=function(t){return e.handleEvent(t)}),e[G])}function Q(){T.call(this),this.i=new j(this),this.M=this,this.G=null}function Y(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"==typeof t)t=new x(t,e);else if(t instanceof x)t.target=t.target||e;else{var s=t;P(t=new x(r,e),s)}let i,o;if(s=!0,n)for(o=n.length-1;o>=0;o--)i=t.g=n[o],s=X(i,r,!0,t)&&s;if(i=t.g=e,s=X(i,r,!0,t)&&s,s=X(i,r,!1,t)&&s,n)for(o=0;o<n.length;o++)i=t.g=n[o],s=X(i,r,!1,t)&&s}function X(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let s=!0;for(let i=0;i<t.length;++i){const o=t[i];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&M(e.i,o),s=!1!==t.call(n,r)&&s}}return s&&!r.defaultPrevented}function J(e){e.g=function(e,t){if("function"!=typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return Number(t)>2147483647?-1:i.setTimeout(e,t||0)}(()=>{e.g=null,e.i&&(e.i=!1,J(e))},e.l);const t=e.h;e.h=null,e.m.apply(null,t)}u(Q,T),Q.prototype[k]=!0,Q.prototype.removeEventListener=function(e,t,n,r){z(this,e,t,n,r)},Q.prototype.N=function(){if(Q.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)R(n[e]);delete e.g[t],e.h--}}this.G=null},Q.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},Q.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class Z extends T{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:J(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ee(e){T.call(this),this.h=e,this.g={}}u(ee,T);var te=[];function ne(e){D(e.g,function(e,t){this.g.hasOwnProperty(t)&&$(e)},e),e.g={}}ee.prototype.N=function(){ee.Z.N.call(this),ne(this)},ee.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var re=i.JSON.stringify,se=i.JSON.parse,ie=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function oe(){}function ae(){}var ce={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function le(){x.call(this,"d")}function ue(){x.call(this,"c")}u(le,x),u(ue,x);var he={},de=null;function fe(){return de=de||new Q}function pe(e){x.call(this,he.Ia,e)}function me(e){const t=fe();Y(t,new pe(t))}function ge(e,t){x.call(this,he.STAT_EVENT,e),this.stat=t}function ye(e){const t=fe();Y(t,new ge(t,e))}function ve(e,t){x.call(this,he.Ja,e),this.size=t}function we(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout(function(){e()},t)}function be(){this.g=!0}function _e(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const i=JSON.parse(t);if(i)for(e=0;e<i.length;e++)if(Array.isArray(i[e])){var n=i[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var s=r[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(let e=1;e<r.length;e++)r[e]=""}}}return re(i)}catch(i){return t}}(e,n)+(r?" "+r:"")})}he.Ia="serverreachability",u(pe,x),he.STAT_EVENT="statevent",u(ge,x),he.Ja="timingevent",u(ve,x),be.prototype.ua=function(){this.g=!1},be.prototype.info=function(){};var Ee,Te={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},xe={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Ie(){}function Se(e){return encodeURIComponent(String(e))}function Ce(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function ke(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new ee(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new Ae}function Ae(){this.i=null,this.g="",this.h=!1}u(Ie,oe),Ie.prototype.g=function(){return new XMLHttpRequest},Ee=new Ie;var Ne={},Re={};function De(e,t,n){e.M=1,e.A=rt(Je(t)),e.u=n,e.R=!0,Oe(e,null)}function Oe(e,t){e.F=Date.now(),je(e),e.B=Je(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),yt(n.i,"t",r),e.C=0,n=e.j.L,e.h=new Ae,e.g=rn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new Z(c(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var s="readystatechange";Array.isArray(s)||(s&&(te[0]=s.toString()),s=te);for(let i=0;i<s.length;i++){const e=B(n,s[i],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?O(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),me(),function(e,t,n,r,s,i){e.info(function(){if(e.g)if(i){var o="",a=i.split("&");for(let e=0;e<a.length;e++){var c=a[e].split("=");if(c.length>1){const e=c[0];c=c[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+c+"&":o+(e+"=redacted&")}}}else o=null;else o=i;return"XMLHTTP REQ ("+r+") [attempt "+s+"]: "+t+"\n"+n+"\n"+o})}(e.i,e.v,e.B,e.l,e.S,e.u)}function Le(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Pe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Re:(n=Number(t.substring(n,r)),isNaN(n)?Ne:(r+=1)+n>t.length?Re:(t=t.slice(r,r+n),e.C=r+n,t))}function je(e){e.T=Date.now()+e.H,Me(e,e.H)}function Me(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=we(c(e.aa,e),t)}function Ve(e){e.D&&(i.clearTimeout(e.D),e.D=null)}function Ue(e){0==e.j.I||e.K||Jt(e.j,e)}function Fe(e){Ve(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ne(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function Be(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||We(n.h,e)))if(!e.L&&We(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(u){r=null}if(Array.isArray(r)&&3==r.length){var s=r;if(0==s[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;Xt(n),Bt(n)}Kt(n),ye(18)}}else n.xa=s[1],0<n.xa-n.K&&s[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=we(c(n.Va,n),6e3));He(n.h)<=1&&n.ta&&(n.ta=void 0)}else en(n,11)}else if((e.L||n.g==e)&&Xt(n),!S(t))for(s=n.Ba.g.parse(t),t=0;t<s.length;t++){let c=s[t];const u=c[0];if(!(u<=n.K))if(n.K=u,c=c[1],2==n.I)if("c"==c[0]){n.M=c[1],n.ba=c[2];const t=c[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const s=c[4];null!=s&&(n.za=s,n.j.info("SVER="+n.za));const u=c[5];null!=u&&"number"==typeof u&&u>0&&(r=1.5*u,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var i=r.h;i.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(i.j=i.l,i.g=new Set,i.h&&(Ge(i,i.h),i.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,nt(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=nn(r,r.L?r.ba:null,r.W),o.L){Ke(r.h,o);var a=o,l=r.O;l&&(a.H=l),a.D&&(Ve(a),je(a)),r.g=o}else Gt(r);n.i.length>0&&$t(n)}else"stop"!=c[0]&&"close"!=c[0]||en(n,7);else 3==n.I&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?en(n,7):Ft(n):"noop"!=c[0]&&n.l&&n.l.qa(c),n.A=0)}me()}catch(u){}}ke.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==jt(e)?t.j():this.Y(e)},ke.prototype.Y=function(e){try{if(e==this.g)e:{const c=jt(this.g),l=this.g.ya();this.g.ca();if(!(c<3)&&(3!=c||this.g&&(this.h.h||this.g.la()||Mt(this.g)))){this.K||4!=c||7==l||me(),Ve(this);var t=this.g.ca();this.X=t;var n=function(e){if(!Le(e))return e.g.la();const t=Mt(e.g);if(""===t)return"";let n="";const r=t.length,s=4==jt(e.g);if(!e.h.i){if("undefined"==typeof TextDecoder)return Fe(e),Ue(e),"";e.h.i=new i.TextDecoder}for(let i=0;i<r;i++)e.h.h=!0,n+=e.h.i.decode(t[i],{stream:!(s&&i==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,s,i,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+s+"]: "+t+"\n"+n+"\n"+i+" "+o})}(this.i,this.v,this.B,this.l,this.S,c,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,s=this.g;if((r=s.g?s.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!S(r)){var o=r;break t}}o=null}if(!(e=o)){this.o=!1,this.m=3,ye(12),Fe(this),Ue(this);break e}_e(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,Be(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Pe(this,n),t==Re){4==c&&(this.m=4,ye(14),e=!1),_e(this.i,this.l,null,"[Incomplete Response]");break}if(t==Ne){this.m=4,ye(15),_e(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}_e(this.i,this.l,t,null),Be(this,t)}if(Le(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=c||0!=n.length||this.h.h||(this.m=1,ye(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),Qt(a),a.P=!0,ye(11))}}else _e(this.i,this.l,n,"[Invalid Chunked Response]"),Fe(this),Ue(this)}else _e(this.i,this.l,n,null),Be(this,n);4==c&&Fe(this),this.o&&!this.K&&(4==c?Jt(this.j,this):(this.o=!1,je(this)))}else(function(e){const t={};e=(e.g&&jt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(S(e[r]))continue;var n=Ce(e[r]);const s=n[0];if("string"!=typeof(n=n[1]))continue;n=n.trim();const i=t[s]||[];t[s]=i,i.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,function(e){return e.join(", ")})})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,ye(12)):(this.m=0,ye(13)),Fe(this),Ue(this)}}}catch(c){}},ke.prototype.cancel=function(){this.K=!0,Fe(this)},ke.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.i,this.B),2!=this.M&&(me(),ye(17)),Fe(this),this.m=2,Ue(this)):Me(this,this.T-e)};var ze=class{constructor(e,t){this.g=e,this.map=t}};function $e(e){this.l=e||10,i.PerformanceNavigationTiming?e=(e=i.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function qe(e){return!!e.h||!!e.g&&e.g.size>=e.j}function He(e){return e.h?1:e.g?e.g.size:0}function We(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function Ge(e,t){e.g?e.g.add(t):e.h=t}function Ke(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function Qe(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return d(e.i)}$e.prototype.cancel=function(){if(this.i=Qe(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var Ye=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Xe(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof Xe?(this.l=e.l,Ze(this,e.j),this.o=e.o,this.g=e.g,et(this,e.u),this.h=e.h,tt(this,vt(e.i)),this.m=e.m):e&&(t=String(e).match(Ye))?(this.l=!1,Ze(this,t[1]||"",!0),this.o=st(t[2]||""),this.g=st(t[3]||"",!0),et(this,t[4]),this.h=st(t[5]||"",!0),tt(this,t[6]||"",!0),this.m=st(t[7]||"")):(this.l=!1,this.i=new dt(null,this.l))}function Je(e){return new Xe(e)}function Ze(e,t,n){e.j=n?st(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function et(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function tt(e,t,n){t instanceof dt?(e.i=t,function(e,t){t&&!e.j&&(ft(e),e.i=null,e.g.forEach(function(e,t){const n=t.toLowerCase();t!=n&&(pt(this,t),yt(this,n,e))},e)),e.j=t}(e.i,e.l)):(n||(t=it(t,ut)),e.i=new dt(t,e.l))}function nt(e,t,n){e.i.set(t,n)}function rt(e){return nt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function st(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function it(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,ot),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ot(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}Xe.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(it(t,at,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(it(t,at,!0),"@"),e.push(Se(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(it(n,"/"==n.charAt(0)?lt:ct,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",it(n,ht)),e.join("")},Xe.prototype.resolve=function(e){const t=Je(this);let n=!!e.j;n?Ze(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)et(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var s=t.h.lastIndexOf("/");-1!=s&&(r=t.h.slice(0,s+1)+r)}if(".."==(s=r)||"."==s)r="";else if(-1!=s.indexOf("./")||-1!=s.indexOf("/.")){r=0==s.lastIndexOf("/",0),s=s.split("/");const e=[];for(let t=0;t<s.length;){const n=s[t++];"."==n?r&&t==s.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==s.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=s}return n?t.h=r:n=""!==e.i.toString(),n?tt(t,vt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var at=/[#\/\?@]/g,ct=/[#\?:]/g,lt=/[#\?]/g,ut=/[#\?@]/g,ht=/#/g;function dt(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ft(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let s,i=null;r>=0?(s=e[n].substring(0,r),i=e[n].substring(r+1)):s=e[n],t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function pt(e,t){ft(e),t=wt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function mt(e,t){return ft(e),t=wt(e,t),e.g.has(t)}function gt(e,t){ft(e);let n=[];if("string"==typeof t)mt(e,t)&&(n=n.concat(e.g.get(wt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function yt(e,t,n){pt(e,t),n.length>0&&(e.i=null,e.g.set(wt(e,t),d(n)),e.h+=n.length)}function vt(e){const t=new dt;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function wt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function bt(e,t,n,r,s){try{s&&(s.onload=null,s.onerror=null,s.onabort=null,s.ontimeout=null),r(n)}catch(i){}}function _t(){this.g=new ie}function Et(e){this.i=e.Sb||null,this.h=e.ab||!1}function Tt(e,t){Q.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function xt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function It(e){e.readyState=4,e.l=null,e.j=null,e.B=null,St(e)}function St(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Ct(e){let t="";return D(e,function(e,n){t+=n,t+=":",t+=e,t+="\r\n"}),t}function kt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Ct(n),"string"==typeof e?null!=n&&Se(n):nt(e,t,n))}function At(e){Q.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=dt.prototype).add=function(e,t){ft(this),this.i=null,e=wt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){ft(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},e.set=function(e,t){return ft(this),this.i=null,mt(this,e=wt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=gt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const s=Se(n);n=gt(this,n);for(let t=0;t<n.length;t++){let r=s;""!==n[t]&&(r+="="+Se(n[t])),e.push(r)}}return this.i=e.join("&")},u(Et,oe),Et.prototype.g=function(){return new Tt(this.i,this.h)},u(Tt,Q),(e=Tt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,St(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||i).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,It(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,St(this)),this.g&&(this.readyState=3,St(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if(void 0!==i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;xt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?It(this):St(this),3==this.readyState&&xt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,It(this))},e.Na=function(e){this.g&&(this.response=e,It(this))},e.ga=function(){this.g&&It(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Tt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),u(At,Q);var Nt=/^https?$/i,Rt=["POST","PUT"];function Dt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Ot(e),Pt(e)}function Ot(e){e.A||(e.A=!0,Y(e,"complete"),Y(e,"error"))}function Lt(e){if(e.h&&void 0!==s)if(e.v&&4==jt(e))setTimeout(e.Ca.bind(e),0);else if(Y(e,"readystatechange"),4==jt(e)){e.h=!1;try{const s=e.ca();e:switch(s){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===s){let t=String(e.D).match(Ye)[1]||null;!t&&i.self&&i.self.location&&(t=i.self.location.protocol.slice(0,-1)),r=!Nt.test(t?t.toLowerCase():"")}n=r}if(n)Y(e,"complete"),Y(e,"success");else{e.o=6;try{var o=jt(e)>2?e.g.statusText:""}catch(a){o=""}e.l=o+" ["+e.ca()+"]",Ot(e)}}finally{Pt(e)}}}function Pt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||Y(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function jt(e){return e.g?e.g.readyState:0}function Mt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Vt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Ut(e){this.za=0,this.i=[],this.j=new be,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Vt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Vt("baseRetryDelayMs",5e3,e),this.Za=Vt("retryDelaySeedMs",1e4,e),this.Ta=Vt("forwardChannelMaxRetries",2,e),this.va=Vt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new $e(e&&e.concurrentRequestLimit),this.Ba=new _t,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function Ft(e){if(zt(e),3==e.I){var t=e.V++,n=Je(e.J);if(nt(n,"SID",e.M),nt(n,"RID",t),nt(n,"TYPE","terminate"),Ht(e,n),(t=new ke(e,e.j,t)).M=2,t.A=rt(Je(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.A,n=!0),n||(t.g=rn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),je(t)}tn(e)}function Bt(e){e.g&&(Qt(e),e.g.cancel(),e.g=null)}function zt(e){Bt(e),e.v&&(i.clearTimeout(e.v),e.v=null),Xt(e),e.h.cancel(),e.m&&("number"==typeof e.m&&i.clearTimeout(e.m),e.m=null)}function $t(e){if(!qe(e.h)&&!e.m){e.m=!0;var t=e.Ea;v||_(),w||(v(),w=!0),b.add(t,e),e.D=0}}function qt(e,t){var n;n=t?t.l:e.V++;const r=Je(e.J);nt(r,"SID",e.M),nt(r,"RID",n),nt(r,"AID",e.K),Ht(e,r),e.u&&e.o&&kt(r,e.u,e.o),n=new ke(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=Wt(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),Ge(e.h,n),De(n,r,t)}function Ht(e,t){e.H&&D(e.H,function(e,n){nt(t,n,e)}),e.l&&D({},function(e,n){nt(t,n,e)})}function Wt(e,t,n){n=Math.min(e.i.length,n);const r=e.l?c(e.l.Ka,e.l,e):null;e:{var s=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=s[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let c=!0;for(let u=0;u<n;u++){var i=s[u].g;const n=s[u].map;if((i-=t)<0)t=Math.max(0,s[u].g-100),c=!1;else try{i="req"+i+"_"||"";try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;o(n)&&(r=re(n)),e.push(i+t+"="+encodeURIComponent(r))}}catch(l){throw e.push(i+"type="+encodeURIComponent("_badmap")),l}}catch(l){r&&r(n)}}if(c){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function Gt(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;v||_(),w||(v(),w=!0),b.add(t,e),e.A=0}}function Kt(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=we(c(e.Da,e),Zt(e,e.A)),e.A++,!0)}function Qt(e){null!=e.B&&(i.clearTimeout(e.B),e.B=null)}function Yt(e){e.g=new ke(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=Je(e.na);nt(t,"RID","rpc"),nt(t,"SID",e.M),nt(t,"AID",e.K),nt(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&nt(t,"TO",e.ia),nt(t,"TYPE","xmlhttp"),Ht(e,t),e.u&&e.o&&kt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=rt(Je(t)),n.u=null,n.R=!0,Oe(n,e)}function Xt(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function Jt(e,t){var n=null;if(e.g==t){Xt(e),Qt(e),e.g=null;var r=2}else{if(!We(e.h,t))return;n=t.G,Ke(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var s=e.D;Y(r=fe(),new ve(r,n)),$t(e)}else Gt(e);else if(3==(s=t.m)||0==s&&t.X>0||!(1==r&&function(e,t){return!(He(e.h)>=e.h.j-(e.m?1:0)||(e.m?(e.i=t.G.concat(e.i),0):1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta)||(e.m=we(c(e.Ea,e,t),Zt(e,e.D)),e.D++,0)))}(e,t)||2==r&&Kt(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),s){case 1:en(e,5);break;case 4:en(e,10);break;case 3:en(e,6);break;default:en(e,2)}}function Zt(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function en(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.bb,e),r=e.Ua;const t=!r;r=new Xe(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||Ze(r,"https"),rt(r),t?function(e,t){const n=new be;if(i.Image){const r=new Image;r.onload=l(bt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=l(bt,n,"TestLoadImage: error",!1,t,r),r.onabort=l(bt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=l(bt,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new be;const n=new AbortController,r=setTimeout(()=>{n.abort(),bt(0,0,!1,t)},1e4);fetch(e,{signal:n.signal}).then(e=>{clearTimeout(r),e.ok?bt(0,0,!0,t):bt(0,0,!1,t)}).catch(()=>{clearTimeout(r),bt(0,0,!1,t)})}(r.toString(),n)}else ye(2);e.I=0,e.l&&e.l.pa(t),tn(e),zt(e)}function tn(e){if(e.I=0,e.ja=[],e.l){const t=Qe(e.h);0==t.length&&0==e.i.length||(f(e.ja,t),f(e.ja,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.oa()}}function nn(e,t,n){var r=n instanceof Xe?Je(n):new Xe(n);if(""!=r.g)t&&(r.g=t+"."+r.g),et(r,r.u);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;const e=new Xe(null);r&&Ze(e,r),t&&(e.g=t),s&&et(e,s),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&nt(r,n,t),nt(r,"VER",e.ka),Ht(e,r),r}function rn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new At(new Et({ab:n})):new At(e.ma)).Fa(e.L),t}function sn(){}function on(){}function an(e,t){Q.call(this),this.g=new Ut(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!S(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!S(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new un(this)}function cn(e){le.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ln(){ue.call(this),this.status=1}function un(e){this.g=e}(e=At.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Ee.g(),this.g.onreadystatechange=h(c(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Dt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!=typeof r.keys||"function"!=typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),s=i.FormData&&e instanceof i.FormData,!(Array.prototype.indexOf.call(Rt,t,void 0)>=0)||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(o){Dt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,Y(this,"complete"),Y(this,"abort"),Pt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Pt(this,!0)),At.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Lt(this):this.Xa())},e.Xa=function(){Lt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return jt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),se(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"==typeof this.l?this.l:String(this.l)},(e=Ut.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){ye(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=nn(this,null,this.W),$t(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const s=new ke(this,this.j,e);let i=this.o;if(this.U&&(i?(i=O(i),P(i,this.U)):i=this.U),null!==this.u||this.R||(s.J=i,i=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"==typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=Wt(this,s,t),nt(n=Je(this.J),"RID",e),nt(n,"CVER",22),this.G&&nt(n,"X-HTTP-Session-Id",this.G),Ht(this,n),i&&(this.R?t="headers="+Se(Ct(i))+"&"+t:this.u&&kt(n,this.u,i)),Ge(this.h,s),this.Ra&&nt(n,"TYPE","init"),this.S?(nt(n,"$req",t),nt(n,"SID","null"),s.U=!0,De(s,n,null)):De(s,n,t),this.I=2}}else 3==this.I&&(e?qt(this,e):0==this.i.length||qe(this.h)||qt(this))},e.Da=function(){if(this.v=null,Yt(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=we(c(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,ye(10),Bt(this),Yt(this))},e.Va=function(){null!=this.C&&(this.C=null,Bt(this),Kt(this),ye(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),ye(2)):(this.j.info("Failed to ping google.com"),ye(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=sn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},on.prototype.g=function(e,t){return new an(e,t)},u(an,Q),an.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},an.prototype.close=function(){Ft(this.g)},an.prototype.o=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=re(e),e=n);t.i.push(new ze(t.Ya++,e)),3==t.I&&$t(t)},an.prototype.N=function(){this.g.l=null,delete this.j,Ft(this.g),delete this.g,an.Z.N.call(this)},u(cn,le),u(ln,ue),u(un,sn),un.prototype.ra=function(){Y(this.g,"a")},un.prototype.qa=function(e){Y(this.g,new cn(e))},un.prototype.pa=function(e){Y(this.g,new ln)},un.prototype.oa=function(){Y(this.g,"b")},on.prototype.createWebChannel=on.prototype.g,an.prototype.send=an.prototype.o,an.prototype.open=an.prototype.m,an.prototype.close=an.prototype.close,zo=function(){return new on},Bo=function(){return fe()},Fo=he,Uo={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Te.NO_ERROR=0,Te.TIMEOUT=8,Te.HTTP_ERROR=6,Vo=Te,xe.COMPLETE="complete",Mo=xe,ae.EventType=ce,ce.OPEN="a",ce.CLOSE="b",ce.ERROR="c",ce.MESSAGE="d",Q.prototype.listen=Q.prototype.J,jo=ae,At.prototype.listenOnce=At.prototype.K,At.prototype.getLastError=At.prototype.Ha,At.prototype.getLastErrorCode=At.prototype.ya,At.prototype.getStatus=At.prototype.ca,At.prototype.getResponseJson=At.prototype.La,At.prototype.getResponseText=At.prototype.la,At.prototype.send=At.prototype.ea,At.prototype.setWithCredentials=At.prototype.Fa,Po=At}).apply(void 0!==$o?$o:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{});const qo="@firebase/firestore",Ho="4.9.2";class Wo{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Wo.UNAUTHENTICATED=new Wo(null),Wo.GOOGLE_CREDENTIALS=new Wo("google-credentials-uid"),Wo.FIRST_PARTY=new Wo("first-party-uid"),Wo.MOCK_USER=new Wo("mock-user");let Go="12.3.0";const Ko=new ln("@firebase/firestore");function Qo(){return Ko.logLevel}function Yo(e,...t){if(Ko.logLevel<=nn.DEBUG){const n=t.map(Zo);Ko.debug(`Firestore (${Go}): ${e}`,...n)}}function Xo(e,...t){if(Ko.logLevel<=nn.ERROR){const n=t.map(Zo);Ko.error(`Firestore (${Go}): ${e}`,...n)}}function Jo(e,...t){if(Ko.logLevel<=nn.WARN){const n=t.map(Zo);Ko.warn(`Firestore (${Go}): ${e}`,...n)}}function Zo(e){if("string"==typeof e)return e;try{return t=e,JSON.stringify(t)}catch(Ge){return e}var t}function ea(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,ta(e,r,n)}function ta(e,t,n){let r=`FIRESTORE (${Go}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(s){r+=" CONTEXT: "+n}throw Xo(r),new Error(r)}function na(e,t,n,r){let s="Unexpected state";"string"==typeof n?s=n:r=n,e||ta(t,s,r)}function ra(e,t){return e}const sa={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ia extends Bt{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class oa{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class aa{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class ca{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Wo.UNAUTHENTICATED))}shutdown(){}}class la{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ua{constructor(e){this.t=e,this.currentUser=Wo.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){na(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let s=new oa;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new oa,e.enqueueRetryable(()=>r(this.currentUser))};const i=()=>{const t=s;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{Yo("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),i())};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Yo("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new oa)}},0),i()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(Yo("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(na("string"==typeof t.accessToken,31837,{l:t}),new aa(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return na(null===e||"string"==typeof e,2055,{h:e}),new Wo(e)}}class ha{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Wo.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class da{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new ha(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Wo.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class fa{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class pa{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ur(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){na(void 0===this.o,3512);const n=e=>{null!=e.error&&Yo("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,Yo("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};const r=e=>{Yo("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):Yo("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new fa(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?(na("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new fa(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function ma(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class ga{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=ma(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function ya(e,t){return e<t?-1:e>t?1:0}function va(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),s=t.charAt(r);if(n!==s)return _a(n)===_a(s)?ya(n,s):_a(n)?1:-1}return ya(e.length,t.length)}const wa=55296,ba=57343;function _a(e){const t=e.charCodeAt(0);return t>=wa&&t<=ba}function Ea(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}const Ta="__name__";class xa{constructor(e,t,n){void 0===t?t=0:t>e.length&&ea(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&ea(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===xa.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof xa?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=xa.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return ya(e.length,t.length)}static compareSegments(e,t){const n=xa.isNumericId(e),r=xa.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?xa.extractNumericId(e).compare(xa.extractNumericId(t)):va(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Do.fromString(e.substring(4,e.length-2))}}class Ia extends xa{construct(e,t,n){return new Ia(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new ia(sa.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new Ia(t)}static emptyPath(){return new Ia([])}}const Sa=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ca extends xa{construct(e,t,n){return new Ca(e,t,n)}static isValidIdentifier(e){return Sa.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ca.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===Ta}static keyField(){return new Ca([Ta])}static fromServerFormat(e){const t=[];let n="",r=0;const s=()=>{if(0===n.length)throw new ia(sa.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let i=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ia(sa.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ia(sa.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(i=!i,r++):"."!==t||i?(n+=t,r++):(s(),r++)}if(s(),i)throw new ia(sa.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ca(t)}static emptyPath(){return new Ca([])}}class ka{constructor(e){this.path=e}static fromPath(e){return new ka(Ia.fromString(e))}static fromName(e){return new ka(Ia.fromString(e).popFirst(5))}static empty(){return new ka(Ia.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===Ia.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return Ia.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new ka(new Ia(e.slice()))}}function Aa(e,t,n){if(!n)throw new ia(sa.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function Na(e){if(!ka.isDocumentKey(e))throw new ia(sa.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function Ra(e){if(ka.isDocumentKey(e))throw new ia(sa.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function Da(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function Oa(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}var t;return"function"==typeof e?"a function":ea(12329,{type:typeof e})}function La(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ia(sa.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Oa(e);throw new ia(sa.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function Pa(e,t){const n={typeString:e};return t&&(n.value=t),n}function ja(e,t){if(!Da(e))throw new ia(sa.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const s=t[r].typeString,i="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(s&&typeof o!==s){n=`JSON field '${r}' must be a ${s}.`;break}if(void 0!==i&&o!==i.value){n=`Expected '${r}' field to equal '${i.value}'`;break}}if(n)throw new ia(sa.INVALID_ARGUMENT,n);return!0}const Ma=-62135596800,Va=1e6;class Ua{static now(){return Ua.fromMillis(Date.now())}static fromDate(e){return Ua.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*Va);return new Ua(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ia(sa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ia(sa.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<Ma)throw new ia(sa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ia(sa.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/Va}_compareTo(e){return this.seconds===e.seconds?ya(this.nanoseconds,e.nanoseconds):ya(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:Ua._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(ja(e,Ua._jsonSchema))return new Ua(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-Ma;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}Ua._jsonSchemaVersion="firestore/timestamp/1.0",Ua._jsonSchema={type:Pa("string",Ua._jsonSchemaVersion),seconds:Pa("number"),nanoseconds:Pa("number")};class Fa{static fromTimestamp(e){return new Fa(e)}static min(){return new Fa(new Ua(0,0))}static max(){return new Fa(new Ua(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function Ba(e){return new za(e.readTime,e.key,-1)}class za{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new za(Fa.min(),ka.empty(),-1)}static max(){return new za(Fa.max(),ka.empty(),-1)}}function $a(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=ka.comparator(e.documentKey,t.documentKey),0!==n?n:ya(e.largestBatchId,t.largestBatchId))}class qa{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function Ha(e){if(e.code!==sa.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==e.message)throw e;Yo("LocalStore","Unexpectedly lost primary lease")}class Wa{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&ea(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Wa((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof Wa?t:Wa.resolve(t)}catch(t){return Wa.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):Wa.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):Wa.reject(t)}static resolve(e){return new Wa((t,n)=>{t(e)})}static reject(e){return new Wa((t,n)=>{n(e)})}static waitFor(e){return new Wa((t,n)=>{let r=0,s=0,i=!1;e.forEach(e=>{++r,e.next(()=>{++s,i&&s===r&&t()},e=>n(e))}),i=!0,s===r&&t()})}static or(e){let t=Wa.resolve(!1);for(const n of e)t=t.next(e=>e?Wa.resolve(e):n());return t}static forEach(e,t){const n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new Wa((n,r)=>{const s=e.length,i=new Array(s);let o=0;for(let a=0;a<s;a++){const c=a;t(e[c]).next(e=>{i[c]=e,++o,o===s&&n(i)},e=>r(e))}})}static doWhile(e,t){return new Wa((n,r)=>{const s=()=>{!0===e()?t().next(()=>{s()},r):n()};s()})}}function Ga(e){return"IndexedDbTransactionError"===e.name}class Ka{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}Ka.ce=-1;function Qa(e){return null==e}function Ya(e){return 0===e&&1/e==-1/0}function Xa(e,t){let n=t;const r=e.length;for(let s=0;s<r;s++){const t=e.charAt(s);switch(t){case"\0":n+="";break;case"":n+="";break;default:n+=t}}return n}function Ja(e){return e+""}function Za(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ec(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function tc(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class nc{constructor(e,t){this.comparator=e,this.root=t||sc.EMPTY}insert(e,t){return new nc(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,sc.BLACK,null,null))}remove(e){return new nc(this.comparator,this.root.remove(e,this.comparator).copy(null,null,sc.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rc(this.root,e,this.comparator,!0)}}class rc{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&r&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(0===s){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class sc{constructor(e,t,n,r,s){this.key=e,this.value=t,this.color=null!=n?n:sc.RED,this.left=null!=r?r:sc.EMPTY,this.right=null!=s?s:sc.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,s){return new sc(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=s?s:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const s=n(e,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===s?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return sc.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return sc.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,sc.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,sc.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw ea(43730,{key:this.key,value:this.value});if(this.right.isRed())throw ea(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw ea(27949);return e+(this.isRed()?0:1)}}sc.EMPTY=null,sc.RED=!0,sc.BLACK=!1,sc.EMPTY=new class{constructor(){this.size=0}get key(){throw ea(57766)}get value(){throw ea(16141)}get color(){throw ea(16727)}get left(){throw ea(29726)}get right(){throw ea(36894)}copy(e,t,n,r,s){return this}insert(e,t,n){return new sc(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class ic{constructor(e){this.comparator=e,this.data=new nc(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new oc(this.data.getIterator())}getIteratorFrom(e){return new oc(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof ic))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new ic(this.comparator);return t.data=e,t}}class oc{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class ac{constructor(e){this.fields=e,e.sort(Ca.comparator)}static empty(){return new ac([])}unionWith(e){let t=new ic(Ca.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new ac(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Ea(this.fields,e.fields,(e,t)=>e.isEqual(t))}}class cc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class lc{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(t){throw"undefined"!=typeof DOMException&&t instanceof DOMException?new cc("Invalid base64 string: "+t):t}}(e);return new lc(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new lc(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ya(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}lc.EMPTY_BYTE_STRING=new lc("");const uc=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function hc(e){if(na(!!e,39018),"string"==typeof e){let t=0;const n=uc.exec(e);if(na(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:dc(e.seconds),nanos:dc(e.nanos)}}function dc(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function fc(e){return"string"==typeof e?lc.fromBase64String(e):lc.fromUint8Array(e)}const pc="server_timestamp",mc="__type__",gc="__previous_value__",yc="__local_write_time__";function vc(e){const t=(e?.mapValue?.fields||{})[mc]?.stringValue;return t===pc}function wc(e){const t=e.mapValue.fields[gc];return vc(t)?wc(t):t}function bc(e){const t=hc(e.mapValue.fields[yc].timestampValue);return new Ua(t.seconds,t.nanos)}class _c{constructor(e,t,n,r,s,i,o,a,c,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=s,this.forceLongPolling=i,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=l}}const Ec="(default)";class Tc{constructor(e,t){this.projectId=e,this.database=t||Ec}static empty(){return new Tc("","")}get isDefaultDatabase(){return this.database===Ec}isEqual(e){return e instanceof Tc&&e.projectId===this.projectId&&e.database===this.database}}const xc="__type__",Ic="__max__",Sc={},Cc="__vector__",kc="value";function Ac(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?vc(e)?4:function(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Ic}(e)?9007199254740991:function(e){const t=(e?.mapValue?.fields||{})[xc]?.stringValue;return t===Cc}(e)?10:11:ea(28295,{value:e})}function Nc(e,t){if(e===t)return!0;const n=Ac(e);if(n!==Ac(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return bc(e).isEqual(bc(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=hc(e.timestampValue),r=hc(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return r=t,fc(e.bytesValue).isEqual(fc(r.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return dc(e.geoPointValue.latitude)===dc(t.geoPointValue.latitude)&&dc(e.geoPointValue.longitude)===dc(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return dc(e.integerValue)===dc(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=dc(e.doubleValue),r=dc(t.doubleValue);return n===r?Ya(n)===Ya(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return Ea(e.arrayValue.values||[],t.arrayValue.values||[],Nc);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Za(n)!==Za(r))return!1;for(const s in n)if(n.hasOwnProperty(s)&&(void 0===r[s]||!Nc(n[s],r[s])))return!1;return!0}(e,t);default:return ea(52216,{left:e})}var r}function Rc(e,t){return void 0!==(e.values||[]).find(e=>Nc(e,t))}function Dc(e,t){if(e===t)return 0;const n=Ac(e),r=Ac(t);if(n!==r)return ya(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ya(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=dc(e.integerValue||e.doubleValue),r=dc(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return Oc(e.timestampValue,t.timestampValue);case 4:return Oc(bc(e),bc(t));case 5:return va(e.stringValue,t.stringValue);case 6:return function(e,t){const n=fc(e),r=fc(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let s=0;s<n.length&&s<r.length;s++){const e=ya(n[s],r[s]);if(0!==e)return e}return ya(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=ya(dc(e.latitude),dc(t.latitude));return 0!==n?n:ya(dc(e.longitude),dc(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Lc(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},s=n[kc]?.arrayValue,i=r[kc]?.arrayValue,o=ya(s?.values?.length||0,i?.values?.length||0);return 0!==o?o:Lc(s,i)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Sc&&t===Sc)return 0;if(e===Sc)return 1;if(t===Sc)return-1;const n=e.fields||{},r=Object.keys(n),s=t.fields||{},i=Object.keys(s);r.sort(),i.sort();for(let o=0;o<r.length&&o<i.length;++o){const e=va(r[o],i[o]);if(0!==e)return e;const t=Dc(n[r[o]],s[i[o]]);if(0!==t)return t}return ya(r.length,i.length)}(e.mapValue,t.mapValue);default:throw ea(23264,{he:n})}}function Oc(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ya(e,t);const n=hc(e),r=hc(t),s=ya(n.seconds,r.seconds);return 0!==s?s:ya(n.nanos,r.nanos)}function Lc(e,t){const n=e.values||[],r=t.values||[];for(let s=0;s<n.length&&s<r.length;++s){const e=Dc(n[s],r[s]);if(e)return e}return ya(n.length,r.length)}function Pc(e){return jc(e)}function jc(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=hc(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?fc(e.bytesValue).toBase64():"referenceValue"in e?function(e){return ka.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=jc(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const s of t)r?r=!1:n+=",",n+=`${s}:${jc(e.fields[s])}`;return n+"}"}(e.mapValue):ea(61005,{value:e})}function Mc(e){switch(Ac(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=wc(e);return t?16+Mc(t):16;case 5:return 2*e.stringValue.length;case 6:return fc(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return(e.arrayValue.values||[]).reduce((e,t)=>e+Mc(t),0);case 10:case 11:return function(e){let t=0;return ec(e.fields,(e,n)=>{t+=e.length+Mc(n)}),t}(e.mapValue);default:throw ea(13486,{value:e})}}function Vc(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Uc(e){return!!e&&"integerValue"in e}function Fc(e){return!!e&&"arrayValue"in e}function Bc(e){return!!e&&"nullValue"in e}function zc(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function $c(e){return!!e&&"mapValue"in e}function qc(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return ec(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=qc(n)),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=qc(e.arrayValue.values[n]);return t}return{...e}}class Hc{constructor(e){this.value=e}static empty(){return new Hc({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!$c(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=qc(t)}setAll(e){let t=Ca.emptyPath(),n={},r=[];e.forEach((e,s)=>{if(!t.isImmediateParentOf(s)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=s.popLast()}e?n[s.lastSegment()]=qc(e):r.push(s.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,r)}delete(e){const t=this.field(e.popLast());$c(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Nc(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];$c(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ec(t,(t,n)=>e[t]=n);for(const r of n)delete e[r]}clone(){return new Hc(qc(this.value))}}function Wc(e){const t=[];return ec(e.fields,(e,n)=>{const r=new Ca([e]);if($c(n)){const e=Wc(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)}),new ac(t)}class Gc{constructor(e,t,n,r,s,i,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=s,this.data=i,this.documentState=o}static newInvalidDocument(e){return new Gc(e,0,Fa.min(),Fa.min(),Fa.min(),Hc.empty(),0)}static newFoundDocument(e,t,n,r){return new Gc(e,1,t,Fa.min(),n,r,0)}static newNoDocument(e,t){return new Gc(e,2,t,Fa.min(),Fa.min(),Hc.empty(),0)}static newUnknownDocument(e,t){return new Gc(e,3,t,Fa.min(),Fa.min(),Hc.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(Fa.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Hc.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Hc.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Fa.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Gc&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Gc(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Kc{constructor(e,t){this.position=e,this.inclusive=t}}function Qc(e,t,n){let r=0;for(let s=0;s<e.position.length;s++){const i=t[s],o=e.position[s];if(r=i.field.isKeyField()?ka.comparator(ka.fromName(o.referenceValue),n.key):Dc(o,n.data.field(i.field)),"desc"===i.dir&&(r*=-1),0!==r)break}return r}function Yc(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Nc(e.position[n],t.position[n]))return!1;return!0}class Xc{constructor(e,t="asc"){this.field=e,this.dir=t}}function Jc(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Zc{}class el extends Zc{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new al(e,t,n):"array-contains"===t?new hl(e,n):"in"===t?new dl(e,n):"not-in"===t?new fl(e,n):"array-contains-any"===t?new pl(e,n):new el(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new cl(e,n):new ll(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(Dc(t,this.value)):null!==t&&Ac(this.value)===Ac(t)&&this.matchesComparison(Dc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return ea(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class tl extends Zc{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new tl(e,t)}matches(e){return nl(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function nl(e){return"and"===e.op}function rl(e){return function(e){for(const t of e.filters)if(t instanceof tl)return!1;return!0}(e)&&nl(e)}function sl(e){if(e instanceof el)return e.field.canonicalString()+e.op.toString()+Pc(e.value);if(rl(e))return e.filters.map(e=>sl(e)).join(",");{const t=e.filters.map(e=>sl(e)).join(",");return`${e.op}(${t})`}}function il(e,t){return e instanceof el?(n=e,(r=t)instanceof el&&n.op===r.op&&n.field.isEqual(r.field)&&Nc(n.value,r.value)):e instanceof tl?function(e,t){return t instanceof tl&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,n,r)=>e&&il(n,t.filters[r]),!0)}(e,t):void ea(19439);var n,r}function ol(e){return e instanceof el?`${(t=e).field.canonicalString()} ${t.op} ${Pc(t.value)}`:e instanceof tl?function(e){return e.op.toString()+" {"+e.getFilters().map(ol).join(" ,")+"}"}(e):"Filter";var t}class al extends el{constructor(e,t,n){super(e,t,n),this.key=ka.fromName(n.referenceValue)}matches(e){const t=ka.comparator(e.key,this.key);return this.matchesComparison(t)}}class cl extends el{constructor(e,t){super(e,"in",t),this.keys=ul("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ll extends el{constructor(e,t){super(e,"not-in",t),this.keys=ul("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function ul(e,t){return(t.arrayValue?.values||[]).map(e=>ka.fromName(e.referenceValue))}class hl extends el{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Fc(t)&&Rc(t.arrayValue,this.value)}}class dl extends el{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&Rc(this.value.arrayValue,t)}}class fl extends el{constructor(e,t){super(e,"not-in",t)}matches(e){if(Rc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!Rc(this.value.arrayValue,t)}}class pl extends el{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Fc(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>Rc(this.value.arrayValue,e))}}class ml{constructor(e,t=null,n=[],r=[],s=null,i=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=s,this.startAt=i,this.endAt=o,this.Te=null}}function gl(e,t=null,n=[],r=[],s=null,i=null,o=null){return new ml(e,t,n,r,s,i,o)}function yl(e){const t=ra(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>sl(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>{return(t=e).field.canonicalString()+t.dir;var t}).join(","),Qa(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>Pc(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>Pc(e)).join(",")),t.Te=e}return t.Te}function vl(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Jc(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!il(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Yc(e.startAt,t.startAt)&&Yc(e.endAt,t.endAt)}function wl(e){return ka.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class bl{constructor(e,t=null,n=[],r=[],s=null,i="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=s,this.limitType=i,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function _l(e){return new bl(e)}function El(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Tl(e){return null!==e.collectionGroup}function xl(e){const t=ra(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const r of t.explicitOrderBy)t.Ie.push(r),e.add(r.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(e){let t=new ic(Ca.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t})(t).forEach(r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new Xc(r,n))}),e.has(Ca.keyField().canonicalString())||t.Ie.push(new Xc(Ca.keyField(),n))}return t.Ie}function Il(e){const t=ra(e);return t.Ee||(t.Ee=function(e,t){if("F"===e.limitType)return gl(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{const t="desc"===e.dir?"asc":"desc";return new Xc(e.field,t)});const n=e.endAt?new Kc(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Kc(e.startAt.position,e.startAt.inclusive):null;return gl(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}(t,xl(e))),t.Ee}function Sl(e,t){const n=e.filters.concat([t]);return new bl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function Cl(e,t,n){return new bl(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function kl(e,t){return vl(Il(e),Il(t))&&e.limitType===t.limitType}function Al(e){return`${yl(Il(e))}|lt:${e.limitType}`}function Nl(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>ol(e)).join(", ")}]`),Qa(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>{return`${(t=e).field.canonicalString()} (${t.dir})`;var t}).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>Pc(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>Pc(e)).join(",")),`Target(${t})`}(Il(e))}; limitType=${e.limitType})`}function Rl(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):ka.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of xl(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(r=t,!((n=e).startAt&&!function(e,t,n){const r=Qc(e,t,n);return e.inclusive?r<=0:r<0}(n.startAt,xl(n),r)||n.endAt&&!function(e,t,n){const r=Qc(e,t,n);return e.inclusive?r>=0:r>0}(n.endAt,xl(n),r)));var n,r}function Dl(e){return(t,n)=>{let r=!1;for(const s of xl(e)){const e=Ol(s,t,n);if(0!==e)return e;r=r||s.field.isKeyField()}return 0}}function Ol(e,t,n){const r=e.field.isKeyField()?ka.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),s=n.data.field(e);return null!==r&&null!==s?Dc(r,s):ea(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return ea(19790,{direction:e.dir})}}class Ll{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,s]of n)if(this.equalsFn(r,e))return s}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return void(r[s]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ec(this.inner,(t,n)=>{for(const[r,s]of n)e(r,s)})}isEmpty(){return tc(this.inner)}size(){return this.innerSize}}const Pl=new nc(ka.comparator);function jl(){return Pl}const Ml=new nc(ka.comparator);function Vl(...e){let t=Ml;for(const n of e)t=t.insert(n.key,n);return t}function Ul(e){let t=Ml;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function Fl(){return zl()}function Bl(){return zl()}function zl(){return new Ll(e=>e.toString(),(e,t)=>e.isEqual(t))}const $l=new nc(ka.comparator),ql=new ic(ka.comparator);function Hl(...e){let t=ql;for(const n of e)t=t.add(n);return t}const Wl=new ic(ya);function Gl(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Ya(t)?"-0":t}}function Kl(e){return{integerValue:""+e}}function Ql(e,t){return function(e){return"number"==typeof e&&Number.isInteger(e)&&!Ya(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}(t)?Kl(t):Gl(e,t)}class Yl{constructor(){this._=void 0}}function Xl(e,t,n){return e instanceof eu?function(e,t){const n={fields:{[mc]:{stringValue:pc},[yc]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&vc(t)&&(t=wc(t)),t&&(n.fields[gc]=t),{mapValue:n}}(n,t):e instanceof tu?nu(e,t):e instanceof ru?su(e,t):function(e,t){const n=Zl(e,t),r=ou(n)+ou(e.Ae);return Uc(n)&&Uc(e.Ae)?Kl(r):Gl(e.serializer,r)}(e,t)}function Jl(e,t,n){return e instanceof tu?nu(e,t):e instanceof ru?su(e,t):n}function Zl(e,t){return e instanceof iu?Uc(n=t)||(r=n)&&"doubleValue"in r?t:{integerValue:0}:null;var n,r}class eu extends Yl{}class tu extends Yl{constructor(e){super(),this.elements=e}}function nu(e,t){const n=au(t);for(const r of e.elements)n.some(e=>Nc(e,r))||n.push(r);return{arrayValue:{values:n}}}class ru extends Yl{constructor(e){super(),this.elements=e}}function su(e,t){let n=au(t);for(const r of e.elements)n=n.filter(e=>!Nc(e,r));return{arrayValue:{values:n}}}class iu extends Yl{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function ou(e){return dc(e.integerValue||e.doubleValue)}function au(e){return Fc(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class cu{constructor(e,t){this.field=e,this.transform=t}}class lu{constructor(e,t){this.version=e,this.transformResults=t}}class uu{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new uu}static exists(e){return new uu(void 0,e)}static updateTime(e){return new uu(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hu(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class du{}function fu(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new Tu(e.key,uu.none()):new vu(e.key,e.data,uu.none());{const n=e.data,r=Hc.empty();let s=new ic(Ca.comparator);for(let e of t.fields)if(!s.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),s=s.add(e)}return new wu(e.key,r,new ac(s.toArray()),uu.none())}}function pu(e,t,n){var r;e instanceof vu?function(e,t,n){const r=e.value.clone(),s=_u(e.fieldTransforms,t,n.transformResults);r.setAll(s),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof wu?function(e,t,n){if(!hu(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=_u(e.fieldTransforms,t,n.transformResults),s=t.data;s.setAll(bu(e)),s.setAll(r),t.convertToFoundDocument(n.version,s).setHasCommittedMutations()}(e,t,n):(r=n,t.convertToNoDocument(r.version).setHasCommittedMutations())}function mu(e,t,n,r){return e instanceof vu?function(e,t,n,r){if(!hu(e.precondition,t))return n;const s=e.value.clone(),i=Eu(e.fieldTransforms,r,t);return s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null}(e,t,n,r):e instanceof wu?function(e,t,n,r){if(!hu(e.precondition,t))return n;const s=Eu(e.fieldTransforms,r,t),i=t.data;return i.setAll(bu(e)),i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):(s=t,i=n,hu(e.precondition,s)?(s.convertToNoDocument(s.version).setHasLocalMutations(),null):i);var s,i}function gu(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),s=Zl(r.transform,e||null);null!=s&&(null===n&&(n=Hc.empty()),n.set(r.field,s))}return n||null}function yu(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||n&&r&&Ea(n,r,(e,t)=>function(e,t){return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof tu&&r instanceof tu||n instanceof ru&&r instanceof ru?Ea(n.elements,r.elements,Nc):n instanceof iu&&r instanceof iu?Nc(n.Ae,r.Ae):n instanceof eu&&r instanceof eu);var n,r}(e,t)))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask)));var n,r}class vu extends du{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class wu extends du{constructor(e,t,n,r,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function bu(e){const t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}}),t}function _u(e,t,n){const r=new Map;na(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let s=0;s<n.length;s++){const i=e[s],o=i.transform,a=t.data.field(i.field);r.set(i.field,Jl(o,a,n[s]))}return r}function Eu(e,t,n){const r=new Map;for(const s of e){const e=s.transform,i=n.data.field(s.field);r.set(s.field,Xl(e,i,t))}return r}class Tu extends du{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class xu extends du{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class Iu{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&pu(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=mu(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=mu(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Bl();return this.mutations.forEach(r=>{const s=e.get(r.key),i=s.overlayedDocument;let o=this.applyToLocalView(i,s.mutatedFields);o=t.has(r.key)?null:o;const a=fu(i,o);null!==a&&n.set(r.key,a),i.isValidDocument()||i.convertToNoDocument(Fa.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Hl())}isEqual(e){return this.batchId===e.batchId&&Ea(this.mutations,e.mutations,(e,t)=>yu(e,t))&&Ea(this.baseMutations,e.baseMutations,(e,t)=>yu(e,t))}}class Su{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){na(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=function(){return $l}();const s=e.mutations;for(let i=0;i<s.length;i++)r=r.insert(s[i].key,n[i].version);return new Su(e,t,n,r)}}class Cu{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class ku{constructor(e,t){this.count=e,this.unchangedNames=t}}var Au,Nu;function Ru(e){if(void 0===e)return Xo("GRPC error has no .code"),sa.UNKNOWN;switch(e){case Au.OK:return sa.OK;case Au.CANCELLED:return sa.CANCELLED;case Au.UNKNOWN:return sa.UNKNOWN;case Au.DEADLINE_EXCEEDED:return sa.DEADLINE_EXCEEDED;case Au.RESOURCE_EXHAUSTED:return sa.RESOURCE_EXHAUSTED;case Au.INTERNAL:return sa.INTERNAL;case Au.UNAVAILABLE:return sa.UNAVAILABLE;case Au.UNAUTHENTICATED:return sa.UNAUTHENTICATED;case Au.INVALID_ARGUMENT:return sa.INVALID_ARGUMENT;case Au.NOT_FOUND:return sa.NOT_FOUND;case Au.ALREADY_EXISTS:return sa.ALREADY_EXISTS;case Au.PERMISSION_DENIED:return sa.PERMISSION_DENIED;case Au.FAILED_PRECONDITION:return sa.FAILED_PRECONDITION;case Au.ABORTED:return sa.ABORTED;case Au.OUT_OF_RANGE:return sa.OUT_OF_RANGE;case Au.UNIMPLEMENTED:return sa.UNIMPLEMENTED;case Au.DATA_LOSS:return sa.DATA_LOSS;default:return ea(39323,{code:e})}}(Nu=Au||(Au={}))[Nu.OK=0]="OK",Nu[Nu.CANCELLED=1]="CANCELLED",Nu[Nu.UNKNOWN=2]="UNKNOWN",Nu[Nu.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Nu[Nu.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Nu[Nu.NOT_FOUND=5]="NOT_FOUND",Nu[Nu.ALREADY_EXISTS=6]="ALREADY_EXISTS",Nu[Nu.PERMISSION_DENIED=7]="PERMISSION_DENIED",Nu[Nu.UNAUTHENTICATED=16]="UNAUTHENTICATED",Nu[Nu.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Nu[Nu.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Nu[Nu.ABORTED=10]="ABORTED",Nu[Nu.OUT_OF_RANGE=11]="OUT_OF_RANGE",Nu[Nu.UNIMPLEMENTED=12]="UNIMPLEMENTED",Nu[Nu.INTERNAL=13]="INTERNAL",Nu[Nu.UNAVAILABLE=14]="UNAVAILABLE",Nu[Nu.DATA_LOSS=15]="DATA_LOSS";const Du=new Do([4294967295,4294967295],0);function Ou(e){const t=(new TextEncoder).encode(e),n=new Oo;return n.update(t),new Uint8Array(n.digest())}function Lu(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),s=t.getUint32(8,!0),i=t.getUint32(12,!0);return[new Do([n,r],0),new Do([s,i],0)]}class Pu{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ju(`Invalid padding: ${t}`);if(n<0)throw new ju(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ju(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ju(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=Do.fromNumber(this.ge)}ye(e,t,n){let r=e.add(t.multiply(Do.fromNumber(n)));return 1===r.compare(Du)&&(r=new Do([r.getBits(0),r.getBits(1)],0)),r.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=Ou(e),[n,r]=Lu(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),i=new Pu(s,r,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.ge)return;const t=Ou(e),[n,r]=Lu(t);for(let s=0;s<this.hashCount;s++){const e=this.ye(n,r,s);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ju extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Mu{constructor(e,t,n,r,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Vu.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Mu(Fa.min(),r,new nc(ya),jl(),Hl())}}class Vu{constructor(e,t,n,r,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Vu(n,t,Hl(),Hl(),Hl())}}class Uu{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class Fu{constructor(e,t){this.targetId=e,this.Ce=t}}class Bu{constructor(e,t,n=lc.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class zu{constructor(){this.ve=0,this.Fe=Hu(),this.Me=lc.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=Hl(),t=Hl(),n=Hl();return this.Fe.forEach((r,s)=>{switch(s){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:ea(38017,{changeType:s})}}),new Vu(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=Hu()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,na(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class $u{constructor(e){this.Ge=e,this.ze=new Map,this.je=jl(),this.Je=qu(),this.He=qu(),this.Ye=new nc(ya)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:ea(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach((e,n)=>{this.rt(n)&&t(n)})}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const s=r.target;if(wl(s))if(0===n){const e=new ka(s.path);this.et(t,e,Gc.newNoDocument(e,Fa.min()))}else na(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),s=n?this.ct(n,e,r):1;if(0!==s){this.it(t);const e=2===s?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:s=0}=t;let i,o;try{i=fc(n).toUint8Array()}catch(a){if(a instanceof cc)return Jo("Decoding the base64 bloom filter in existence filter failed ("+a.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw a}try{o=new Pu(i,r,s)}catch(a){return Jo(a instanceof ju?"BloomFilter error: ":"Applying bloom filter failed: ",a),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach(n=>{const s=this.Ge.ht(),i=`projects/${s.projectId}/databases/${s.database}/documents/${n.path.canonicalString()}`;e.mightContain(i)||(this.et(t,n,null),r++)}),r}Tt(e){const t=new Map;this.ze.forEach((n,r)=>{const s=this.ot(r);if(s){if(n.current&&wl(s.target)){const t=new ka(s.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,Gc.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}});let n=Hl();this.He.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.je.forEach((t,n)=>n.setReadTime(e));const r=new Mu(e,t,this.Ye,this.je,n);return this.je=jl(),this.Je=qu(),this.He=qu(),this.Ye=new nc(ya),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new zu,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new ic(ya),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new ic(ya),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||Yo("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new zu),this.Ge.getRemoteKeysForTarget(e).forEach(t=>{this.et(e,t,null)})}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function qu(){return new nc(ka.comparator)}function Hu(){return new nc(ka.comparator)}const Wu=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),Gu=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),Ku=(()=>({and:"AND",or:"OR"}))();class Qu{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Yu(e,t){return e.useProto3Json||Qa(t)?t:{value:t}}function Xu(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Ju(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Zu(e,t){return Xu(e,t.toTimestamp())}function eh(e){return na(!!e,49232),Fa.fromTimestamp(function(e){const t=hc(e);return new Ua(t.seconds,t.nanos)}(e))}function th(e,t){return nh(e,t).canonicalString()}function nh(e,t){const n=(r=e,new Ia(["projects",r.projectId,"databases",r.database])).child("documents");var r;return void 0===t?n:n.child(t)}function rh(e){const t=Ia.fromString(e);return na(_h(t),10190,{key:t.toString()}),t}function sh(e,t){return th(e.databaseId,t.path)}function ih(e,t){const n=rh(t);if(n.get(1)!==e.databaseId.projectId)throw new ia(sa.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ia(sa.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new ka(ch(n))}function oh(e,t){return th(e.databaseId,t)}function ah(e){return new Ia(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ch(e){return na(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function lh(e,t,n){return{name:sh(e,t),fields:n.value.mapValue.fields}}function uh(e,t){return{documents:[oh(e,t.path)]}}function hh(e,t){const n={structuredQuery:{}},r=t.path;let s;null!==t.collectionGroup?(s=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=oh(e,s);const i=function(e){if(0!==e.length)return wh(tl.create(e,"and"))}(t.filters);i&&(n.structuredQuery.where=i);const o=function(e){if(0!==e.length)return e.map(e=>{return{field:yh((t=e).field),direction:ph(t.dir)};var t})}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Yu(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt={before:(c=t.startAt).inclusive,values:c.position}),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:s};var c}function dh(e){let t=function(e){const t=rh(e);return 4===t.length?Ia.emptyPath():ch(t)}(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){na(1===r,65062);const e=n.from[0];e.allDescendants?s=e.collectionId:t=t.child(e.collectionId)}let i=[];n.where&&(i=function(e){const t=fh(e);return t instanceof tl&&rl(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=n.orderBy.map(e=>{return new Xc(vh((t=e).field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(t.direction));var t}));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Qa(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new Kc(n,t)}(n.startAt));let l=null;return n.endAt&&(l=function(e){const t=!e.before,n=e.values||[];return new Kc(n,t)}(n.endAt)),function(e,t,n,r,s,i,o,a){return new bl(e,t,n,r,s,i,o,a)}(t,s,o,i,a,"F",c,l)}function fh(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=vh(e.unaryFilter.field);return el.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=vh(e.unaryFilter.field);return el.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=vh(e.unaryFilter.field);return el.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const s=vh(e.unaryFilter.field);return el.create(s,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return ea(61313);default:return ea(60726)}}(e):void 0!==e.fieldFilter?(t=e,el.create(vh(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return ea(58110);default:return ea(50506)}}(t.fieldFilter.op),t.fieldFilter.value)):void 0!==e.compositeFilter?function(e){return tl.create(e.compositeFilter.filters.map(e=>fh(e)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return ea(1026)}}(e.compositeFilter.op))}(e):ea(30097,{filter:e});var t}function ph(e){return Wu[e]}function mh(e){return Gu[e]}function gh(e){return Ku[e]}function yh(e){return{fieldPath:e.canonicalString()}}function vh(e){return Ca.fromServerFormat(e.fieldPath)}function wh(e){return e instanceof el?function(e){if("=="===e.op){if(zc(e.value))return{unaryFilter:{field:yh(e.field),op:"IS_NAN"}};if(Bc(e.value))return{unaryFilter:{field:yh(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(zc(e.value))return{unaryFilter:{field:yh(e.field),op:"IS_NOT_NAN"}};if(Bc(e.value))return{unaryFilter:{field:yh(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yh(e.field),op:mh(e.op),value:e.value}}}(e):e instanceof tl?function(e){const t=e.getFilters().map(e=>wh(e));return 1===t.length?t[0]:{compositeFilter:{op:gh(e.op),filters:t}}}(e):ea(54877,{filter:e})}function bh(e){const t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function _h(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Eh{constructor(e,t,n,r,s=Fa.min(),i=Fa.min(),o=lc.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=i,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Eh(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Eh(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Eh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Eh(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Th{constructor(e){this.yt=e}}function xh(e){const t=dh({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?Cl(t,t.limit,"L"):t}class Ih{constructor(){this.Cn=new Sh}addToCollectionParentIndex(e,t){return this.Cn.add(t),Wa.resolve()}getCollectionParents(e,t){return Wa.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Wa.resolve()}deleteFieldIndex(e,t){return Wa.resolve()}deleteAllFieldIndexes(e){return Wa.resolve()}createTargetIndexes(e,t){return Wa.resolve()}getDocumentsMatchingTarget(e,t){return Wa.resolve(null)}getIndexType(e,t){return Wa.resolve(0)}getFieldIndexes(e,t){return Wa.resolve([])}getNextCollectionGroupToUpdate(e){return Wa.resolve(null)}getMinOffset(e,t){return Wa.resolve(za.min())}getMinOffsetFromCollectionGroup(e,t){return Wa.resolve(za.min())}updateCollectionGroup(e,t,n){return Wa.resolve()}updateIndexEntries(e,t){return Wa.resolve()}}class Sh{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new ic(Ia.comparator),s=!r.has(n);return this.index[t]=r.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new ic(Ia.comparator)).toArray()}}const Ch={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kh=41943040;class Ah{static withCacheSize(e){return new Ah(e,Ah.DEFAULT_COLLECTION_PERCENTILE,Ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}Ah.DEFAULT_COLLECTION_PERCENTILE=10,Ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ah.DEFAULT=new Ah(kh,Ah.DEFAULT_COLLECTION_PERCENTILE,Ah.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ah.DISABLED=new Ah(-1,0,0);class Nh{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new Nh(0)}static cr(){return new Nh(-1)}}const Rh="LruGarbageCollector";function Dh([e,t],[n,r]){const s=ya(e,n);return 0===s?ya(t,r):s}class Oh{constructor(e){this.Ir=e,this.buffer=new ic(Dh),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Dh(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Lh{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){Yo(Rh,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Ga(e)?Yo(Rh,"Ignoring IndexedDB error during garbage collection: ",e):await Ha(e)}await this.Vr(3e5)})}}class Ph{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return Wa.resolve(Ka.ce);const n=new Oh(t);return this.mr.forEachTarget(e,e=>n.Ar(e.sequenceNumber)).next(()=>this.mr.pr(e,e=>n.Ar(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Yo("LruGarbageCollector","Garbage collection skipped; disabled"),Wa.resolve(Ch)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Yo("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ch):this.yr(e,t))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,s,i,o,a,c;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(Yo("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,i=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(s=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(c=Date.now(),Qo()<=nn.DEBUG&&Yo("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${i-l}ms\n\tDetermined least recently used ${r} in `+(o-i)+`ms\n\tRemoved ${s} targets in `+(a-o)+`ms\n\tRemoved ${e} documents in `+(c-a)+`ms\nTotal Duration: ${c-l}ms`),Wa.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:e})))}}class jh{constructor(){this.changes=new Ll(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Gc.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Wa.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Mh{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Vh{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&mu(n.mutation,e,ac.empty(),Ua.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,Hl()).next(()=>t))}getLocalViewOfDocuments(e,t,n=Hl()){const r=Fl();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=Vl();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){const n=Fl();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Hl()))}populateOverlays(e,t,n){const r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let s=jl();const i=zl(),o=zl();return t.forEach((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof wu)?s=s.insert(t.key,t):void 0!==o?(i.set(t.key,o.mutation.getFieldMask()),mu(o.mutation,t,o.mutation.getFieldMask(),Ua.now())):i.set(t.key,ac.empty())}),this.recalculateAndSaveOverlays(e,s).next(e=>(e.forEach((e,t)=>i.set(e,t)),t.forEach((e,t)=>o.set(e,new Mh(t,i.get(e)??null))),o))}recalculateAndSaveOverlays(e,t){const n=zl();let r=new nc((e,t)=>e-t),s=Hl();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(const s of e)s.keys().forEach(e=>{const i=t.get(e);if(null===i)return;let o=n.get(e)||ac.empty();o=s.applyToLocalView(i,o),n.set(e,o);const a=(r.get(s.batchId)||Hl()).add(e);r=r.insert(s.batchId,a)})}).next(()=>{const i=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,l=Bl();c.forEach(e=>{if(!s.has(e)){const r=fu(t.get(e),n.get(e));null!==r&&l.set(e,r),s=s.add(e)}}),i.push(this.documentOverlayCache.saveOverlays(e,a,l))}return Wa.waitFor(i)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n,r){return s=t,ka.isDocumentKey(s.path)&&null===s.collectionGroup&&0===s.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):Tl(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r);var s}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(s=>{const i=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-s.size):Wa.resolve(Fl());let o=-1,a=s;return i.next(t=>Wa.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),s.get(t)?Wa.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,s)).next(()=>this.computeViews(e,a,t,Hl())).next(e=>({batchId:o,changes:Ul(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new ka(t)).next(e=>{let t=Vl();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const s=t.collectionGroup;let i=Vl();return this.indexManager.getCollectionParents(e,s).next(o=>Wa.forEach(o,o=>{const a=(c=t,l=o.child(s),new bl(l,null,c.explicitOrderBy.slice(),c.filters.slice(),c.limit,c.limitType,c.startAt,c.endAt));var c,l;return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n,r){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(s=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,r))).next(e=>{s.forEach((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Gc.newInvalidDocument(r)))});let n=Vl();return e.forEach((e,r)=>{const i=s.get(e);void 0!==i&&mu(i.mutation,r,ac.empty(),Ua.now()),Rl(t,r)&&(n=n.insert(e,r))}),n})}}class Uh{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Wa.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,{id:(n=t).id,version:n.version,createTime:eh(n.createTime)}),Wa.resolve();var n}getNamedQuery(e,t){return Wa.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,{name:(n=t).name,query:xh(n.bundledQuery),readTime:eh(n.readTime)}),Wa.resolve();var n}}class Fh{constructor(){this.overlays=new nc(ka.comparator),this.qr=new Map}getOverlay(e,t){return Wa.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Fl();return Wa.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.St(e,t,r)}),Wa.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.qr.delete(n)),Wa.resolve()}getOverlaysForCollection(e,t,n){const r=Fl(),s=t.length+1,i=new ka(t.child("")),o=this.overlays.getIteratorFrom(i);for(;o.hasNext();){const e=o.getNext().value,i=e.getKey();if(!t.isPrefixOf(i.path))break;i.path.length===s&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Wa.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let s=new nc((e,t)=>e-t);const i=this.overlays.getIterator();for(;i.hasNext();){const e=i.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=s.get(e.largestBatchId);null===t&&(t=Fl(),s=s.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Fl(),a=s.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return Wa.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Cu(t,n));let s=this.qr.get(t);void 0===s&&(s=Hl(),this.qr.set(t,s)),this.qr.set(t,s.add(n.key))}}class Bh{constructor(){this.sessionToken=lc.EMPTY_BYTE_STRING}getSessionToken(e){return Wa.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Wa.resolve()}}class zh{constructor(){this.Qr=new ic($h.$r),this.Ur=new ic($h.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new $h(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.Gr(new $h(e,t))}zr(e,t){e.forEach(e=>this.removeReference(e,t))}jr(e){const t=new ka(new Ia([])),n=new $h(t,e),r=new $h(t,e+1),s=[];return this.Ur.forEachInRange([n,r],e=>{this.Gr(e),s.push(e.key)}),s}Jr(){this.Qr.forEach(e=>this.Gr(e))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new ka(new Ia([])),n=new $h(t,e),r=new $h(t,e+1);let s=Hl();return this.Ur.forEachInRange([n,r],e=>{s=s.add(e.key)}),s}containsKey(e){const t=new $h(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class $h{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return ka.comparator(e.key,t.key)||ya(e.Yr,t.Yr)}static Kr(e,t){return ya(e.Yr,t.Yr)||ka.comparator(e.key,t.key)}}class qh{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new ic($h.$r)}checkEmpty(e){return Wa.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const s=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const i=new Iu(s,t,n,r);this.mutationQueue.push(i);for(const o of r)this.Zr=this.Zr.add(new $h(o.key,s)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Wa.resolve(i)}lookupMutationBatch(e,t){return Wa.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),s=r<0?0:r;return Wa.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return Wa.resolve(0===this.mutationQueue.length?-1:this.tr-1)}getAllMutationBatches(e){return Wa.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new $h(t,0),r=new $h(t,Number.POSITIVE_INFINITY),s=[];return this.Zr.forEachInRange([n,r],e=>{const t=this.Xr(e.Yr);s.push(t)}),Wa.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new ic(ya);return t.forEach(e=>{const t=new $h(e,0),r=new $h(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],e=>{n=n.add(e.Yr)})}),Wa.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let s=n;ka.isDocumentKey(s)||(s=s.child(""));const i=new $h(new ka(s),0);let o=new ic(ya);return this.Zr.forEachWhile(e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)},i),Wa.resolve(this.ti(o))}ti(e){const t=[];return e.forEach(e=>{const n=this.Xr(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){na(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Wa.forEach(t.mutations,r=>{const s=new $h(r.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Zr=n})}ir(e){}containsKey(e,t){const n=new $h(t,0),r=this.Zr.firstAfterOrEqual(n);return Wa.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Wa.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class Hh{constructor(e){this.ri=e,this.docs=new nc(ka.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),s=r?r.size:0,i=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:i}),this.size+=i-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Wa.resolve(n?n.document.mutableCopy():Gc.newInvalidDocument(t))}getEntries(e,t){let n=jl();return t.forEach(e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Gc.newInvalidDocument(e))}),Wa.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let s=jl();const i=t.path,o=new ka(i.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!i.isPrefixOf(e.path))break;e.path.length>i.length+1||$a(Ba(o),n)<=0||(r.has(o.key)||Rl(t,o))&&(s=s.insert(o.key,o.mutableCopy()))}return Wa.resolve(s)}getAllFromCollectionGroup(e,t,n,r){ea(9500)}ii(e,t){return Wa.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new Wh(this)}getSize(e){return Wa.resolve(this.size)}}class Wh extends jh{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)}),Wa.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class Gh{constructor(e){this.persistence=e,this.si=new Ll(e=>yl(e),vl),this.lastRemoteSnapshotVersion=Fa.min(),this.highestTargetId=0,this.oi=0,this._i=new zh,this.targetCount=0,this.ai=Nh.ur()}forEachTarget(e,t){return this.si.forEach((e,n)=>t(n)),Wa.resolve()}getLastRemoteSnapshotVersion(e){return Wa.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Wa.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Wa.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Wa.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new Nh(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Wa.resolve()}updateTargetData(e,t){return this.Pr(t),Wa.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Wa.resolve()}removeTargets(e,t,n){let r=0;const s=[];return this.si.forEach((i,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(i),s.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),Wa.waitFor(s).next(()=>r)}getTargetCount(e){return Wa.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Wa.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Wa.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,s=[];return r&&t.forEach(t=>{s.push(r.markPotentiallyOrphaned(e,t))}),Wa.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Wa.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Wa.resolve(n)}containsKey(e,t){return Wa.resolve(this._i.containsKey(t))}}class Kh{constructor(e,t){this.ui={},this.overlays={},this.ci=new Ka(0),this.li=!1,this.li=!0,this.hi=new Bh,this.referenceDelegate=e(this),this.Pi=new Gh(this),this.indexManager=new Ih,this.remoteDocumentCache=new Hh(e=>this.referenceDelegate.Ti(e)),this.serializer=new Th(t),this.Ii=new Uh(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Fh,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new qh(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){Yo("MemoryPersistence","Starting transaction:",e);const r=new Qh(this.ci.next());return this.referenceDelegate.Ei(),n(r).next(e=>this.referenceDelegate.di(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ai(e,t){return Wa.or(Object.values(this.ui).map(n=>()=>n.containsKey(e,t)))}}class Qh extends qa{constructor(e){super(),this.currentSequenceNumber=e}}class Yh{constructor(e){this.persistence=e,this.Ri=new zh,this.Vi=null}static mi(e){return new Yh(e)}get fi(){if(this.Vi)return this.Vi;throw ea(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Wa.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Wa.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Wa.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach(e=>this.fi.add(e.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.fi.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Wa.forEach(this.fi,n=>{const r=ka.fromPath(n);return this.gi(e,r).next(e=>{e||t.removeEntry(r,Fa.min())})}).next(()=>(this.Vi=null,t.apply(e)))}updateLimboDocument(e,t){return this.gi(e,t).next(e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())})}Ti(e){return 0}gi(e,t){return Wa.or([()=>Wa.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Xh{constructor(e,t){this.persistence=e,this.pi=new Ll(e=>function(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=Ja(t)),t=Xa(e.get(n),t);return Ja(t)}(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=function(e,t){return new Ph(e,t)}(this,t)}static mi(e,t){return new Xh(e,t)}Ei(){}di(e){return Wa.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}wr(e){let t=0;return this.pr(e,e=>{t++}).next(()=>t)}pr(e,t){return Wa.forEach(this.pi,(n,r)=>this.br(e,n,r).next(e=>e?Wa.resolve():t(r)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),s=r.newChangeBuffer();return r.ii(e,r=>this.br(e,r,t).next(e=>{e||(n++,s.removeEntry(r,Fa.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Wa.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Wa.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Wa.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Wa.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Mc(e.data.value)),t}br(e,t,n){return Wa.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Wa.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class Jh{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=Hl(),r=Hl();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new Jh(e,t.fromCache,n,r)}}class Zh{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class ed{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=Ft()?8:function(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}(Ut())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const s={result:null};return this.ys(e,t).next(e=>{s.result=e}).next(()=>{if(!s.result)return this.ws(e,t,r,n).next(e=>{s.result=e})}).next(()=>{if(s.result)return;const n=new Zh;return this.Ss(e,t,n).next(r=>{if(s.result=r,this.Vs)return this.bs(e,t,n,r.size)})}).next(()=>s.result)}bs(e,t,n,r){return n.documentReadCount<this.fs?(Qo()<=nn.DEBUG&&Yo("QueryEngine","SDK will not create cache indexes for query:",Nl(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Wa.resolve()):(Qo()<=nn.DEBUG&&Yo("QueryEngine","Query:",Nl(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(Qo()<=nn.DEBUG&&Yo("QueryEngine","The SDK decides to create cache indexes for query:",Nl(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Il(t))):Wa.resolve())}ys(e,t){if(El(t))return Wa.resolve(null);let n=Il(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(t=Cl(t,null,"F"),n=Il(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{const s=Hl(...r);return this.ps.getDocuments(e,s).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{const i=this.Ds(t,r);return this.Cs(t,i,s,n.readTime)?this.ys(e,Cl(t,null,"F")):this.vs(e,i,t,n)}))})))}ws(e,t,n,r){return El(t)||r.isEqual(Fa.min())?Wa.resolve(null):this.ps.getDocuments(e,n).next(s=>{const i=this.Ds(t,s);return this.Cs(t,i,n,r)?Wa.resolve(null):(Qo()<=nn.DEBUG&&Yo("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Nl(t)),this.vs(e,i,t,function(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,s=Fa.fromTimestamp(1e9===r?new Ua(n+1,0):new Ua(n,r));return new za(s,ka.empty(),t)}(r,-1)).next(e=>e))})}Ds(e,t){let n=new ic(Dl(e));return t.forEach((t,r)=>{Rl(e,r)&&(n=n.add(r))}),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const s="F"===e.limitType?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Ss(e,t,n){return Qo()<=nn.DEBUG&&Yo("QueryEngine","Using full collection scan to execute query:",Nl(t)),this.ps.getDocumentsMatchingQuery(e,t,za.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}const td="LocalStore";class nd{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new nc(ya),this.xs=new Ll(e=>yl(e),vl),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Vh(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Ms))}}async function rd(e,t){const n=ra(e);return await n.persistence.runTransaction("Handle user change","readonly",e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next(s=>(r=s,n.Bs(t),n.mutationQueue.getAllMutationBatches(e))).next(t=>{const s=[],i=[];let o=Hl();for(const e of r){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next(e=>({Ls:e,removedBatchIds:s,addedBatchIds:i}))})})}function sd(e){const t=ra(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Pi.getLastRemoteSnapshotVersion(e))}function id(e,t){const n=ra(e),r=t.snapshotVersion;let s=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{const i=n.Ns.newChangeBuffer({trackRemovals:!0});s=n.Ms;const o=[];t.targetChanges.forEach((i,a)=>{const c=s.get(a);if(!c)return;o.push(n.Pi.removeMatchingKeys(e,i.removedDocuments,a).next(()=>n.Pi.addMatchingKeys(e,i.addedDocuments,a)));let l=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?l=l.withResumeToken(lc.EMPTY_BYTE_STRING,Fa.min()).withLastLimboFreeSnapshotVersion(Fa.min()):i.resumeToken.approximateByteSize()>0&&(l=l.withResumeToken(i.resumeToken,r)),s=s.insert(a,l),function(e,t,n){if(0===e.resumeToken.approximateByteSize())return!0;if(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8)return!0;return n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(c,l,i)&&o.push(n.Pi.updateTargetData(e,l))});let a=jl(),c=Hl();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(function(e,t,n){let r=Hl(),s=Hl();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=jl();return n.forEach((n,i)=>{const o=e.get(n);i.isFoundDocument()!==o.isFoundDocument()&&(s=s.add(n)),i.isNoDocument()&&i.version.isEqual(Fa.min())?(t.removeEntry(n,i.readTime),r=r.insert(n,i)):!o.isValidDocument()||i.version.compareTo(o.version)>0||0===i.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(i),r=r.insert(n,i)):Yo(td,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",i.version)}),{ks:r,qs:s}})}(e,i,t.documentUpdates).next(e=>{a=e.ks,c=e.qs})),!r.isEqual(Fa.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next(t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return Wa.waitFor(o).next(()=>i.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,c)).next(()=>a)}).then(e=>(n.Ms=s,e))}function od(e,t){const n=ra(e);return n.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}async function ad(e,t,n){const r=ra(e),s=r.Ms.get(t),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,e=>r.persistence.referenceDelegate.removeTarget(e,s))}catch(o){if(!Ga(o))throw o;Yo(td,`Failed to update sequence numbers for target ${t}: ${o}`)}r.Ms=r.Ms.remove(t),r.xs.delete(s.target)}function cd(e,t,n){const r=ra(e);let s=Fa.min(),i=Hl();return r.persistence.runTransaction("Execute query","readwrite",e=>function(e,t,n){const r=ra(e),s=r.xs.get(n);return void 0!==s?Wa.resolve(r.Ms.get(s)):r.Pi.getTargetData(t,n)}(r,e,Il(t)).next(t=>{if(t)return s=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next(e=>{i=e})}).next(()=>r.Fs.getDocumentsMatchingQuery(e,t,n?s:Fa.min(),n?i:Hl())).next(e=>(function(e,t,n){let r=e.Os.get(t)||Fa.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Os.set(t,r)}(r,function(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}(t),e),{documents:e,Qs:i})))}class ld{constructor(){this.activeTargetIds=Wl}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class ud{constructor(){this.Mo=new ld,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new ld,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class hd{Oo(e){}shutdown(){}}const dd="ConnectivityMonitor";class fd{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){Yo(dd,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){Yo(dd,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let pd=null;function md(){return null===pd?pd=268435456+Math.round(2147483648*Math.random()):pd++,"0x"+pd.toString(16)}const gd="RestConnection",yd={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class vd{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Ec?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,s){const i=md(),o=this.zo(e,t.toUriEncodedString());Yo(gd,`Sending RPC '${e}' ${i}:`,o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,s);const{host:c}=new URL(o),l=Lt(c);return this.Jo(e,o,a,n,l).then(t=>(Yo(gd,`Received RPC '${e}' ${i}: `,t),t),t=>{throw Jo(gd,`RPC '${e}' ${i} failed with error: `,t,"url: ",o,"request:",n),t})}Ho(e,t,n,r,s,i){return this.Go(e,t,n,r,s)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Go,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}zo(e,t){const n=yd[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class wd{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const bd="WebChannelConnection";class _d extends vd{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,s){const i=md();return new Promise((s,o)=>{const a=new Po;a.setWithCredentials(!0),a.listenOnce(Mo.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case Vo.NO_ERROR:const t=a.getResponseJson();Yo(bd,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case Vo.TIMEOUT:Yo(bd,`RPC '${e}' ${i} timed out`),o(new ia(sa.DEADLINE_EXCEEDED,"Request time out"));break;case Vo.HTTP_ERROR:const n=a.getStatus();if(Yo(bd,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(sa).indexOf(t)>=0?t:sa.UNKNOWN}(t.status);o(new ia(e,t.message))}else o(new ia(sa.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ia(sa.UNAVAILABLE,"Connection failed."));break;default:ea(9055,{l_:e,streamId:i,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{Yo(bd,`RPC '${e}' ${i} completed.`)}});const c=JSON.stringify(r);Yo(bd,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",c,n,15)})}T_(e,t,n){const r=md(),s=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],i=zo(),o=Bo(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const l=s.join("");Yo(bd,`Creating RPC '${e}' stream ${r}: ${l}`,a);const u=i.createWebChannel(l,a);this.I_(u);let h=!1,d=!1;const f=new wd({Yo:t=>{d?Yo(bd,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(Yo(bd,`Opening RPC '${e}' stream ${r} transport.`),u.open(),h=!0),Yo(bd,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},Zo:()=>u.close()}),p=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(t){setTimeout(()=>{throw t},0)}})};return p(u,jo.EventType.OPEN,()=>{d||(Yo(bd,`RPC '${e}' stream ${r} transport opened.`),f.o_())}),p(u,jo.EventType.CLOSE,()=>{d||(d=!0,Yo(bd,`RPC '${e}' stream ${r} transport closed`),f.a_(),this.E_(u))}),p(u,jo.EventType.ERROR,t=>{d||(d=!0,Jo(bd,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),f.a_(new ia(sa.UNAVAILABLE,"The operation could not be completed")))}),p(u,jo.EventType.MESSAGE,t=>{if(!d){const n=t.data[0];na(!!n,16349);const s=n,i=s?.error||s[0]?.error;if(i){Yo(bd,`RPC '${e}' stream ${r} received error:`,i);const t=i.status;let n=function(e){const t=Au[e];if(void 0!==t)return Ru(t)}(t),s=i.message;void 0===n&&(n=sa.INTERNAL,s="Unknown error status: "+t+" with message "+i.message),d=!0,f.a_(new ia(n,s)),u.close()}else Yo(bd,`RPC '${e}' stream ${r} received:`,n),f.u_(n)}}),p(o,Fo.STAT_EVENT,t=>{t.stat===Uo.PROXY?Yo(bd,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Uo.NOPROXY&&Yo(bd,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{f.__()},0),f}terminate(){this.c_.forEach(e=>e.close()),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter(t=>t===e)}}function Ed(){return"undefined"!=typeof document?document:null}function Td(e){return new Qu(e,!0)}class xd{constructor(e,t,n=1e3,r=1.5,s=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=s,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&Yo("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,()=>(this.f_=Date.now(),e())),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const Id="PersistentStream";class Sd{constructor(e,t,n,r,s,i,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=s,this.authCredentialsProvider=i,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new xd(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,()=>this.k_()))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===sa.RESOURCE_EXHAUSTED?(Xo(t.toString()),Xo("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===sa.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.D_===t&&this.G_(e,n)},t=>{e(()=>{const e=new ia(sa.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)})})}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo(()=>{n(()=>this.listener.Xo())}),this.stream.t_(()=>{n(()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,()=>(this.O_()&&(this.state=3),Promise.resolve())),this.listener.t_()))}),this.stream.r_(e=>{n(()=>this.z_(e))}),this.stream.onMessage(e=>{n(()=>1==++this.F_?this.J_(e):this.onNext(e))})}N_(){this.state=5,this.M_.p_(async()=>{this.state=0,this.start()})}z_(e){return Yo(Id,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget(()=>this.D_===e?t():(Yo(Id,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Cd extends Sd{constructor(e,t,n,r,s,i){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const s="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:ea(39313,{state:r}),i=t.targetChange.targetIds||[],o=function(e,t){return e.useProto3Json?(na(void 0===t||"string"==typeof t,58123),lc.fromBase64String(t||"")):(na(void 0===t||t instanceof Buffer||t instanceof Uint8Array,16193),lc.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),a=t.targetChange.cause,c=a&&function(e){const t=void 0===e.code?sa.UNKNOWN:Ru(e.code);return new ia(t,e.message||"")}(a);n=new Bu(s,i,o,c||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const s=ih(e,r.document.name),i=eh(r.document.updateTime),o=r.document.createTime?eh(r.document.createTime):Fa.min(),a=new Hc({mapValue:{fields:r.document.fields}}),c=Gc.newFoundDocument(s,i,o,a),l=r.targetIds||[],u=r.removedTargetIds||[];n=new Uu(l,u,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const s=ih(e,r.document),i=r.readTime?eh(r.readTime):Fa.min(),o=Gc.newNoDocument(s,i),a=r.removedTargetIds||[];n=new Uu([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const s=ih(e,r.document),i=r.removedTargetIds||[];n=new Uu([],i,s,null)}else{if(!("filter"in t))return ea(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:s}=e,i=new ku(r,s),o=e.targetId;n=new Fu(o,i)}}var r;return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return Fa.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?Fa.min():t.readTime?eh(t.readTime):Fa.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=ah(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=wl(r)?{documents:uh(e,r)}:{query:hh(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Ju(e,t.resumeToken);const r=Yu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(Fa.min())>0){n.readTime=Xu(e,t.snapshotVersion.toTimestamp());const r=Yu(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return ea(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=ah(this.serializer),t.removeTarget=e,this.q_(t)}}class kd extends Sd{constructor(e,t,n,r,s,i){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,i),this.serializer=s}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return na(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,na(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){na(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(na(void 0!==t,14353),e.map(e=>function(e,t){let n=e.updateTime?eh(e.updateTime):eh(t);return n.isEqual(Fa.min())&&(n=eh(t)),new lu(n,e.transformResults||[])}(e,t))):[]}(e.writeResults,e.commitTime),n=eh(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=ah(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map(e=>function(e,t){let n;if(t instanceof vu)n={update:lh(e,t.key,t.value)};else if(t instanceof Tu)n={delete:sh(e,t.key)};else if(t instanceof wu)n={update:lh(e,t.key,t.data),updateMask:bh(t.fieldMask)};else{if(!(t instanceof xu))return ea(16599,{Vt:t.type});n={verify:sh(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map(e=>function(e,t){const n=t.transform;if(n instanceof eu)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof tu)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof ru)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof iu)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw ea(20930,{transform:t.transform})}(0,e))),t.precondition.isNone||(n.currentDocument=(r=e,void 0!==(s=t.precondition).updateTime?{updateTime:Zu(r,s.updateTime)}:void 0!==s.exists?{exists:s.exists}:ea(27497))),n;var r,s}(this.serializer,e))};this.q_(t)}}class Ad{}class Nd extends Ad{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new ia(sa.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,i])=>this.connection.Go(e,nh(t,n),r,s,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===sa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ia(sa.UNKNOWN,e.toString())})}Ho(e,t,n,r,s){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Ho(e,nh(t,n),r,i,o,s)).catch(e=>{throw"FirebaseError"===e.name?(e.code===sa.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ia(sa.UNKNOWN,e.toString())})}terminate(){this.ia=!0,this.connection.terminate()}}class Rd{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve())))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(Xo(t),this.aa=!1):Yo("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const Dd="RemoteStore";class Od{constructor(e,t,n,r,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=s,this.Aa.Oo(e=>{n.enqueueAndForget(async()=>{zd(this)&&(Yo(Dd,"Restarting streams for network reachability change."),await async function(e){const t=ra(e);t.Ea.add(4),await Pd(t),t.Ra.set("Unknown"),t.Ea.delete(4),await Ld(t)}(this))})}),this.Ra=new Rd(n,r)}}async function Ld(e){if(zd(e))for(const t of e.da)await t(!0)}async function Pd(e){for(const t of e.da)await t(!1)}function jd(e,t){const n=ra(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),Bd(n)?Fd(n):af(n).O_()&&Vd(n,t))}function Md(e,t){const n=ra(e),r=af(n);n.Ia.delete(t),r.O_()&&Ud(n,t),0===n.Ia.size&&(r.O_()?r.L_():zd(n)&&n.Ra.set("Unknown"))}function Vd(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(Fa.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}af(e).Y_(t)}function Ud(e,t){e.Va.Ue(t),af(e).Z_(t)}function Fd(e){e.Va=new $u({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),af(e).start(),e.Ra.ua()}function Bd(e){return zd(e)&&!af(e).x_()&&e.Ia.size>0}function zd(e){return 0===ra(e).Ea.size}function $d(e){e.Va=void 0}async function qd(e){e.Ra.set("Online")}async function Hd(e){e.Ia.forEach((t,n)=>{Vd(e,t)})}async function Wd(e,t){$d(e),Bd(e)?(e.Ra.ha(t),Fd(e)):e.Ra.set("Unknown")}async function Gd(e,t,n){if(e.Ra.set("Online"),t instanceof Bu&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(r){Yo(Dd,"Failed to remove targets %s: %s ",t.targetIds.join(","),r),await Kd(e,r)}else if(t instanceof Uu?e.Va.Ze(t):t instanceof Fu?e.Va.st(t):e.Va.tt(t),!n.isEqual(Fa.min()))try{const t=await sd(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const s=e.Ia.get(r);s&&e.Ia.set(r,s.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(lc.EMPTY_BYTE_STRING,r.snapshotVersion)),Ud(e,t);const s=new Eh(r.target,t,n,r.sequenceNumber);Vd(e,s)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(s){Yo(Dd,"Failed to raise snapshot:",s),await Kd(e,s)}}async function Kd(e,t,n){if(!Ga(t))throw t;e.Ea.add(1),await Pd(e),e.Ra.set("Offline"),n||(n=()=>sd(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{Yo(Dd,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await Ld(e)})}function Qd(e,t){return t().catch(n=>Kd(e,n,t))}async function Yd(e){const t=ra(e),n=cf(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:-1;for(;Xd(t);)try{const e=await od(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Jd(t,e)}catch(s){await Kd(t,s)}Zd(t)&&ef(t)}function Xd(e){return zd(e)&&e.Ta.length<10}function Jd(e,t){e.Ta.push(t);const n=cf(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Zd(e){return zd(e)&&!cf(e).x_()&&e.Ta.length>0}function ef(e){cf(e).start()}async function tf(e){cf(e).ra()}async function nf(e){const t=cf(e);for(const n of e.Ta)t.ea(n.mutations)}async function rf(e,t,n){const r=e.Ta.shift(),s=Su.from(r,t,n);await Qd(e,()=>e.remoteSyncer.applySuccessfulWrite(s)),await Yd(e)}async function sf(e,t){t&&cf(e).X_&&await async function(e,t){if(function(e){switch(e){case sa.OK:return ea(64938);case sa.CANCELLED:case sa.UNKNOWN:case sa.DEADLINE_EXCEEDED:case sa.RESOURCE_EXHAUSTED:case sa.INTERNAL:case sa.UNAVAILABLE:case sa.UNAUTHENTICATED:return!1;case sa.INVALID_ARGUMENT:case sa.NOT_FOUND:case sa.ALREADY_EXISTS:case sa.PERMISSION_DENIED:case sa.FAILED_PRECONDITION:case sa.ABORTED:case sa.OUT_OF_RANGE:case sa.UNIMPLEMENTED:case sa.DATA_LOSS:return!0;default:return ea(15467,{code:e})}}(n=t.code)&&n!==sa.ABORTED){const n=e.Ta.shift();cf(e).B_(),await Qd(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await Yd(e)}var n}(e,t),Zd(e)&&ef(e)}async function of(e,t){const n=ra(e);n.asyncQueue.verifyOperationInProgress(),Yo(Dd,"RemoteStore received new credentials");const r=zd(n);n.Ea.add(3),await Pd(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await Ld(n)}function af(e){return e.ma||(e.ma=function(e,t,n){const r=ra(e);return r.sa(),new Cd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:qd.bind(null,e),t_:Hd.bind(null,e),r_:Wd.bind(null,e),H_:Gd.bind(null,e)}),e.da.push(async t=>{t?(e.ma.B_(),Bd(e)?Fd(e):e.Ra.set("Unknown")):(await e.ma.stop(),$d(e))})),e.ma}function cf(e){return e.fa||(e.fa=function(e,t,n){const r=ra(e);return r.sa(),new kd(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:tf.bind(null,e),r_:sf.bind(null,e),ta:nf.bind(null,e),na:rf.bind(null,e)}),e.da.push(async t=>{t?(e.fa.B_(),await Yd(e)):(await e.fa.stop(),e.Ta.length>0&&(Yo(Dd,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))})),e.fa}class lf{constructor(e,t,n,r,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=s,this.deferred=new oa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,s){const i=Date.now()+n,o=new lf(e,t,i,r,s);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ia(sa.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function uf(e,t){if(Xo("AsyncQueue",`${t}: ${e}`),Ga(e))return new ia(sa.UNAVAILABLE,`${t}: ${e}`);throw e}class hf{static emptySet(e){return new hf(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||ka.comparator(t.key,n.key):(e,t)=>ka.comparator(e.key,t.key),this.keyedMap=Vl(),this.sortedSet=new nc(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof hf))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new hf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class df{constructor(){this.ga=new nc(ka.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):ea(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal((t,n)=>{e.push(n)}),e}}class ff{constructor(e,t,n,r,s,i,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=s,this.fromCache=i,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,s){const i=[];return t.forEach(e=>{i.push({type:0,doc:e})}),new ff(e,t,hf.emptySet(t),i,n,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&kl(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class pf{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some(e=>e.Da())}}class mf{constructor(){this.queries=gf(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=ra(e),r=n.queries;n.queries=gf(),r.forEach((e,n)=>{for(const r of n.Sa)r.onError(t)})}(this,new ia(sa.ABORTED,"Firestore shutting down"))}}function gf(){return new Ll(e=>Al(e),kl)}async function yf(e,t){const n=ra(e);let r=3;const s=t.query;let i=n.queries.get(s);i?!i.ba()&&t.Da()&&(r=2):(i=new pf,r=t.Da()?0:1);try{switch(r){case 0:i.wa=await n.onListen(s,!0);break;case 1:i.wa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const e=uf(o,`Initialization of query '${Nl(t.query)}' failed`);return void t.onError(e)}n.queries.set(s,i),i.Sa.push(t),t.va(n.onlineState),i.wa&&t.Fa(i.wa)&&_f(n)}async function vf(e,t){const n=ra(e),r=t.query;let s=3;const i=n.queries.get(r);if(i){const e=i.Sa.indexOf(t);e>=0&&(i.Sa.splice(e,1),0===i.Sa.length?s=t.Da()?0:1:!i.ba()&&t.Da()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function wf(e,t){const n=ra(e);let r=!1;for(const s of t){const e=s.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(s)&&(r=!0);t.wa=s}}r&&_f(n)}function bf(e,t,n){const r=ra(e),s=r.queries.get(t);if(s)for(const i of s.Sa)i.onError(n);r.queries.delete(t)}function _f(e){e.Ca.forEach(e=>{e.next()})}var Ef,Tf;(Tf=Ef||(Ef={})).Ma="default",Tf.Cache="cache";class xf{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new ff(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=ff.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==Ef.Cache}}class If{constructor(e){this.key=e}}class Sf{constructor(e){this.key=e}}class Cf{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=Hl(),this.mutatedKeys=Hl(),this.eu=Dl(e),this.tu=new hf(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new df,r=t?t.tu:this.tu;let s=t?t.mutatedKeys:this.mutatedKeys,i=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{const l=r.get(e),u=Rl(this.query,t)?t:null,h=!!l&&this.mutatedKeys.has(l.key),d=!!u&&(u.hasLocalMutations||this.mutatedKeys.has(u.key)&&u.hasCommittedMutations);let f=!1;l&&u?l.data.isEqual(u.data)?h!==d&&(n.track({type:3,doc:u}),f=!0):this.su(l,u)||(n.track({type:2,doc:u}),f=!0,(a&&this.eu(u,a)>0||c&&this.eu(u,c)<0)&&(o=!0)):!l&&u?(n.track({type:0,doc:u}),f=!0):l&&!u&&(n.track({type:1,doc:l}),f=!0,(a||c)&&(o=!0)),f&&(u?(i=i.add(u),s=d?s.add(e):s.delete(e)):(i=i.delete(e),s=s.delete(e)))}),null!==this.query.limit)for(;i.size>this.query.limit;){const e="F"===this.query.limitType?i.last():i.first();i=i.delete(e.key),s=s.delete(e.key),n.track({type:1,doc:e})}return{tu:i,iu:n,Cs:o,mutatedKeys:s}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const s=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const i=e.iu.ya();i.sort((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return ea(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc)),this.ou(n),r=r??!1;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,c=a!==this.Za;return this.Za=a,0!==i.length||c?{snapshot:new ff(this.query,e.tu,s,i,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new df,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach(e=>this.Ya=this.Ya.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ya=this.Ya.delete(e)),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=Hl(),this.tu.forEach(e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))});const t=[];return e.forEach(e=>{this.Xa.has(e)||t.push(new Sf(e))}),this.Xa.forEach(n=>{e.has(n)||t.push(new If(n))}),t}cu(e){this.Ya=e.Qs,this.Xa=Hl();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return ff.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const kf="SyncEngine";class Af{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class Nf{constructor(e){this.key=e,this.hu=!1}}class Rf{constructor(e,t,n,r,s,i){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=i,this.Pu={},this.Tu=new Ll(e=>Al(e),kl),this.Iu=new Map,this.Eu=new Set,this.du=new nc(ka.comparator),this.Au=new Map,this.Ru=new zh,this.Vu={},this.mu=new Map,this.fu=Nh.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function Df(e,t,n=!0){const r=Zf(e);let s;const i=r.Tu.get(t);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.lu()):s=await Lf(r,t,n,!0),s}async function Of(e,t){const n=Zf(e);await Lf(n,t,!0,!1)}async function Lf(e,t,n,r){const s=await function(e,t){const n=ra(e);return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Pi.getTargetData(e,t).next(s=>s?(r=s,Wa.resolve(r)):n.Pi.allocateTargetId(e).next(s=>(r=new Eh(t,s,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next(()=>r))))}).then(e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e})}(e.localStore,Il(t)),i=s.targetId,o=e.sharedClientState.addLocalQueryTarget(i,n);let a;return r&&(a=await async function(e,t,n,r,s){e.pu=(t,n,r)=>async function(e,t,n,r){let s=t.view.ru(n);s.Cs&&(s=await cd(e.localStore,t.query,!1).then(({documents:e})=>t.view.ru(e,s)));const i=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(s,e.isPrimaryClient,i,o);return Gf(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const i=await cd(e.localStore,t,!0),o=new Cf(t,i.Qs),a=o.ru(i.documents),c=Vu.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,s),l=o.applyChanges(a,e.isPrimaryClient,c);Gf(e,n,l.au);const u=new Af(t,n,o);return e.Tu.set(t,u),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),l.snapshot}(e,t,i,"current"===o,s.resumeToken)),e.isPrimaryClient&&n&&jd(e.remoteStore,s),a}async function Pf(e,t,n){const r=ra(e),s=r.Tu.get(t),i=r.Iu.get(s.targetId);if(i.length>1)return r.Iu.set(s.targetId,i.filter(e=>!kl(e,t))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await ad(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Md(r.remoteStore,s.targetId),Hf(r,s.targetId)}).catch(Ha)):(Hf(r,s.targetId),await ad(r.localStore,s.targetId,!0))}async function jf(e,t){const n=ra(e),r=n.Tu.get(t),s=n.Iu.get(r.targetId);n.isPrimaryClient&&1===s.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Md(n.remoteStore,r.targetId))}async function Mf(e,t,n){const r=function(e){const t=ra(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=Bf.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=zf.bind(null,t),t}(e);try{const e=await function(e,t){const n=ra(e),r=Ua.now(),s=t.reduce((e,t)=>e.add(t.key),Hl());let i,o;return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let a=jl(),c=Hl();return n.Ns.getEntries(e,s).next(e=>{a=e,a.forEach((e,t)=>{t.isValidDocument()||(c=c.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,a)).next(s=>{i=s;const o=[];for(const e of t){const t=gu(e,i.get(e.key).overlayedDocument);null!=t&&o.push(new wu(e.key,t,Wc(t.value.mapValue),uu.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)}).next(t=>{o=t;const r=t.applyToLocalDocumentSet(i,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)})}).then(()=>({batchId:o.batchId,changes:Ul(i)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new nc(ya)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Yf(r,e.changes),await Yd(r.remoteStore)}catch(s){const e=uf(s,"Failed to persist write");n.reject(e)}}async function Vf(e,t){const n=ra(e);try{const e=await id(n.localStore,t);t.targetChanges.forEach((e,t)=>{const r=n.Au.get(t);r&&(na(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?na(r.hu,14607):e.removedDocuments.size>0&&(na(r.hu,42227),r.hu=!1))}),await Yf(n,e,t)}catch(r){await Ha(r)}}function Uf(e,t,n){const r=ra(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach((n,r)=>{const s=r.view.va(t);s.snapshot&&e.push(s.snapshot)}),function(e,t){const n=ra(e);n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(const s of n.Sa)s.va(t)&&(r=!0)}),r&&_f(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function Ff(e,t,n){const r=ra(e);r.sharedClientState.updateQueryState(t,"rejected",n);const s=r.Au.get(t),i=s&&s.key;if(i){let e=new nc(ka.comparator);e=e.insert(i,Gc.newNoDocument(i,Fa.min()));const n=Hl().add(i),s=new Mu(Fa.min(),new Map,new nc(ya),e,n);await Vf(r,s),r.du=r.du.remove(i),r.Au.delete(t),Qf(r)}else await ad(r.localStore,t,!1).then(()=>Hf(r,t,n)).catch(Ha)}async function Bf(e,t){const n=ra(e),r=t.batch.batchId;try{const e=await function(e,t){const n=ra(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{const r=t.batch.keys(),s=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const s=n.batch,i=s.keys();let o=Wa.resolve();return i.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{const i=n.docVersions.get(e);na(null!==i,48541),t.version.compareTo(i)<0&&(s.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,s))}(n,e,t,s).next(()=>s.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Hl();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))})}(n.localStore,t);qf(n,r,null),$f(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Yf(n,e)}catch(s){await Ha(s)}}async function zf(e,t,n){const r=ra(e);try{const e=await function(e,t){const n=ra(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next(t=>(na(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t))).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r)).next(()=>n.localDocuments.getDocuments(e,r))})}(r.localStore,t);qf(r,t,n),$f(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Yf(r,e)}catch(s){await Ha(s)}}function $f(e,t){(e.mu.get(t)||[]).forEach(e=>{e.resolve()}),e.mu.delete(t)}function qf(e,t,n){const r=ra(e);let s=r.Vu[r.currentUser.toKey()];if(s){const e=s.get(t);e&&(n?e.reject(n):e.resolve(),s=s.remove(t)),r.Vu[r.currentUser.toKey()]=s}}function Hf(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach(t=>{e.Ru.containsKey(t)||Wf(e,t)})}function Wf(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(Md(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Qf(e))}function Gf(e,t,n){for(const r of n)r instanceof If?(e.Ru.addReference(r.key,t),Kf(e,r)):r instanceof Sf?(Yo(kf,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Wf(e,r.key)):ea(19791,{wu:r})}function Kf(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(Yo(kf,"New document in limbo: "+n),e.Eu.add(r),Qf(e))}function Qf(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new ka(Ia.fromString(t)),r=e.fu.next();e.Au.set(r,new Nf(n)),e.du=e.du.insert(n,r),jd(e.remoteStore,new Eh(Il(_l(n.path)),r,"TargetPurposeLimboResolution",Ka.ce))}}async function Yf(e,t,n){const r=ra(e),s=[],i=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach((e,a)=>{o.push(r.pu(a,t,n).then(e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,t?"current":"not-current")}if(e){s.push(e);const t=Jh.As(a.targetId,e);i.push(t)}}))}),await Promise.all(o),r.Pu.H_(s),await async function(e,t){const n=ra(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>Wa.forEach(t,t=>Wa.forEach(t.Es,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>Wa.forEach(t.ds,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(r){if(!Ga(r))throw r;Yo(td,"Failed to update sequence numbers: "+r)}for(const s of t){const e=s.targetId;if(!s.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,s=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,s)}}}(r.localStore,i))}async function Xf(e,t){const n=ra(e);if(!n.currentUser.isEqual(t)){Yo(kf,"User change. New user:",t.toKey());const e=await rd(n.localStore,t);n.currentUser=t,s="'waitForPendingWrites' promise is rejected due to a user change.",(r=n).mu.forEach(e=>{e.forEach(e=>{e.reject(new ia(sa.CANCELLED,s))})}),r.mu.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Yf(n,e.Ls)}var r,s}function Jf(e,t){const n=ra(e),r=n.Au.get(t);if(r&&r.hu)return Hl().add(r.key);{let e=Hl();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Zf(e){const t=ra(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=Vf.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Jf.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=Ff.bind(null,t),t.Pu.H_=wf.bind(null,t.eventManager),t.Pu.yu=bf.bind(null,t.eventManager),t}class ep{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Td(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return function(e,t,n,r){return new nd(e,t,n,r)}(this.persistence,new ed,e.initialUser,this.serializer)}Cu(e){return new Kh(Yh.mi,this.serializer)}Du(e){return new ud}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}ep.provider={build:()=>new ep};class tp extends ep{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){na(this.persistence.referenceDelegate instanceof Xh,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new Lh(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?Ah.withCacheSize(this.cacheSizeBytes):Ah.DEFAULT;return new Kh(e=>Xh.mi(e,t),this.serializer)}}class np{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>Uf(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Xf.bind(null,this.syncEngine),await async function(e,t){const n=ra(e);t?(n.Ea.delete(2),await Ld(n)):t||(n.Ea.add(2),await Pd(n),n.Ra.set("Unknown"))}(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new mf}createDatastore(e){const t=Td(e.databaseInfo.databaseId),n=(r=e.databaseInfo,new _d(r));var r;return function(e,t,n,r){return new Nd(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,s){return new Od(e,t,n,r,s)}(this.localStore,this.datastore,e.asyncQueue,e=>Uf(this.syncEngine,e,0),fd.v()?new fd:new hd)}createSyncEngine(e,t){return function(e,t,n,r,s,i,o){const a=new Rf(e,t,n,r,s,i);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=ra(e);Yo(Dd,"RemoteStore shutting down."),t.Ea.add(5),await Pd(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}np.provider={build:()=>new np};class rp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):Xo("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout(()=>{this.muted||e(t)},0)}}const sp="FirestoreClient";class ip{constructor(e,t,n,r,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Wo.UNAUTHENTICATED,this.clientId=ga.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async e=>{Yo(sp,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(Yo(sp,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(Ge){const n=uf(Ge,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function op(e,t){e.asyncQueue.verifyOperationInProgress(),Yo(sp,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await rd(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function ap(e,t){e.asyncQueue.verifyOperationInProgress();const n=await async function(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Yo(sp,"Using user provided OfflineComponentProvider");try{await op(e,e._uninitializedComponentsProvider._offline)}catch(t){const s=t;if(!("FirebaseError"===(n=s).name?n.code===sa.FAILED_PRECONDITION||n.code===sa.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&n instanceof DOMException)||22===n.code||20===n.code||11===n.code))throw s;Jo("Error using user provided cache. Falling back to memory cache: "+s),await op(e,new ep)}}else Yo(sp,"Using default OfflineComponentProvider"),await op(e,new tp(void 0));var n;return e._offlineComponents}(e);Yo(sp,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener(e=>of(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>of(t.remoteStore,n)),e._onlineComponents=t}async function cp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Yo(sp,"Using user provided OnlineComponentProvider"),await ap(e,e._uninitializedComponentsProvider._online)):(Yo(sp,"Using default OnlineComponentProvider"),await ap(e,new np))),e._onlineComponents}async function lp(e){const t=await cp(e),n=t.eventManager;return n.onListen=Df.bind(null,t.syncEngine),n.onUnlisten=Pf.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=Of.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=jf.bind(null,t.syncEngine),n}function up(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const hp=new Map,dp="firestore.googleapis.com",fp=!0;class pp{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new ia(sa.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=dp,this.ssl=fp}else this.host=e.host,this.ssl=e.ssl??fp;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=kh;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ia(sa.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new ia(sa.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=up(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ia(sa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ia(sa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ia(sa.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class mp{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new pp({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ia(sa.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ia(sa.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new pp(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new ca;switch(e.type){case"firstParty":return new da(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ia(sa.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=hp.get(e);t&&(Yo("ComponentProvider","Removing Datastore"),hp.delete(e),t.terminate())}(this),Promise.resolve()}}function gp(e,t,n,r={}){e=La(e,mp);const s=Lt(t),i=e._getSettings(),o={...i,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;s&&(Pt(`https://${a}`),Vt("Firestore",!0)),i.host!==dp&&i.host!==a&&Jo("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const c={...i,host:a,ssl:s,emulatorOptions:r};if(!qt(c,o)&&(e._setSettings(c),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Wo.MOCK_USER;else{t=function(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,s=e.sub||e.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const i={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e};return[St(JSON.stringify({alg:"none",type:"JWT"})),St(JSON.stringify(i)),""].join(".")}(r.mockUserToken,e._app?.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ia(sa.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Wo(s)}e._authCredentials=new la(new aa(t,n))}}class yp{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new yp(this.firestore,e,this._query)}}class vp{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new wp(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vp(this.firestore,e,this._key)}toJSON(){return{type:vp._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(ja(t,vp._jsonSchema))return new vp(e,n||null,new ka(Ia.fromString(t.referencePath)))}}vp._jsonSchemaVersion="firestore/documentReference/1.0",vp._jsonSchema={type:Pa("string",vp._jsonSchemaVersion),referencePath:Pa("string")};class wp extends yp{constructor(e,t,n){super(e,t,_l(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vp(this.firestore,null,new ka(e))}withConverter(e){return new wp(this.firestore,e,this._path)}}function bp(e,t,...n){if(e=Xt(e),Aa("collection","path",t),e instanceof mp){const r=Ia.fromString(t,...n);return Ra(r),new wp(e,null,r)}{if(!(e instanceof vp||e instanceof wp))throw new ia(sa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Ia.fromString(t,...n));return Ra(r),new wp(e.firestore,null,r)}}function _p(e,t,...n){if(e=Xt(e),1===arguments.length&&(t=ga.newId()),Aa("doc","path",t),e instanceof mp){const r=Ia.fromString(t,...n);return Na(r),new vp(e,null,new ka(r))}{if(!(e instanceof vp||e instanceof wp))throw new ia(sa.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(Ia.fromString(t,...n));return Na(r),new vp(e.firestore,e instanceof wp?e.converter:null,new ka(r))}}const Ep="AsyncQueue";class Tp{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new xd(this,"async_queue_retry"),this._c=()=>{const e=Ed();e&&Yo(Ep,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Ed();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Ed();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise(()=>{});const t=new oa;return this.cc(()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Xu.push(e),this.lc()))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(We){if(!Ga(We))throw We;Yo(Ep,"Operation failed with retryable error: "+We)}this.Xu.length>0&&this.M_.p_(()=>this.lc())}}cc(e){const t=this.ac.then(()=>(this.rc=!0,e().catch(e=>{throw this.nc=e,this.rc=!1,Xo("INTERNAL UNHANDLED ERROR: ",xp(e)),e}).then(e=>(this.rc=!1,e))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=lf.createAndSchedule(this,e,t,n,e=>this.hc(e));return this.tc.push(r),r}uc(){this.nc&&ea(47125,{Pc:xp(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then(()=>{this.tc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs);for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()})}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function xp(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function Ip(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Sp extends mp{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Tp,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Tp(e),this._firestoreClient=void 0,await e}}}function Cp(e){if(e._terminated)throw new ia(sa.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||function(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new _c(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,up(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new ip(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}(e),e._firestoreClient}class kp{constructor(e){this._byteString=e}static fromBase64String(e){try{return new kp(lc.fromBase64String(e))}catch(t){throw new ia(sa.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new kp(lc.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:kp._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(ja(e,kp._jsonSchema))return kp.fromBase64String(e.bytes)}}kp._jsonSchemaVersion="firestore/bytes/1.0",kp._jsonSchema={type:Pa("string",kp._jsonSchemaVersion),bytes:Pa("string")};class Ap{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new ia(sa.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ca(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Np{constructor(e){this._methodName=e}}class Rp{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ia(sa.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ia(sa.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return ya(this._lat,e._lat)||ya(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:Rp._jsonSchemaVersion}}static fromJSON(e){if(ja(e,Rp._jsonSchema))return new Rp(e.latitude,e.longitude)}}Rp._jsonSchemaVersion="firestore/geoPoint/1.0",Rp._jsonSchema={type:Pa("string",Rp._jsonSchemaVersion),latitude:Pa("number"),longitude:Pa("number")};class Dp{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Dp._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(ja(e,Dp._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new Dp(e.vectorValues);throw new ia(sa.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Dp._jsonSchemaVersion="firestore/vectorValue/1.0",Dp._jsonSchema={type:Pa("string",Dp._jsonSchemaVersion),vectorValues:Pa("object")};const Op=/^__.*__$/;class Lp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new wu(e,this.data,this.fieldMask,t,this.fieldTransforms):new vu(e,this.data,t,this.fieldTransforms)}}class Pp{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new wu(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function jp(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw ea(40011,{Ac:e})}}class Mp{constructor(e,t,n,r,s,i){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===s&&this.Rc(),this.fieldTransforms=s||[],this.fieldMask=i||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new Mp({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Yp(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(jp(this.Ac)&&Op.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class Vp{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Td(e)}Cc(e,t,n,r=!1){return new Mp({Ac:e,methodName:t,Dc:n,path:Ca.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Up(e){const t=e._freezeSettings(),n=Td(e._databaseId);return new Vp(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Fp(e,t,n,r,s,i={}){const o=e.Cc(i.merge||i.mergeFields?2:0,t,n,s);Wp("Data must be an object, but it was:",o,r);const a=qp(r,o);let c,l;if(i.merge)c=new ac(o.fieldMask),l=o.fieldTransforms;else if(i.mergeFields){const e=[];for(const r of i.mergeFields){const s=Gp(t,r,n);if(!o.contains(s))throw new ia(sa.INVALID_ARGUMENT,`Field '${s}' is specified in your field mask but missing from your input data.`);Xp(e,s)||e.push(s)}c=new ac(e),l=o.fieldTransforms.filter(e=>c.covers(e.field))}else c=null,l=o.fieldTransforms;return new Lp(new Hc(a),c,l)}class Bp extends Np{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bp}}class zp extends Np{_toFieldTransform(e){return new cu(e.path,new eu)}isEqual(e){return e instanceof zp}}function $p(e,t){if(Hp(e=Xt(e)))return Wp("Unsupported field value:",t,e),qp(e,t);if(e instanceof Np)return function(e,t){if(!jp(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const s of e){let e=$p(s,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Xt(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return Ql(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Ua.fromDate(e);return{timestampValue:Xu(t.serializer,n)}}if(e instanceof Ua){const n=new Ua(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Xu(t.serializer,n)}}if(e instanceof Rp)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof kp)return{bytesValue:Ju(t.serializer,e._byteString)};if(e instanceof vp){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:th(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof Dp)return n=e,r=t,{mapValue:{fields:{[xc]:{stringValue:Cc},[kc]:{arrayValue:{values:n.toArray().map(e=>{if("number"!=typeof e)throw r.Sc("VectorValues must only contain numeric values.");return Gl(r.serializer,e)})}}}}};var n,r;throw t.Sc(`Unsupported field value: ${Oa(e)}`)}(e,t)}function qp(e,t){const n={};return tc(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ec(e,(e,r)=>{const s=$p(r,t.mc(e));null!=s&&(n[e]=s)}),{mapValue:{fields:n}}}function Hp(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Ua||e instanceof Rp||e instanceof kp||e instanceof vp||e instanceof Np||e instanceof Dp)}function Wp(e,t,n){if(!Hp(n)||!Da(n)){const r=Oa(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Gp(e,t,n){if((t=Xt(t))instanceof Ap)return t._internalPath;if("string"==typeof t)return Qp(e,t);throw Yp("Field path arguments must be of type string or ",e,!1,void 0,n)}const Kp=new RegExp("[~\\*/\\[\\]]");function Qp(e,t,n){if(t.search(Kp)>=0)throw Yp(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Ap(...t.split("."))._internalPath}catch(Ke){throw Yp(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Yp(e,t,n,r,s){const i=r&&!r.isEmpty(),o=void 0!==s;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new ia(sa.INVALID_ARGUMENT,a+e+c)}function Xp(e,t){return e.some(e=>e.isEqual(t))}class Jp{constructor(e,t,n,r,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new vp(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Zp(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(em("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Zp extends Jp{data(){return super.data()}}function em(e,t){return"string"==typeof t?Qp(e,t):t instanceof Ap?t._internalPath:t._delegate._internalPath}class tm{}class nm extends tm{}function rm(e,t,...n){let r=[];t instanceof tm&&r.push(t),r=r.concat(n),function(e){const t=e.filter(e=>e instanceof im).length,n=e.filter(e=>e instanceof sm).length;if(t>1||t>0&&n>0)throw new ia(sa.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)e=s._apply(e);return e}class sm extends nm{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new sm(e,t,n)}_apply(e){const t=this._parse(e);return um(e._query,t),new yp(e.firestore,e.converter,Sl(e._query,t))}_parse(e){const t=Up(e.firestore),n=function(e,t,n,r,s,i,o){let a;if(s.isKeyField()){if("array-contains"===i||"array-contains-any"===i)throw new ia(sa.INVALID_ARGUMENT,`Invalid Query. You can't perform '${i}' queries on documentId().`);if("in"===i||"not-in"===i){lm(o,i);const t=[];for(const n of o)t.push(cm(r,e,n));a={arrayValue:{values:t}}}else a=cm(r,e,o)}else"in"!==i&&"not-in"!==i&&"array-contains-any"!==i||lm(o,i),a=function(e,t,n,r=!1){return $p(n,e.Cc(r?4:3,t))}(n,t,o,"in"===i||"not-in"===i);return el.create(s,i,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class im extends tm{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new im(e,t)}_parse(e){const t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:tl.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const s of r)um(n,s),n=Sl(n,s)}(e._query,t),new yp(e.firestore,e.converter,Sl(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class om extends nm{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new om(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ia(sa.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ia(sa.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Xc(t,n)}(e._query,this._field,this._direction);return new yp(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new bl(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function am(e,t="asc"){const n=t,r=em("orderBy",e);return om._create(r,n)}function cm(e,t,n){if("string"==typeof(n=Xt(n))){if(""===n)throw new ia(sa.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Tl(t)&&-1!==n.indexOf("/"))throw new ia(sa.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(Ia.fromString(n));if(!ka.isDocumentKey(r))throw new ia(sa.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Vc(e,new ka(r))}if(n instanceof vp)return Vc(e,n._key);throw new ia(sa.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Oa(n)}.`)}function lm(e,t){if(!Array.isArray(e)||0===e.length)throw new ia(sa.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function um(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ia(sa.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ia(sa.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class hm{convertValue(e,t="none"){switch(Ac(e)){case 0:return null;case 1:return e.booleanValue;case 2:return dc(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(fc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw ea(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ec(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertVectorValue(e){const t=e.fields?.[kc].arrayValue?.values?.map(e=>dc(e.doubleValue));return new Dp(t)}convertGeoPoint(e){return new Rp(dc(e.latitude),dc(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=wc(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(bc(e));default:return null}}convertTimestamp(e){const t=hc(e);return new Ua(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Ia.fromString(e);na(_h(n),9688,{name:e});const r=new Tc(n.get(1),n.get(3)),s=new ka(n.popFirst(5));return r.isEqual(t)||Xo(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}function dm(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class fm{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class pm extends Jp{constructor(e,t,n,r,s,i){super(e,t,n,r,i),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new mm(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(em("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ia(sa.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=pm._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}pm._jsonSchemaVersion="firestore/documentSnapshot/1.0",pm._jsonSchema={type:Pa("string",pm._jsonSchemaVersion),bundleSource:Pa("string","DocumentSnapshot"),bundleName:Pa("string"),bundle:Pa("string")};class mm extends pm{data(e={}){return super.data(e)}}class gm{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new fm(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new mm(this._firestore,this._userDataWriter,n.key,n,new fm(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new ia(sa.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{const r=new mm(e._firestore,e._userDataWriter,n.doc.key,n.doc,new fm(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{const r=new mm(e._firestore,e._userDataWriter,t.doc.key,t.doc,new fm(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let s=-1,i=-1;return 0!==t.type&&(s=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),i=n.indexOf(t.doc.key)),{type:ym(t.type),doc:r,oldIndex:s,newIndex:i}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ia(sa.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=gm._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ga.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach(e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function ym(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return ea(61501,{type:e})}}function vm(e){e=La(e,vp);const t=La(e.firestore,Sp);return function(e,t,n={}){const r=new oa;return e.asyncQueue.enqueueAndForget(async()=>function(e,t,n,r,s){const i=new rp({next:a=>{i.Nu(),t.enqueueAndForget(()=>vf(e,o));const c=a.docs.has(n);!c&&a.fromCache?s.reject(new ia(sa.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&"server"===r.source?s.reject(new ia(sa.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):s.resolve(a)},error:e=>s.reject(e)}),o=new xf(_l(n.path),i,{includeMetadataChanges:!0,qa:!0});return yf(e,o)}(await lp(e),e.asyncQueue,t,n,r)),r.promise}(Cp(t),e._key).then(n=>xm(t,e,n))}gm._jsonSchemaVersion="firestore/querySnapshot/1.0",gm._jsonSchema={type:Pa("string",gm._jsonSchemaVersion),bundleSource:Pa("string","QuerySnapshot"),bundleName:Pa("string"),bundle:Pa("string")};class wm extends hm{constructor(e){super(),this.firestore=e}convertBytes(e){return new kp(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vp(this.firestore,null,t)}}function bm(e,t,n,...r){e=La(e,vp);const s=La(e.firestore,Sp),i=Up(s);let o;return o="string"==typeof(t=Xt(t))||t instanceof Ap?function(e,t,n,r,s,i){const o=e.Cc(1,t,n),a=[Gp(t,r,n)],c=[s];if(i.length%2!=0)throw new ia(sa.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<i.length;d+=2)a.push(Gp(t,i[d])),c.push(i[d+1]);const l=[],u=Hc.empty();for(let d=a.length-1;d>=0;--d)if(!Xp(l,a[d])){const e=a[d];let t=c[d];t=Xt(t);const n=o.yc(e);if(t instanceof Bp)l.push(e);else{const r=$p(t,n);null!=r&&(l.push(e),u.set(e,r))}}const h=new ac(l);return new Pp(u,h,o.fieldTransforms)}(i,"updateDoc",e._key,t,n,r):function(e,t,n,r){const s=e.Cc(1,t,n);Wp("Data must be an object, but it was:",s,r);const i=[],o=Hc.empty();ec(r,(e,r)=>{const a=Qp(t,e,n);r=Xt(r);const c=s.yc(a);if(r instanceof Bp)i.push(a);else{const e=$p(r,c);null!=e&&(i.push(a),o.set(a,e))}});const a=new ac(i);return new Pp(o,a,s.fieldTransforms)}(i,"updateDoc",e._key,t),Tm(s,[o.toMutation(e._key,uu.exists(!0))])}function _m(e,t){const n=La(e.firestore,Sp),r=_p(e),s=dm(e.converter,t);return Tm(n,[Fp(Up(e.firestore),"addDoc",r._key,s,null!==e.converter,{}).toMutation(r._key,uu.exists(!1))]).then(()=>r)}function Em(e,...t){e=Xt(e);let n={includeMetadataChanges:!1,source:"default"},r=0;"object"!=typeof t[r]||Ip(t[r])||(n=t[r++]);const s={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(Ip(t[r])){const e=t[r];t[r]=e.next?.bind(e),t[r+1]=e.error?.bind(e),t[r+2]=e.complete?.bind(e)}let i,o,a;if(e instanceof vp)o=La(e.firestore,Sp),a=_l(e._key.path),i={next:n=>{t[r]&&t[r](xm(o,e,n))},error:t[r+1],complete:t[r+2]};else{const n=La(e,yp);o=La(n.firestore,Sp),a=n._query;const s=new wm(o);i={next:e=>{t[r]&&t[r](new gm(o,s,n,e))},error:t[r+1],complete:t[r+2]},function(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ia(sa.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}(e._query)}return function(e,t,n,r){const s=new rp(r),i=new xf(t,s,n);return e.asyncQueue.enqueueAndForget(async()=>yf(await lp(e),i)),()=>{s.Nu(),e.asyncQueue.enqueueAndForget(async()=>vf(await lp(e),i))}}(Cp(o),a,s,i)}function Tm(e,t){return function(e,t){const n=new oa;return e.asyncQueue.enqueueAndForget(async()=>Mf(await function(e){return cp(e).then(e=>e.syncEngine)}(e),t,n)),n.promise}(Cp(e),t)}function xm(e,t,n){const r=n.docs.get(t._key),s=new wm(e);return new pm(e,s,t._key,r,new fm(n.hasPendingWrites,n.fromCache),t.converter)}function Im(){return new zp("serverTimestamp")}!function(e,t=!0){Go=fr,cr(new Jt("firestore",(e,{instanceIdentifier:n,options:r})=>{const s=e.getProvider("app").getImmediate(),i=new Sp(new ua(e.getProvider("auth-internal")),new pa(s,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ia(sa.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Tc(e.options.projectId,t)}(s,n),s);return r={useFetchStreams:t,...r},i._setSettings(r),i},"PUBLIC").setMultipleInstances(!0)),gr(qo,Ho,e),gr(qo,Ho,"esm2020")}();const Sm={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_FIREBASE_API_KEY:"AIzaSyBTKjtlYt9xqwXxHPhej4gL8JbKviX5k0Q",VITE_FIREBASE_APP_ID:"1:731775638731:web:fddaeabf885a4fa580cf4e",VITE_FIREBASE_AUTH_DOMAIN:"acbf-rsa-backend.firebaseapp.com",VITE_FIREBASE_MESSAGING_SENDER_ID:"731775638731",VITE_FIREBASE_PROJECT_ID:"acbf-rsa-backend",VITE_FIREBASE_STORAGE_BUCKET:"acbf-rsa-backend.firebasestorage.app"},Cm=["VITE_FIREBASE_API_KEY","VITE_FIREBASE_AUTH_DOMAIN","VITE_FIREBASE_PROJECT_ID","VITE_FIREBASE_STORAGE_BUCKET","VITE_FIREBASE_MESSAGING_SENDER_ID","VITE_FIREBASE_APP_ID"];for(const Vy of Cm)if(!Sm[Vy])throw new Error(`Missing env.${Vy}`);const km=pr({apiKey:"AIzaSyBTKjtlYt9xqwXxHPhej4gL8JbKviX5k0Q",authDomain:"acbf-rsa-backend.firebaseapp.com",projectId:"acbf-rsa-backend",storageBucket:"acbf-rsa-backend.firebasestorage.app",messagingSenderId:"731775638731",appId:"1:731775638731:web:fddaeabf885a4fa580cf4e"}),Am=function(e){const t="object"==typeof e?e:mr(),n="string"==typeof e?e:Ec,r=lr(t,"firestore").getImmediate({identifier:n});if(!r._initialized){const e=(e=>{const t=Nt(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]})("firestore");e&&gp(r,...e)}return r}(km),Nm=function(e=mr()){const t=lr(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=lr(e,"auth");if(n.isInitialized()){const e=n.getImmediate();if(qt(n.getOptions(),t??{}))return e;Dr(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:xo,persistence:[Fi,Ti,Ii]}),r=Dt("authTokenSyncURL");if(r&&"boolean"==typeof isSecureContext&&isSecureContext){const e=new URL(r,location.origin);if(location.origin===e.origin){const t=(s=e.toString(),async e=>{const t=e&&await e.getIdTokenResult(),n=t&&((new Date).getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>ko)return;const r=t?.token;Ao!==r&&(Ao=r,await fetch(s,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))});!function(e,t,n){Xt(e).beforeAuthStateChanged(t,n)}(n,t,()=>t(n.currentUser)),function(e,t,n,r){Xt(e).onIdTokenChanged(t,n,r)}(n,e=>t(e))}}var s;const i=Nt("auth");return i&&Qs(n,`http://${i}`),n}(km),Rm=i.createContext();function Dm({children:t}){const[n,r]=i.useState(null),[s,o]=i.useState(!0),[a,c]=i.useState(null);i.useEffect(()=>{const e=function(e,t,n,r){return Xt(e).onAuthStateChanged(t,n,r)}(Nm,e=>{r(e),o(!1),c(null)},e=>{c(e.message),o(!1),r(null)});return()=>e()},[]);const l={currentUser:n,login:async(e,t)=>{try{c(null),o(!0);return(await wi(Nm,e,t)).user}catch(n){throw c(n.message),n}finally{o(!1)}},logout:async()=>{try{c(null),await(e=Nm,Xt(e).signOut())}catch(t){throw c(t.message),t}var e},loading:s,error:a};return e.jsx(Rm.Provider,{value:l,children:t})}function Om(){const e=i.useContext(Rm);if(!e)throw new Error("useAuth must be used within an AuthProvider");return e}var Lm={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},Pm=o.createContext&&o.createContext(Lm),jm=["attr","size","title"];function Mm(e,t){if(null==e)return{};var n,r,s=function(e,t){if(null==e)return{};var n={};for(var r in e)if(Object.prototype.hasOwnProperty.call(e,r)){if(t.indexOf(r)>=0)continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}function Vm(){return Vm=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Vm.apply(this,arguments)}function Um(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function Fm(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Um(Object(n),!0).forEach(function(t){Bm(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Um(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function Bm(e,t,n){return t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t);if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function zm(e){return e&&e.map((e,t)=>o.createElement(e.tag,Fm({key:t},e.attr),zm(e.child)))}function $m(e){return t=>o.createElement(qm,Vm({attr:Fm({},e.attr)},t),zm(e.child))}function qm(e){var t=t=>{var n,{attr:r,size:s,title:i}=e,a=Mm(e,jm),c=s||t.size||"1em";return t.className&&(n=t.className),e.className&&(n=(n?n+" ":"")+e.className),o.createElement("svg",Vm({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,r,a,{className:n,style:Fm(Fm({color:e.color||t.color},t.style),e.style),height:c,width:c,xmlns:"http://www.w3.org/2000/svg"}),i&&o.createElement("title",null,i),e.children)};return void 0!==Pm?o.createElement(Pm.Consumer,null,e=>t(e)):t(Lm)}function Hm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function Wm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.083 9h1.946c.089-1.546.383-2.97.837-4.118A6.004 6.004 0 004.083 9zM10 2a8 8 0 100 16 8 8 0 000-16zm0 2c-.076 0-.232.032-.465.262-.238.234-.497.623-.737 1.182-.389.907-.673 2.142-.766 3.556h3.936c-.093-1.414-.377-2.649-.766-3.556-.24-.56-.5-.948-.737-1.182C10.232 4.032 10.076 4 10 4zm3.971 5c-.089-1.546-.383-2.97-.837-4.118A6.004 6.004 0 0115.917 9h-1.946zm-2.003 2H8.032c.093 1.414.377 2.649.766 3.556.24.56.5.948.737 1.182.233.23.389.262.465.262.076 0 .232-.032.465-.262.238-.234.498-.623.737-1.182.389-.907.673-2.142.766-3.556zm1.166 4.118c.454-1.147.748-2.572.837-4.118h1.946a6.004 6.004 0 01-2.783 4.118zm-6.268 0C6.412 13.97 6.118 12.546 6.03 11H4.083a6.004 6.004 0 002.783 4.118z",clipRule:"evenodd"},child:[]}]})(e)}function Gm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z",clipRule:"evenodd"},child:[]}]})(e)}function Km(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M11 3a1 1 0 10-2 0v1a1 1 0 102 0V3zM15.657 5.757a1 1 0 00-1.414-1.414l-.707.707a1 1 0 001.414 1.414l.707-.707zM18 10a1 1 0 01-1 1h-1a1 1 0 110-2h1a1 1 0 011 1zM5.05 6.464A1 1 0 106.464 5.05l-.707-.707a1 1 0 00-1.414 1.414l.707.707zM5 10a1 1 0 01-1 1H3a1 1 0 110-2h1a1 1 0 011 1zM8 16v-1h4v1a2 2 0 11-4 0zM12 14c.015-.34.208-.646.477-.859a4 4 0 10-4.954 0c.27.213.462.519.476.859h4.002z"},child:[]}]})(e)}function Qm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"},child:[]}]})(e)}function Ym(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M2.003 5.884L10 9.882l7.997-3.998A2 2 0 0016 4H4a2 2 0 00-1.997 1.884z"},child:[]},{tag:"path",attr:{d:"M18 8.118l-8 4-8-4V14a2 2 0 002 2h12a2 2 0 002-2V8.118z"},child:[]}]})(e)}function Xm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M3 5a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 10a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zM3 15a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z",clipRule:"evenodd"},child:[]}]})(e)}function Jm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm.008 9.057a1 1 0 011.276.61A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 01.61-1.276z",clipRule:"evenodd"},child:[]}]})(e)}function Zm(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"},child:[]}]})(e)}function eg(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{d:"M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"},child:[]}]})(e)}function tg(e){return $m({attr:{viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"},child:[]}]})(e)}function ng(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"22 12 18 12 15 21 9 3 6 12 2 12"},child:[]}]})(e)}function rg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12.01",y2:"16"},child:[]}]})(e)}function sg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"21 8 21 21 3 21 3 8"},child:[]},{tag:"rect",attr:{x:"1",y:"3",width:"22",height:"5"},child:[]},{tag:"line",attr:{x1:"10",y1:"12",x2:"14",y2:"12"},child:[]}]})(e)}function ig(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"19",y1:"12",x2:"5",y2:"12"},child:[]},{tag:"polyline",attr:{points:"12 19 5 12 12 5"},child:[]}]})(e)}function og(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"19",x2:"12",y2:"5"},child:[]},{tag:"polyline",attr:{points:"5 12 12 5 19 12"},child:[]}]})(e)}function ag(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"8",r:"7"},child:[]},{tag:"polyline",attr:{points:"8.21 13.89 7 23 12 20 17 23 15.79 13.88"},child:[]}]})(e)}function cg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 19.5A2.5 2.5 0 0 1 6.5 17H20"},child:[]},{tag:"path",attr:{d:"M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"},child:[]}]})(e)}function lg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"2",y:"7",width:"20",height:"14",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"},child:[]}]})(e)}function ug(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"4",width:"18",height:"18",rx:"2",ry:"2"},child:[]},{tag:"line",attr:{x1:"16",y1:"2",x2:"16",y2:"6"},child:[]},{tag:"line",attr:{x1:"8",y1:"2",x2:"8",y2:"6"},child:[]},{tag:"line",attr:{x1:"3",y1:"10",x2:"21",y2:"10"},child:[]}]})(e)}function hg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},child:[]},{tag:"polyline",attr:{points:"22 4 12 14.01 9 11.01"},child:[]}]})(e)}function dg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"9 18 15 12 9 6"},child:[]}]})(e)}function fg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"},child:[]},{tag:"polyline",attr:{points:"7 10 12 15 17 10"},child:[]},{tag:"line",attr:{x1:"12",y1:"15",x2:"12",y2:"3"},child:[]}]})(e)}function pg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"},child:[]},{tag:"polyline",attr:{points:"15 3 21 3 21 9"},child:[]},{tag:"line",attr:{x1:"10",y1:"14",x2:"21",y2:"3"},child:[]}]})(e)}function mg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z"},child:[]}]})(e)}function gg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"},child:[]},{tag:"polyline",attr:{points:"14 2 14 8 20 8"},child:[]},{tag:"line",attr:{x1:"16",y1:"13",x2:"8",y2:"13"},child:[]},{tag:"line",attr:{x1:"16",y1:"17",x2:"8",y2:"17"},child:[]},{tag:"polyline",attr:{points:"10 9 9 9 8 9"},child:[]}]})(e)}function yg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"},child:[]}]})(e)}function vg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"path",attr:{d:"M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"},child:[]}]})(e)}function wg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"},child:[]},{tag:"polyline",attr:{points:"9 22 9 12 15 12 15 22"},child:[]}]})(e)}function bg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"12",y1:"16",x2:"12",y2:"12"},child:[]},{tag:"line",attr:{x1:"12",y1:"8",x2:"12.01",y2:"8"},child:[]}]})(e)}function _g(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"},child:[]}]})(e)}function Eg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"},child:[]},{tag:"rect",attr:{x:"2",y:"9",width:"4",height:"12"},child:[]},{tag:"circle",attr:{cx:"4",cy:"4",r:"2"},child:[]}]})(e)}function Tg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"2",x2:"12",y2:"6"},child:[]},{tag:"line",attr:{x1:"12",y1:"18",x2:"12",y2:"22"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"4.93",x2:"7.76",y2:"7.76"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"16.24",x2:"19.07",y2:"19.07"},child:[]},{tag:"line",attr:{x1:"2",y1:"12",x2:"6",y2:"12"},child:[]},{tag:"line",attr:{x1:"18",y1:"12",x2:"22",y2:"12"},child:[]},{tag:"line",attr:{x1:"4.93",y1:"19.07",x2:"7.76",y2:"16.24"},child:[]},{tag:"line",attr:{x1:"16.24",y1:"7.76",x2:"19.07",y2:"4.93"},child:[]}]})(e)}function xg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"rect",attr:{x:"3",y:"11",width:"18",height:"11",rx:"2",ry:"2"},child:[]},{tag:"path",attr:{d:"M7 11V7a5 5 0 0 1 10 0v4"},child:[]}]})(e)}function Ig(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"},child:[]},{tag:"polyline",attr:{points:"16 17 21 12 16 7"},child:[]},{tag:"line",attr:{x1:"21",y1:"12",x2:"9",y2:"12"},child:[]}]})(e)}function Sg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"},child:[]},{tag:"polyline",attr:{points:"22,6 12,13 2,6"},child:[]}]})(e)}function Cg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"},child:[]},{tag:"circle",attr:{cx:"12",cy:"10",r:"3"},child:[]}]})(e)}function kg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"},child:[]}]})(e)}function Ag(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"},child:[]}]})(e)}function Ng(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"polyline",attr:{points:"1 20 1 14 7 14"},child:[]},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"},child:[]}]})(e)}function Rg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"},child:[]},{tag:"path",attr:{d:"M20.49 15a9 9 0 1 1-2.12-9.36L23 10"},child:[]}]})(e)}function Dg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"},child:[]},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"},child:[]},{tag:"polyline",attr:{points:"7 3 7 8 15 8"},child:[]}]})(e)}function Og(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"11",cy:"11",r:"8"},child:[]},{tag:"line",attr:{x1:"21",y1:"21",x2:"16.65",y2:"16.65"},child:[]}]})(e)}function Lg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"22",y1:"2",x2:"11",y2:"13"},child:[]},{tag:"polygon",attr:{points:"22 2 15 22 11 13 2 9 22 2"},child:[]}]})(e)}function Pg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"},child:[]}]})(e)}function jg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"6"},child:[]},{tag:"circle",attr:{cx:"12",cy:"12",r:"2"},child:[]}]})(e)}function Mg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"},child:[]},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"},child:[]},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"},child:[]},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"},child:[]}]})(e)}function Vg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 6 13.5 15.5 8.5 10.5 1 18"},child:[]},{tag:"polyline",attr:{points:"17 6 23 6 23 12"},child:[]}]})(e)}function Ug(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"},child:[]}]})(e)}function Fg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M16 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"8.5",cy:"7",r:"4"},child:[]},{tag:"polyline",attr:{points:"17 11 19 13 23 9"},child:[]}]})(e)}function Bg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"12",cy:"7",r:"4"},child:[]}]})(e)}function zg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"},child:[]},{tag:"circle",attr:{cx:"9",cy:"7",r:"4"},child:[]},{tag:"path",attr:{d:"M23 21v-2a4 4 0 0 0-3-3.87"},child:[]},{tag:"path",attr:{d:"M16 3.13a4 4 0 0 1 0 7.75"},child:[]}]})(e)}function $g(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"10"},child:[]},{tag:"line",attr:{x1:"15",y1:"9",x2:"9",y2:"15"},child:[]},{tag:"line",attr:{x1:"9",y1:"9",x2:"15",y2:"15"},child:[]}]})(e)}function qg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(e)}function Hg(e){return $m({attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polygon",attr:{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"},child:[]}]})(e)}const Wg={main:[{label:"Home",url:"/",children:[]},{label:"About",url:"/about",children:[]},{label:"Posts & Events",url:"/blog",children:[]},{label:"Members",url:"/members",children:[]},{label:"Contact",url:"/contact",children:[]},{label:"Becoming a Member",url:"/becoming-a-member",children:[]}],footer:[{label:"Privacy Policy",url:"/privacy"},{label:"Terms of Service",url:"/terms"}]},Gg={siteName:"ACBF RSA",siteDescription:"ACBF RSA Website",logo:"/assets/images/logos/acbf logos/acbf-logo-header.png",socialMedia:{facebook:"",twitter:"",instagram:"",linkedin:""}};function Kg({children:t,variant:n="primary",size:r="md",fullWidth:s=!1,className:i="",onClick:o,type:a="button",disabled:c=!1,...l}){const u={primary:"bg-primary text-white hover:bg-primary/90 focus:ring-primary",secondary:"bg-secondary text-white hover:bg-secondary/90 focus:ring-secondary",outline:"border-2 border-primary text-primary hover:bg-primary hover:text-white focus:ring-primary",ghost:"text-gray-700 hover:bg-gray-100 focus:ring-gray-500"},h={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-base",lg:"px-6 py-3 text-lg"},d=`\n    inline-flex items-center justify-center font-medium rounded-lg transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed\n    ${u[n]||u.primary}\n    ${h[r]||h.md}\n    ${s?"w-full":""}\n    ${i}\n  `.trim().replace(/\s+/g," ");return e.jsx("button",{type:a,className:d,onClick:o,disabled:c,...l,children:t})}function Qg({size:t="md",className:n="",text:r="",fullScreen:s=!1,...i}){const o={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"},a=`\n    ${o[t]||o.md}\n    animate-spin\n    text-primary\n  `.trim().replace(/\s+/g," ");return s?e.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-75 flex items-center justify-center z-50",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jm,{className:`${a} mx-auto`}),r&&e.jsx("p",{className:"mt-4 text-gray-600",children:r})]})}):e.jsx("div",{className:`flex items-center justify-center ${n}`,...i,children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jm,{className:a}),r&&e.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:r})]})})}function Yg({src:t,alt:n,className:r="",width:s,height:o,lazy:a=!0,placeholder:c,...l}){const[u,h]=i.useState(!1),[d,f]=i.useState(!1);return d&&c?e.jsx("img",{src:c,alt:n,className:r,width:s,height:o,...l}):e.jsxs("div",{className:`relative overflow-hidden ${r}`,children:[!u&&e.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse"}),e.jsx("img",{src:t,alt:n,width:s,height:o,loading:a?"lazy":"eager",onLoad:()=>{h(!0)},onError:()=>{f(!0),h(!0)},className:`\n          transition-opacity duration-300\n          ${u?"opacity-100":"opacity-0"}\n          ${r}\n        `.trim().replace(/\s+/g," "),...l})]})}class Xg extends i.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){this.setState({error:e,errorInfo:t})}handleReset=()=>{this.setState({hasError:!1,error:null,errorInfo:null}),window.location.reload()};render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-2xl w-full text-center",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(rg,{className:"w-24 h-24 text-red-500 mx-auto mb-4"}),e.jsx("h1",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Something went wrong"}),e.jsx("p",{className:"text-lg text-gray-600 mb-8",children:"We're sorry, but something unexpected happened. Please try refreshing the page or return to the homepage."})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[e.jsxs(Kg,{variant:"primary",onClick:this.handleReset,className:"flex items-center justify-center gap-2",children:[e.jsx(Ng,{}),"Refresh Page"]}),e.jsx(a,{to:"/",children:e.jsxs(Kg,{variant:"outline",className:"flex items-center justify-center gap-2 w-full sm:w-auto",children:[e.jsx(wg,{}),"Go Home"]})})]}),!1]})}):this.props.children}}function Jg(){const[r,s]=i.useState(!1);i.useEffect(()=>{const e=()=>{window.pageYOffset>300?s(!0):s(!1)};return window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e)}},[]);return e.jsx(t,{children:r&&e.jsx(n.button,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},className:"fixed bottom-8 right-8 z-50 bg-primary text-white p-3 rounded-full shadow-lg hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition-all duration-200","aria-label":"Back to top",children:e.jsx(og,{className:"w-6 h-6"})})})}function Zg(){const{pathname:e}=c();return i.useEffect(()=>{window.scrollTo({top:0,left:0,behavior:"instant"})},[e]),null}function ey({isOpen:r,onClose:s,children:o,title:a,className:c="",size:l="md"}){i.useEffect(()=>{const e=e=>{"Escape"===e.key&&r&&s()};return r&&(document.addEventListener("keydown",e),document.body.style.overflow="hidden"),()=>{document.removeEventListener("keydown",e),document.body.style.overflow="unset"}},[r,s]);return e.jsx(t,{children:r&&e.jsxs(e.Fragment,{children:[e.jsx(n.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:"fixed inset-0 bg-black/50 backdrop-blur-sm z-50",onClick:s}),e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 pointer-events-none",children:e.jsxs(n.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:`bg-white rounded-xl shadow-2xl w-full ${{sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[l]} pointer-events-auto max-h-[90vh] flex flex-col ${c}`,onClick:e=>e.stopPropagation(),children:[e.jsxs("div",{className:`flex items-center ${a?"justify-between":"justify-end"} p-6 ${a?"border-b border-gray-200":""}`,children:[a&&e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:a}),e.jsx("button",{onClick:s,className:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-primary","aria-label":"Close modal",children:e.jsx(qg,{className:"w-5 h-5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto "+(a?"p-6":"p-6 pt-0"),children:o})]})})]})})}function ty(){const[t,n]=i.useState(null),[r,s]=i.useState(!1),{register:o,handleSubmit:a,formState:{errors:c},reset:l,watch:u}=p(),h=u("businessType");return e.jsxs("div",{className:"w-full",children:["success"===t&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[e.jsx(hg,{className:"text-green-600 text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-1",children:"Application Submitted Successfully!"}),e.jsx("p",{className:"text-sm text-green-700",children:"Thank you for your interest in joining ACBF. We'll review your application and get back to you soon."})]})]}),"error"===t&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(rg,{className:"text-red-600 text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Error Submitting Application"}),e.jsx("p",{className:"text-sm text-red-700",children:"There was an error submitting your application. Please try again later or contact us directly."})]})]}),e.jsxs("form",{onSubmit:a(async e=>{s(!0),n(null);try{(await _m(bp(Am,"membership_applications"),{name:e.name,email:e.email,phone:e.phone,business_name:e.businessName||null,business_type:"other"===e.businessType?e.otherBusinessType:e.businessType,message:e.message||null,status:"pending",created_at:Im()})).id&&(n("success"),l())}catch(t){n("error")}finally{s(!1)}}),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Bg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("name",{required:"Full name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",id:"name",placeholder:"Your Full Name",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.name?"border-red-500":"border-gray-300")})]}),c.name&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.name.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Sg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",id:"email",placeholder:"your.email@example.com",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.email?"border-red-500":"border-gray-300")})]}),c.email&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.email.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-2",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ag,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("phone",{required:"Phone number is required",pattern:{value:/^[\d\s\-\+\(\)]+$/,message:"Invalid phone number format"}}),type:"tel",id:"phone",placeholder:"+27 12 345 6789",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.phone?"border-red-500":"border-gray-300")})]}),c.phone&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.phone.message]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"businessName",className:"block text-sm font-medium text-gray-700 mb-2",children:"Business Name"}),e.jsxs("div",{className:"relative",children:[e.jsx(lg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("businessName"),type:"text",id:"businessName",placeholder:"Your Business Name (if applicable)",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.businessName?"border-red-500":"border-gray-300")})]}),c.businessName&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.businessName.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"businessType",className:"block text-sm font-medium text-gray-700 mb-2",children:["Business Type / Profession ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{...o("businessType",{required:"Please select a business type or profession"}),id:"businessType",className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.businessType?"border-red-500":"border-gray-300"),children:[e.jsx("option",{value:"",children:"Select a category"}),e.jsx("option",{value:"agriculture-hunting-forestry-fishing",children:"Agriculture, hunting, forestry and fishing"}),e.jsx("option",{value:"manufacturing",children:"Manufacturing"}),e.jsx("option",{value:"construction",children:"Construction"}),e.jsx("option",{value:"mining-quarrying",children:"Mining and quarrying"}),e.jsx("option",{value:"electricity-gas-water",children:"Electricity, gas and water supply"}),e.jsx("option",{value:"wholesale-retail-trade",children:"Wholesale and retail trade"}),e.jsx("option",{value:"automotive-engineering",children:"Automotive engineering"}),e.jsx("option",{value:"transport-storage-communication",children:"Transport, storage and communication"}),e.jsx("option",{value:"education-community-social-personal",children:"Education, Community, social and personal services"}),e.jsx("option",{value:"catering-accommodation",children:"Catering and accommodation"}),e.jsx("option",{value:"financial-intermediation-insurance-real-estate",children:"Financial intermediation, insurance, real-estate and business services"}),e.jsx("option",{value:"professional-services",children:"Professional services"}),e.jsx("option",{value:"other",children:"Other"})]}),c.businessType&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.businessType.message]}),"other"===h&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("label",{htmlFor:"otherBusinessType",className:"block text-sm font-medium text-gray-700 mb-2",children:["Please specify your business type ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(lg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("otherBusinessType",{required:"other"===h&&"Please specify your business type",minLength:{value:2,message:"Business type must be at least 2 characters"}}),type:"text",id:"otherBusinessType",placeholder:"Enter your business type or profession",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.otherBusinessType?"border-red-500":"border-gray-300")})]}),c.otherBusinessType&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.otherBusinessType.message]})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Information"}),e.jsx("textarea",{...o("message",{maxLength:{value:500,message:"Message must be less than 500 characters"}}),id:"message",rows:"4",placeholder:"Tell us about yourself and why you'd like to join ACBF...",className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors resize-none "+(c.message?"border-red-500":"border-gray-300")}),c.message&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.message.message]})]}),e.jsx("div",{children:e.jsx(Kg,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:r,className:"flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Lg,{}),"Submit Application"]})})})]})]})}function ny(){const[t,n]=i.useState(!1),r="/becoming-a-member"===c().pathname;return i.useEffect(()=>{r&&t&&n(!1)},[r,t]),i.useEffect(()=>{const e=()=>{r||n(!0)};return window.addEventListener("openSignupModal",e),()=>{window.removeEventListener("openSignupModal",e)}},[r]),r?null:e.jsx(ey,{isOpen:t,onClose:()=>n(!1),title:"Membership Application",size:"lg",children:e.jsx(ty,{})})}function ry(){const{mobileMenuOpen:t,setMobileMenuOpen:n,searchOpen:r,setSearchOpen:s}=function(){const e=i.useContext(bt);if(!e)throw new Error("useSite must be used within a SiteProvider");return e}(),[o,u]=i.useState(!1),[h,d]=i.useState(""),f=l(),p=c();i.useEffect(()=>{const e=()=>{u(window.scrollY>20)};return window.addEventListener("scroll",e),()=>window.removeEventListener("scroll",e)},[]);const m=()=>{n(!1)},g=()=>{r?f("/search"):s(!r)},y=()=>{"/becoming-a-member"===p.pathname?window.dispatchEvent(new CustomEvent("openBecomingAMemberModal")):window.dispatchEvent(new CustomEvent("openSignupModal"))};return e.jsx("header",{className:"sticky top-0 z-50 bg-white shadow-md transition-all duration-300 "+(o?"shadow-lg":""),role:"banner",children:e.jsxs("div",{className:"container mx-auto px-4",children:[e.jsxs("nav",{className:"flex items-center justify-between py-4",role:"navigation","aria-label":"Main navigation",children:[e.jsx(a,{to:"/",className:"flex items-center","aria-label":"Home",children:e.jsx(Yg,{src:"/assets/images/logos/acbf logos/acbf-logo-header.png",alt:Gg.siteName,className:"h-12 w-auto",lazy:!1})}),e.jsxs("div",{className:"hidden md:flex items-center space-x-6",children:[e.jsx("ul",{className:"flex items-center space-x-6",role:"list",children:Wg.main.map(t=>e.jsx("li",{role:"listitem",children:e.jsx(a,{to:t.url,className:"text-gray-700 hover:text-primary transition-colors duration-200 font-medium focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded px-2 py-1",children:t.label})},t.url))}),e.jsxs("button",{onClick:y,className:"inline-flex items-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg","aria-label":"Join Now",children:[e.jsx(zg,{className:"w-4 h-4"}),e.jsx("span",{children:"Join Now"})]}),e.jsx("button",{onClick:g,className:"p-2 text-gray-700 hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded","aria-label":"Search","aria-expanded":r,children:e.jsx(Zm,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"md:hidden flex items-center space-x-2",children:[e.jsx("button",{onClick:g,className:"p-2 text-gray-700 hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded","aria-label":"Search","aria-expanded":r,children:e.jsx(Zm,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>{n(!t)},className:"p-2 text-gray-700 hover:text-primary transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded","aria-label":"Toggle menu","aria-expanded":t,children:t?e.jsx(tg,{className:"w-6 h-6"}):e.jsx(Xm,{className:"w-6 h-6"})})]})]}),t&&e.jsxs("div",{className:"md:hidden border-t border-gray-200 py-4",role:"menu",children:[e.jsx("ul",{className:"flex flex-col space-y-4",role:"list",children:Wg.main.map(t=>e.jsx("li",{role:"listitem",children:e.jsx(a,{to:t.url,onClick:m,className:"block text-gray-700 hover:text-primary transition-colors duration-200 font-medium py-2 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 rounded px-2",role:"menuitem",children:t.label})},t.url))}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("button",{onClick:()=>{y(),m()},className:"w-full inline-flex items-center justify-center gap-2 px-4 py-2 bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-medium rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 shadow-md hover:shadow-lg","aria-label":"Join Now",children:[e.jsx(zg,{className:"w-4 h-4"}),e.jsx("span",{children:"Join Now"})]})})]}),r&&e.jsx("div",{className:"border-t border-gray-200 py-4",role:"search",children:e.jsxs("form",{onSubmit:e=>{e.preventDefault(),h.trim()&&(f(`/search?q=${encodeURIComponent(h.trim())}`),s(!1),d(""))},className:"relative",children:[e.jsx("label",{htmlFor:"header-search",className:"sr-only",children:"Search"}),e.jsx("input",{id:"header-search",type:"text",placeholder:"Search...",value:h,onChange:e=>d(e.target.value),className:"w-full px-4 py-2 pl-10 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",autoFocus:!0,"aria-label":"Search input"}),e.jsx(Zm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5","aria-hidden":"true"})]})})]})})}function sy(e){return $m({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14 0 55.52 4.84 55.52 4.84v61h-31.28c-30.8 0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"},child:[]}]})(e)}function iy(e){return $m({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141zm0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7zm146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8zm76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8zM398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1z"},child:[]}]})(e)}function oy(e){return $m({attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"},child:[]}]})(e)}function ay(e){return $m({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"},child:[]}]})(e)}function cy(){const t=(new Date).getFullYear(),n=[{name:"Facebook",icon:sy,url:Gg.socialMedia.facebook},{name:"Twitter",icon:ay,url:Gg.socialMedia.twitter},{name:"Instagram",icon:iy,url:Gg.socialMedia.instagram},{name:"LinkedIn",icon:oy,url:Gg.socialMedia.linkedin}].filter(e=>e.url);return e.jsx("footer",{className:"bg-gradient-to-br from-blue-600 via-blue-500 to-blue-700 text-white mt-auto",children:e.jsxs("div",{className:"container mx-auto px-4 py-12",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:[e.jsx("div",{className:"text-center md:text-left relative",children:e.jsx(a,{to:"/",className:"inline-block mb-4 relative",children:e.jsx(Yg,{src:Gg.logo,alt:Gg.siteName,className:"h-36 w-auto mx-auto md:mx-0",lazy:!1})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Quick Links"}),e.jsx("ul",{className:"space-y-2",children:Wg.main.map(t=>e.jsx("li",{children:e.jsx(a,{to:t.url,className:"text-gray-300 hover:text-white transition-colors duration-200 text-sm",children:t.label})},t.url))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Legal"}),e.jsx("ul",{className:"space-y-2",children:Wg.footer.map(t=>e.jsx("li",{children:e.jsx(a,{to:t.url,className:"text-gray-300 hover:text-white transition-colors duration-200 text-sm",children:t.label})},t.url))})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold mb-4",children:"Connect"}),e.jsxs("div",{className:"space-y-4",children:[n.length>0&&e.jsx("div",{className:"flex space-x-4",children:n.map(t=>{const n=t.icon;return e.jsx("a",{href:t.url,target:"_blank",rel:"noopener noreferrer",className:"text-gray-300 hover:text-white transition-colors duration-200","aria-label":t.name,children:e.jsx(n,{className:"w-6 h-6"})},t.name)})}),e.jsx("div",{className:"text-gray-300 text-sm",children:e.jsx("p",{children:"Email: info@acbfrsa.org.za"})})]})]})]}),e.jsx("div",{className:"border-t border-white/20 mt-8 pt-8 text-center",children:e.jsxs("p",{className:"text-gray-300 text-sm",children:[" ",t," Theophilus Chinomona. All rights reserved."]})})]})})}function ly(){const[t,n]=i.useState(null),[r,s]=i.useState(!1),{register:o,handleSubmit:a,formState:{errors:c},reset:l}=p();return e.jsxs("div",{className:"w-full",children:["success"===t&&e.jsxs("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[e.jsx(hg,{className:"text-green-600 text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900 mb-1",children:"Message Sent Successfully!"}),e.jsx("p",{className:"text-sm text-green-700",children:"Thank you for contacting us. We'll get back to you as soon as possible."})]})]}),"error"===t&&e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(rg,{className:"text-red-600 text-xl flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-red-900 mb-1",children:"Error Sending Message"}),e.jsx("p",{className:"text-sm text-red-700",children:"There was an error sending your message. Please try again later or contact us directly."})]})]}),e.jsxs("form",{onSubmit:a(async e=>{s(!0),n(null);try{(await _m(bp(Am,"contact_submissions"),{name:e.name,email:e.email,subject:e.subject,message:e.message,status:"new",created_at:Im()})).id&&(n("success"),l())}catch(t){n("error")}finally{s(!1)}}),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-2",children:["Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Bg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("name",{required:"Name is required",minLength:{value:2,message:"Name must be at least 2 characters"}}),type:"text",id:"name",placeholder:"Your Name",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.name?"border-red-500":"border-gray-300")})]}),c.name&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.name.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-2",children:["Email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Sg,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{...o("email",{required:"Email is required",pattern:{value:/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i,message:"Invalid email address"}}),type:"email",id:"email",placeholder:"your.email@example.com",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.email?"border-red-500":"border-gray-300")})]}),c.email&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.email.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-2",children:["Subject ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{...o("subject",{required:"Subject is required",minLength:{value:5,message:"Subject must be at least 5 characters"}}),type:"text",id:"subject",placeholder:"Message Subject",className:"w-full px-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors "+(c.subject?"border-red-500":"border-gray-300")}),c.subject&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.subject.message]})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-gray-700 mb-2",children:["Message ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(kg,{className:"absolute left-3 top-3 text-gray-400"}),e.jsx("textarea",{...o("message",{required:"Message is required",minLength:{value:10,message:"Message must be at least 10 characters"}}),id:"message",rows:"6",placeholder:"Your message here...",className:"w-full pl-10 pr-4 py-3 border rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent transition-colors resize-none "+(c.message?"border-red-500":"border-gray-300")})]}),c.message&&e.jsxs("p",{className:"mt-1 text-sm text-red-600 flex items-center gap-1",children:[e.jsx(rg,{className:"text-xs"}),c.message.message]})]}),e.jsx("div",{children:e.jsx(Kg,{type:"submit",variant:"primary",size:"lg",fullWidth:!0,disabled:r,className:"flex items-center justify-center gap-2",children:r?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Lg,{}),"Send Message"]})})})]})]})}function uy(){const[t,n]=i.useState(!1),r="/contact"===c().pathname;return i.useEffect(()=>{r&&t&&n(!1)},[r,t]),i.useEffect(()=>{const e=()=>{r||n(!0)};return window.addEventListener("openContactModal",e),()=>{window.removeEventListener("openContactModal",e)}},[r]),r?null:e.jsx(ey,{isOpen:t,onClose:()=>n(!1),title:"Contact Us",size:"lg",children:e.jsx(ly,{})})}function hy(){window.dispatchEvent(new CustomEvent("openContactModal"))}function dy({children:t}){return e.jsxs("div",{className:"min-h-screen flex flex-col bg-gray-50",children:[e.jsx("a",{href:"#main-content",className:"skip-to-main",children:"Skip to main content"}),e.jsx(ry,{}),e.jsx("main",{id:"main-content",className:"flex-grow",children:t}),e.jsx(cy,{}),e.jsx(Jg,{}),e.jsx(uy,{}),e.jsx(ny,{})]})}function fy({children:t,redirectTo:n="/admin/login"}){const{currentUser:r,loading:s}=Om(),i=c();return s?e.jsx(Qg,{fullScreen:!0,text:"Checking authentication..."}):r?t:e.jsx(u,{to:n,state:{from:i},replace:!0})}const py="chinomonatinotenda19@gmail.com";function my(){const{currentUser:e}=Om(),[t,n]=i.useState([]),[r,s]=i.useState([]),[o,a]=i.useState(!1),[c,l]=i.useState(!1),[u,h]=i.useState(!0),[d,f]=i.useState(null);i.useEffect(()=>{if(!e?.email)return a(!1),l(!1),void h(!1);(async()=>{try{const t=e.email.toLowerCase()===py.toLowerCase();l(t);const n=_p(Am,"approved_admins",e.email),r=await vm(n);r.exists()&&"approved"===r.data().status?a(!0):a(!1),h(!1)}catch(t){f(t.message||"Failed to check admin status"),a(!1),l(!1),h(!1)}})()},[e]),i.useEffect(()=>{if(c)try{const e=Em(rm(bp(Am,"admin_applications"),am("created_at","desc")),e=>{const t=e.docs.map(e=>({id:e.id,...e.data(),created_at:e.data().created_at?.toDate?e.data().created_at.toDate():e.data().created_at}));n(t),f(null)},e=>{f(e.message||"Failed to fetch admin applications")});return()=>e()}catch(e){f(e.message||"Failed to set up admin applications listener")}else n([])},[c]),i.useEffect(()=>{if(c)try{const e=Em(rm(bp(Am,"approved_admins"),am("approved_at","desc")),e=>{const t=e.docs.map(e=>({id:e.id,email:e.id,...e.data(),approved_at:e.data().approved_at?.toDate?e.data().approved_at.toDate():e.data().approved_at}));s(t),f(null)},e=>{f(e.message||"Failed to fetch approved admins")});return()=>e()}catch(e){f(e.message||"Failed to set up approved admins listener")}else s([])},[c]);return{adminApplications:t,approvedAdmins:r,isAdmin:o,isSuperAdmin:c,loading:u,error:d,applyForAdminAccess:async(n,r)=>{if(!e?.email)throw new Error("You must be logged in to apply for admin access");try{if(t.filter(t=>t.email===e.email&&"pending"===t.status).length>0)throw new Error("You already have a pending admin application");if(o)throw new Error("You are already an approved admin");const s={email:e.email,name:n||e.displayName||e.email,reason:r,status:"pending",created_at:Im()};return(await _m(bp(Am,"admin_applications"),s)).id}catch(s){throw s}},approveAdminApplication:async t=>{if(!c)throw new Error("Only the super admin can approve applications");try{const n=_p(Am,"admin_applications",t),r=await vm(n);if(!r.exists())throw new Error("Application not found");const s=r.data();await bm(n,{status:"approved",approved_by:e.email,approved_at:Im()});const i={email:s.email,name:s.name,approved_by:e.email,approved_at:Im(),status:"approved"};await function(e,t,n){e=La(e,vp);const r=La(e.firestore,Sp),s=dm(e.converter,t,n);return Tm(r,[Fp(Up(r),"setDoc",e._key,s,null!==e.converter,n).toMutation(e._key,uu.none())])}(_p(Am,"approved_admins",s.email),i,{merge:!0})}catch(n){throw n}},denyAdminApplication:async(t,n="")=>{if(!c)throw new Error("Only the super admin can deny applications");try{const r=_p(Am,"admin_applications",t);await bm(r,{status:"denied",denied_by:e.email,denied_at:Im(),denial_reason:n})}catch(r){throw r}},removeAdmin:async t=>{if(!c)throw new Error("Only the super admin can remove admins");if(t.toLowerCase()===py.toLowerCase())throw new Error("Super admin cannot be removed");try{const n=_p(Am,"approved_admins",t);await bm(n,{status:"revoked",revoked_by:e.email,revoked_at:Im()})}catch(n){throw n}},getMyApplication:()=>e?.email&&t.find(t=>t.email===e.email)||null}}function gy({children:t,redirectTo:n="/admin/login"}){const{currentUser:r,loading:s}=Om(),{isAdmin:i,isSuperAdmin:o,loading:a}=my(),l=c();return s||a?e.jsx(Qg,{fullScreen:!0,text:"Checking access..."}):r?i||o?t:e.jsx(u,{to:"/admin/apply",state:{from:l},replace:!0}):e.jsx(u,{to:n,state:{from:l},replace:!0})}const yy=i.lazy(()=>ve(()=>import("./Home-B_D0nv61.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]))),vy=i.lazy(()=>ve(()=>import("./About-oQhkRcvr.js"),__vite__mapDeps([14,1,2,3,15,16,12]))),wy=i.lazy(()=>ve(()=>import("./Blog-B_Xff6l8.js"),__vite__mapDeps([17,1,2,3,12,8,9,6,18,10,11,16]))),by=i.lazy(()=>ve(()=>import("./BlogPost-BN178uOb.js"),__vite__mapDeps([19,1,2,3,8,9,10,11,18,6,20,12]))),_y=i.lazy(()=>ve(()=>import("./Portfolio-BxA2shgd.js"),__vite__mapDeps([21,1,2,3,7,6,16,12])));i.lazy(()=>ve(()=>import("./PortfolioItem-BOshBq4A.js"),__vite__mapDeps([22,1,2,3,23,10,11,6,4,5,20,12,24])));const Ey=i.lazy(()=>ve(()=>import("./MemberItem-N-IQLamH.js"),__vite__mapDeps([25,1,2,3,7,6,10,11,20,12]))),Ty=i.lazy(()=>ve(()=>import("./Contact-BD7tGN1t.js"),__vite__mapDeps([26,1,2,3,12]))),xy=i.lazy(()=>ve(()=>import("./Search-CTabhtRe.js"),__vite__mapDeps([27,1,2,3,9,15,23,10,11,12]))),Iy=i.lazy(()=>ve(()=>import("./PrivacyPolicy-BxVYG_43.js"),__vite__mapDeps([28,1,2,3,15,12]))),Sy=i.lazy(()=>ve(()=>import("./TermsOfService-CoTGSfAQ.js"),__vite__mapDeps([29,1,2,3,15,12]))),Cy=i.lazy(()=>ve(()=>import("./BecomingAMember-DdRIrj5J.js"),__vite__mapDeps([30,1,2,3,12]))),ky=i.lazy(()=>ve(()=>import("./DynamicPage-BT65VKTf.js"),__vite__mapDeps([31,1,2,3,20,12,15]))),Ay=i.lazy(()=>ve(()=>import("./NotFound-Dp0oSAD1.js"),__vite__mapDeps([20,1,2,3,12]))),Ny=i.lazy(()=>ve(()=>import("./TestAuth-DyC7pvpV.js"),__vite__mapDeps([32,1,2,12]))),Ry=i.lazy(()=>ve(()=>import("./AdminLogin-CXANBv6A.js"),__vite__mapDeps([33,1,2,3,12]))),Dy=i.lazy(()=>ve(()=>import("./AdminDashboard-C8qGR-ou.js"),__vite__mapDeps([34,1,2,3,35,36,11,12]))),Oy=i.lazy(()=>ve(()=>import("./AdminApply-cJ2YoiaP.js"),__vite__mapDeps([37,1,2,3,12]))),Ly=i.lazy(()=>ve(()=>import("./AdminManagement-BxaBrVRR.js"),__vite__mapDeps([38,1,2,3,36,11,12]))),Py=i.lazy(()=>ve(()=>import("./SubmissionDetail-BmA-rcU6.js"),__vite__mapDeps([39,1,2,3,35,36,11,12])));function jy(){return e.jsx(dy,{children:e.jsxs(d,{children:[e.jsx(f,{path:"/",element:e.jsx(yy,{})}),e.jsx(f,{path:"/about",element:e.jsx(vy,{})}),e.jsx(f,{path:"/blog",element:e.jsx(wy,{})}),e.jsx(f,{path:"/blog/:slug",element:e.jsx(by,{})}),e.jsx(f,{path:"/members",element:e.jsx(_y,{})}),e.jsx(f,{path:"/members/:slug",element:e.jsx(Ey,{})}),e.jsx(f,{path:"/contact",element:e.jsx(Ty,{})}),e.jsx(f,{path:"/search",element:e.jsx(xy,{})}),e.jsx(f,{path:"/privacy-policy",element:e.jsx(Iy,{})}),e.jsx(f,{path:"/terms-of-service",element:e.jsx(Sy,{})}),e.jsx(f,{path:"/becoming-a-member",element:e.jsx(Cy,{})}),e.jsx(f,{path:"/page/:slug",element:e.jsx(ky,{})}),e.jsx(f,{path:"/test-auth",element:e.jsx(Ny,{})}),e.jsx(f,{path:"*",element:e.jsx(Ay,{})})]})})}function My(){return e.jsx(Xg,{children:e.jsxs(h,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:[e.jsx(Zg,{}),e.jsx(Dm,{children:e.jsx(_t,{children:e.jsx(i.Suspense,{fallback:e.jsx(Qg,{fullScreen:!0,text:"Loading..."}),children:e.jsxs(d,{children:[e.jsx(f,{path:"/admin/login",element:e.jsx(Ry,{})}),e.jsx(f,{path:"/admin/apply",element:e.jsx(fy,{children:e.jsx(Oy,{})})}),e.jsx(f,{path:"/admin",element:e.jsx(gy,{children:e.jsx(Dy,{})})}),e.jsx(f,{path:"/admin/management",element:e.jsx(gy,{children:e.jsx(Ly,{})})}),e.jsx(f,{path:"/admin/submissions/:type/:id",element:e.jsx(gy,{children:e.jsx(Py,{})})}),e.jsx(f,{path:"/*",element:e.jsx(jy,{})})]})})})}),e.jsx(vt,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"},success:{duration:3e3,iconTheme:{primary:"#10b981",secondary:"#fff"}},error:{duration:4e3,iconTheme:{primary:"#ef4444",secondary:"#fff"}}}})]})})}w.createRoot(document.getElementById("root")).render(e.jsx(i.StrictMode,{children:e.jsx(le,{children:e.jsx(My,{})})}));export{wt as $,Pg as A,Kg as B,ly as C,ng as D,Vg as E,bg as F,jg as G,Hm as H,Yg as I,Hg as J,Ng as K,$g as L,Fg as M,ag as N,ey as O,wg as P,Om as Q,hg as R,ty as S,rg as T,xg as U,sg as V,Rg as W,dg as X,yg as Y,qg as Z,Tg as _,Km as a,my as a0,Ig as a1,Lg as a2,Qg as a3,Mg as a4,_g as a5,vi as a6,Nm as a7,Dg as a8,kg as a9,rm as aa,bp as ab,Am as ac,am as ad,Em as ae,_p as af,bm as ag,Im as ah,eg as b,Wm as c,Gm as d,Og as e,cg as f,ge as g,ig as h,gg as i,mg as j,Ug as k,Eg as l,zg as m,Ym as n,hy as o,Qm as p,pg as q,lg as r,Gg as s,Bg as t,ug as u,Cg as v,Sg as w,Ag as x,vg as y,fg as z};
