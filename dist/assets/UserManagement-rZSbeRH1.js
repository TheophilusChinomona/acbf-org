import{j as e,m as s}from"./ui-vendor-D2jIcmjW.js";import{c as a,a as r}from"./react-vendor-C9V0vZuX.js";import{R as t,aF as l,a2 as i,an as n,T as d,B as c,h as o,m,e as x,A as h,ah as u,a3 as p,_ as g}from"./index-sZWzWtYr.js";import{S as j,C as b}from"./SEO-FeRLgWmQ.js";import{S as y}from"./Section-B5vjyEy3.js";import"./form-vendor-DygO8_bV.js";const f=({role:s})=>{const a={super_admin:"bg-purple-100 text-purple-800 border-purple-200",admin:"bg-blue-100 text-blue-800 border-blue-200",member:"bg-green-100 text-green-800 border-green-200"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${a[s]||a.member}`,children:{super_admin:"Super Admin",admin:"Admin",member:"Member"}[s]||s})},N=({status:s})=>{const a={approved:"bg-green-100 text-green-800 border-green-200",pending:"bg-yellow-100 text-yellow-800 border-yellow-200",rejected:"bg-red-100 text-red-800 border-red-200"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium border ${a[s]||a.pending}`,children:s})};function v(){const v=a(),{currentUser:w}=t(),{users:S,loading:k,error:C}=l(),{updateUserRole:A,deleteUser:U}=i(),[R,F]=r.useState(""),[M,_]=r.useState("all"),[D,L]=r.useState("all"),[z,$]=r.useState(null),[T,B]=r.useState(null),[E,J]=r.useState(""),[O,P]=r.useState(!1),[Y,q]=r.useState(!1),G=S.filter(e=>{const s=e.name?.toLowerCase().includes(R.toLowerCase())||e.email?.toLowerCase().includes(R.toLowerCase()),a="all"===M||e.role===M,r="all"===D||e.status===D;return s&&a&&r});return k?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(n,{className:"w-8 h-8 animate-spin text-primary"})}):C?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(d,{className:"w-12 h-12 text-red-500 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:C})]})}):e.jsxs(e.Fragment,{children:[e.jsx(j,{title:"User Management",description:"Manage all users and their permissions",noindex:!0}),e.jsx("section",{className:"relative w-full overflow-hidden bg-gradient-to-br from-secondary-dark via-secondary to-secondary-light py-8 md:py-12",children:e.jsx(b,{children:e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs(c,{onClick:()=>v("/admin"),variant:"ghost",className:"mb-4 text-white hover:bg-white/20",children:[e.jsx(o,{className:"mr-2"}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(m,{className:"w-8 h-8 text-white"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:"User Management"})]}),e.jsx("p",{className:"text-white/90",children:"Manage all users and their permissions"})]})})}),e.jsx(y,{bgColor:"white",padding:"xl",children:e.jsx(b,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-6 bg-white rounded-lg border border-gray-200 p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Search Users"}),e.jsxs("div",{className:"relative",children:[e.jsx(x,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:R,onChange:e=>F(e.target.value),placeholder:"Search by name or email...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Role"}),e.jsxs("select",{value:M,onChange:e=>_(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"super_admin",children:"Super Admin"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"member",children:"Member"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Status"}),e.jsxs("select",{value:D,onChange:e=>L(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"rejected",children:"Rejected"})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Total Users"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:S.length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Super Admins"}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:S.filter(e=>"super_admin"===e.role).length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Admins"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:S.filter(e=>"admin"===e.role).length})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Members"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:S.filter(e=>"member"===e.role).length})]})]}),e.jsx(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-200",children:0===G.length?e.jsx("tr",{children:e.jsx("td",{colSpan:"5",className:"px-6 py-12 text-center text-gray-500",children:"No users found"})}):G.map(s=>{const a=s.id===w?.uid;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.email}),a&&e.jsx("span",{className:"text-xs text-primary font-medium",children:"(You)"})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(f,{role:s.role})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx(N,{status:s.status})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500",children:s.created_at?new Date(s.created_at).toLocaleDateString():"N/A"}),e.jsxs("td",{className:"px-6 py-4 text-right space-x-2",children:[e.jsxs(c,{onClick:()=>{B(s),J(s.role)},disabled:a,size:"sm",variant:"outline",children:[e.jsx(h,{className:"mr-1"}),"Change Role"]}),e.jsxs(c,{onClick:()=>$(s),disabled:a,size:"sm",variant:"outline",className:"border-red-500 text-red-600 hover:bg-red-50",children:[e.jsx(u,{className:"mr-1"}),"Delete"]})]})]},s.id)})})]})})})]})})}),z&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx(d,{className:"w-6 h-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete User"}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone"})]})]}),e.jsxs("p",{className:"text-gray-700 mb-6",children:["Are you sure you want to delete ",e.jsx("strong",{children:z.name}),"? All their data will be permanently removed."]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(c,{onClick:()=>$(null),disabled:O,variant:"outline",children:"Cancel"}),e.jsx(c,{onClick:async()=>{if(z){P(!0);try{await U(z.id),g.success(`User ${z.name} deleted successfully`),$(null)}catch(e){g.error(e.message||"Failed to delete user")}finally{P(!1)}}},disabled:O,className:"bg-red-600 hover:bg-red-700 text-white",children:O?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"animate-spin mr-2"}),"Deleting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(u,{className:"mr-2"}),"Delete User"]})})]})]})}),T&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:e.jsxs(s.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx(h,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Change User Role"}),e.jsx("p",{className:"text-sm text-gray-600",children:T.name})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select New Role"}),e.jsxs("select",{value:E,onChange:e=>J(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary",children:[e.jsx("option",{value:"member",children:"Member"}),e.jsx("option",{value:"admin",children:"Admin"}),e.jsx("option",{value:"super_admin",children:"Super Admin"})]}),e.jsxs("p",{className:"mt-2 text-sm text-gray-500",children:["Current role: ",e.jsx("strong",{children:T.role})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx(c,{onClick:()=>{B(null),J("")},disabled:Y,variant:"outline",children:"Cancel"}),e.jsx(c,{onClick:async()=>{if(T&&E){q(!0);try{await A(T.id,E),g.success(`Role updated for ${T.name}`),B(null),J("")}catch(e){g.error(e.message||"Failed to update role")}finally{q(!1)}}},disabled:Y||E===T.role,variant:"primary",children:Y?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"animate-spin mr-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{className:"mr-2"}),"Update Role"]})})]})]})})]})}export{v as default};
