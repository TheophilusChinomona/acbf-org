import{j as e,m as s}from"./ui-vendor-D2jIcmjW.js";import{h as a,c as t,a as i}from"./react-vendor-C9V0vZuX.js";import{T as l,B as r,h as n,w as c,i as d,al as m,aC as o,a2 as x,t as u,x as h,u as b,r as p,U as j}from"./index-CCEhIy-z.js";import{S as g,C as N}from"./SEO-rJ-zjriL.js";import{S as f}from"./Section-B5vjyEy3.js";import{u as y,S as v}from"./StatusBadge-Bb4rAXsF.js";import{f as w}from"./format-DThRb344.js";import"./form-vendor-DygO8_bV.js";function S(){const{type:S,id:k}=a(),C=t(),{contactSubmissions:A,membershipApplications:D,updateContactSubmissionStatus:M,updateMembershipApplicationStatus:F,getContactSubmission:B,getMembershipApplication:P}=y(),[_,T]=i.useState(null),[I,U]=i.useState(""),[E,H]=i.useState(!1),[R,$]=i.useState(null),[q,z]=i.useState("");i.useEffect(()=>{if("contact"===S){const e=B(k);e&&(T(e),""!==I&&I!==e.status||U(e.status||"new"))}else if("membership"===S){const e=P(k);e&&(T(e),""!==I&&I!==e.status||U(e.status||"pending"))}},[S,k,A,D,B,P]);const J=e=>{if(!e)return"N/A";try{const s=e instanceof Date?e:e.toDate?e.toDate():new Date(e);return w(s,"MMMM dd, yyyy 'at' HH:mm")}catch(s){return"Invalid date"}};return _?e.jsxs(e.Fragment,{children:[e.jsx(g,{title:("contact"===S?"Contact Submission":"Membership Application")+" Details",description:"View details for "+("contact"===S?"contact submission":"membership application"),noindex:!0}),e.jsx("section",{className:"relative w-full overflow-hidden bg-gradient-to-br from-blue-600 via-blue-500 to-blue-700 py-8 md:py-12",children:e.jsx(N,{children:e.jsx("div",{className:"relative z-10",children:e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},children:[e.jsxs(r,{onClick:()=>C("/admin"),variant:"ghost",className:"mb-4 text-white hover:bg-white/20",children:[e.jsx(n,{className:"mr-2"}),"Back to Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:["contact"===S?e.jsx(c,{className:"w-8 h-8 text-white"}):e.jsx(d,{className:"w-8 h-8 text-white"}),e.jsx("h1",{className:"text-3xl md:text-4xl font-bold text-white",children:"contact"===S?"Contact Submission":"Membership Application"})]}),e.jsxs("p",{className:"text-white/90",children:["Submitted on ",J(_.created_at)]})]})})})}),e.jsx(f,{bgColor:"white",padding:"xl",children:e.jsx(N,{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},className:"bg-white rounded-lg border border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Update Status"}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("span",{className:"text-sm text-gray-600 whitespace-nowrap",children:"Current status:"}),e.jsx(v,{status:_.status})]})]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[e.jsx("select",{value:I,onChange:e=>U(e.target.value),disabled:E,className:"px-4 py-2 min-w-[140px] border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50 disabled:cursor-not-allowed bg-white text-sm font-medium",children:("contact"===S?[{value:"new",label:"New"},{value:"in-progress",label:"In Progress"},{value:"resolved",label:"Resolved"}]:[{value:"pending",label:"Pending"},{value:"approved",label:"Approved"},{value:"rejected",label:"Rejected"}]).map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),e.jsx(r,{onClick:async()=>{if(!_)return $("error"),void z("Submission not found. Please refresh the page.");if(!I)return $("error"),void z("Please select a status.");if(I!==_.status){H(!0),$(null),z("");try{"contact"===S?await M(k,I):await F(k,I),$("success"),z("Status updated successfully!"),T({..._,status:I}),setTimeout(()=>{$(null),z("")},3e3)}catch(e){$("error"),z(e.message||"Failed to update status. Please try again.")}finally{H(!1)}}},disabled:E||!_||!I||I===_.status,variant:"primary",children:E?e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"animate-spin mr-2"}),"Updating..."]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"mr-2"}),"Update Status"]})})]})]}),"success"===R&&e.jsxs("div",{className:"mt-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-start gap-3",children:[e.jsx(x,{className:"text-green-600 text-xl flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-green-900",children:q})})]}),"error"===R&&e.jsxs("div",{className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-start gap-3",children:[e.jsx(l,{className:"text-red-600 text-xl flex-shrink-0 mt-0.5"}),e.jsx("div",{children:e.jsx("p",{className:"text-sm font-medium text-red-900",children:q})})]})]}),e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4,delay:.1},className:"bg-white rounded-lg border border-gray-200 p-6 space-y-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Submission Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(u,{className:"inline mr-2"}),"Name"]}),e.jsx("p",{className:"text-gray-900",children:_.name||"N/A"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(c,{className:"inline mr-2"}),"Email"]}),e.jsx("a",{href:`mailto:${_.email}`,className:"text-blue-600 hover:text-blue-800 hover:underline",children:_.email||"N/A"})]}),"membership"===S&&_.phone&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(h,{className:"inline mr-2"}),"Phone"]}),e.jsx("a",{href:`tel:${_.phone}`,className:"text-blue-600 hover:text-blue-800 hover:underline",children:_.phone})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(b,{className:"inline mr-2"}),"Submitted"]}),e.jsx("p",{className:"text-gray-900",children:J(_.created_at)})]}),"membership"===S&&_.business_name&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(p,{className:"inline mr-2"}),"Business Name"]}),e.jsx("p",{className:"text-gray-900",children:_.business_name})]}),"membership"===S&&_.business_type&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Type"}),e.jsx("p",{className:"text-gray-900",children:_.business_type})]}),"contact"===S&&_.subject&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),e.jsx("p",{className:"text-gray-900",children:_.subject})]})]}),(_.message||"contact"===S&&_.subject)&&e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(j,{className:"inline mr-2"}),"contact"===S?"Message":"Additional Information"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:e.jsx("p",{className:"text-gray-900 whitespace-pre-wrap",children:_.message||"No message provided"})})]}),e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["Submission ID: ",e.jsx("span",{className:"font-mono",children:_.id})]})})]})]})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(g,{title:"Submission Not Found",description:"The requested submission could not be found",noindex:!0}),e.jsx(f,{bgColor:"white",padding:"xl",children:e.jsx(N,{children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx(l,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Submission Not Found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"The submission you're looking for doesn't exist or has been removed."}),e.jsxs(r,{onClick:()=>C("/admin"),variant:"primary",children:[e.jsx(n,{className:"mr-2"}),"Back to Dashboard"]})]})})})]})}export{S as default};
